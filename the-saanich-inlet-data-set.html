<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A The Saanich Inlet data set | Gene-centric mapping of microbial community structure and function</title>
<meta name="author" content="Stephan Koenig, Kim Dill-McFarland, Connor Morgan-Lang, Ryan McLaughlin, Julia Anstett, Resmi Radhamony, Sean Crowe and Steven Hallam">
<meta name="description" content="A.1 Description We will work with real-world data collected as part of an ongoing oceanographic time series program in Saanich Inlet, a seasonally anoxic fjord on the East coast of Vancouver...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="A The Saanich Inlet data set | Gene-centric mapping of microbial community structure and function">
<meta property="og:type" content="book">
<meta property="og:description" content="A.1 Description We will work with real-world data collected as part of an ongoing oceanographic time series program in Saanich Inlet, a seasonally anoxic fjord on the East coast of Vancouver...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A The Saanich Inlet data set | Gene-centric mapping of microbial community structure and function">
<meta name="twitter:description" content="A.1 Description We will work with real-world data collected as part of an ongoing oceanographic time series program in Saanich Inlet, a seasonally anoxic fjord on the East coast of Vancouver...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="2020.21 MICB425 Mirobial Ecological Genomics Capstone project">Gene-centric mapping of microbial community structure and function</a>:
        <small class="text-muted">2020.21 MICB425 Mirobial Ecological Genomics Capstone project</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="exploring-the-microcosmos.html"><span class="header-section-number">1</span> Exploring the microcosmos</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="a-tutorial-for-using-treesapp.html"><span class="header-section-number">2</span> A tutorial for using TreeSAPP</a></li>
<li><a class="" href="acquiring-golden-data.html"><span class="header-section-number">3</span> Acquiring golden data</a></li>
<li><a class="" href="treesapp-create.html"><span class="header-section-number">4</span> Creating a reference package for TreeSAPP</a></li>
<li><a class="" href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html"><span class="header-section-number">5</span> Classifying unknown sequences with TreeSAPP and updating a reference package</a></li>
<li><a class="" href="calculating-relative-abundance-of-metaomic-data.html"><span class="header-section-number">6</span> Calculating relative abundance of meta’omic data</a></li>
<li><a class="" href="analysing-the-treesapp-classifications-in-r.html"><span class="header-section-number">7</span> Analysing the TreeSAPP classifications in R</a></li>
<li class="book-part">Capstone project</li>
<li><a class="" href="project-description.html"><span class="header-section-number">8</span> Project description</a></li>
<li><a class="" href="assessment.html"><span class="header-section-number">9</span> Assessment</a></li>
<li><a class="" href="running-treesapp-on-a-server.html"><span class="header-section-number">10</span> Running TreeSAPP on a server</a></li>
<li class="book-part">Appendix</li>
<li><a class="active" href="the-saanich-inlet-data-set.html"><span class="header-section-number">A</span> The Saanich Inlet data set</a></li>
<li><a class="" href="treesapp-reference-packages.html"><span class="header-section-number">B</span> TreeSAPP reference packages</a></li>
<li><a class="" href="shell-cheat-sheet.html"><span class="header-section-number">C</span> Shell cheat sheet</a></li>
<li><a class="" href="references.html"><span class="header-section-number">D</span> References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="the-saanich-inlet-data-set" class="section level1">
<h1>
<span class="header-section-number">A</span> The Saanich Inlet data set<a class="anchor" aria-label="anchor" href="#the-saanich-inlet-data-set"><i class="fas fa-link"></i></a>
</h1>
<div id="description" class="section level2">
<h2>
<span class="header-section-number">A.1</span> Description<a class="anchor" aria-label="anchor" href="#description"><i class="fas fa-link"></i></a>
</h2>
<p>We will work with real-world data collected as part of an ongoing oceanographic time series program in Saanich Inlet, a seasonally anoxic fjord on the East coast of Vancouver Island, British Columbia:</p>
<div class="figure">
<span style="display:block;" id="fig:saanich-inlet"></span>
<img src="images/saanich_inlet_map.png" alt="The Saanich Inlet"><p class="caption">
FIGURE A.1: The Saanich Inlet
</p>
</div>
<p>Figure <a href="the-saanich-inlet-data-set.html#fig:saanich-inlet">A.1</a> shows a map of Saanich Inlet indicating conventional sample collection stations (S1-S9). The data used in this tutorial (sourced from S3, Cruise 72) include various geochemical measurements and the genomic and transcriptomic data of microbial samples at depths 10, 100, 120, 135, 150, 165 and 200 m.</p>
<p>For more details about these data, see <span class="citation">(<a href="references.html#ref-Hallam.2017" role="doc-biblioref">10</a>)</span>, and for more detailed information on the environmental context and time series data, see <span class="citation">(<a href="references.html#ref-Torres-Beltr%C3%A1n.2017" role="doc-biblioref">11</a>)</span>.</p>
</div>
<div id="data-on-the-server" class="section level2">
<h2>
<span class="header-section-number">A.2</span> Data on the server<a class="anchor" aria-label="anchor" href="#data-on-the-server"><i class="fas fa-link"></i></a>
</h2>
<p>The Saanich data is located on the MICB425 server at <code>/mnt/datasets/saanich/</code>.</p>
<pre><code>/mnt/datasets/saanich/
├── [   0]  directory_structure.txt
├── [492M]  MAGs
│   └── [492M]  Concatenated
│       └── [492M]  All_SI072_Metawrap_MAGs.fa
├── [3.5G]  MetaG_Assemblies
│   ├── [630M]  SI072_100m_contig.fa
│   ├── [525M]  SI072_10m_contig.fa
│   ├── [571M]  SI072_120m_contig.fa
│   ├── [505M]  SI072_135m_contig.fa
│   ├── [396M]  SI072_150m_contig.fa
│   ├── [748M]  SI072_165m_contig.fa
│   └── [219M]  SI072_200m_contig.fa
│   └── [3.5G]  SI072_All_contigs.fa
├── [ 64G]  MetaG_Trim_QC_Reads
│   ├── [4.7G]  SI072_100m_pe.1.fq.gz
│   ├── [4.7G]  SI072_100m_pe.2.fq.gz
│   ├── [4.2G]  SI072_10m_pe.1.fq.gz
│   ├── [4.2G]  SI072_10m_pe.2.fq.gz
│   ├── [4.2G]  SI072_120m_pe.1.fq.gz
│   ├── [4.2G]  SI072_120m_pe.2.fq.gz
│   ├── [4.4G]  SI072_135m_pe.1.fq.gz
│   ├── [4.4G]  SI072_135m_pe.2.fq.gz
│   ├── [4.8G]  SI072_150m_pe.1.fq.gz
│   ├── [4.7G]  SI072_150m_pe.2.fq.gz
│   ├── [6.5G]  SI072_165m_pe.1.fq.gz
│   ├── [6.4G]  SI072_165m_pe.2.fq.gz
│   ├── [3.3G]  SI072_200m_pe.1.fq.gz
│   └── [3.3G]  SI072_200m_pe.2.fq.gz
├── [ 54G]  MetaT_Raw_Reads
│   ├── [8.9G]  SI072_100m_MetaT_QC_Filtered.fastq.gz
│   ├── [6.4G]  SI072_10m_MetaT_QC_Filtered.fastq.gz
│   ├── [6.8G]  SI072_120m_MetaT_QC_Filtered.fastq.gz
│   ├── [7.2G]  SI072_135m_MetaT_QC_Filtered.fastq.gz
│   ├── [10.0G]  SI072_150m_MetaT_QC_Filtered.fastq.gz
│   ├── [8.7G]  SI072_165m_MetaT_QC_Filtered.fastq.gz
│   └── [6.0G]  SI072_200m_MetaT_QC_Filtered.fastq.gz
├── [181M]  SAGs
│   └── [181M]  Concatenated_Med_Plus
│       └── [181M]  Saanich_Med_Plus_SAGs.fasta
└── [ 42K]  seq2lineage_Tables
    ├── [ 17K]  Med_Plus_SAGs_GTDB_Taxonomies.tsv
    └── [ 25K]  SI072_MAGs_All_GTDB_taxonomies.tsv

 122G used in 8 directories, 33 files</code></pre>
<p>Additionally, if you would like to run GTDB-TK, the path to the GTDB refrence directory is located at <code>/mnt/datasets/GTDB-Tk/release95/</code></p>
</div>
<div id="description-of-input-data" class="section level2">
<h2>
<span class="header-section-number">A.3</span> Description of input data<a class="anchor" aria-label="anchor" href="#description-of-input-data"><i class="fas fa-link"></i></a>
</h2>
<p>List of directories and their contents</p>
<ul>
<li>
<p><code>MAGs</code></p>
<p>Within the <code>Concatonated</code> subdirectory, there is a single <code>All_SI072_Metawrap_MAGs.fa</code> fasta file which you will use with both <code>treesapp assign</code> and <code>treesapp update</code>. After the MAGs were generated with the MetaWrap pipeline <span class="citation">(<a href="references.html#ref-Uritskiy.2018" role="doc-biblioref">12</a>)</span> (see <a href="the-saanich-inlet-data-set.html#methods">Methods</a>), sample IDs were added to the contig headers of each MAG produced from each SI072 sample depth. The individual MAGs were then concatenated into this file.</p>
</li>
<li>
<p><code>MetaG_Assemblies</code></p>
<p>This directory contains seven assembled metagenomic contigs for each SI072 sample depth, and one file where each of these has been concatonated into a single file. These files will be used for the <code>treesapp assign</code> and <code>abundance</code> tutorials. These files were generated by assembling the trimmed and quality controlled reads that were generated by the Illumina HiSeq platform (see <a href="the-saanich-inlet-data-set.html#methods">Methods</a>).</p>
</li>
<li>
<p><code>MetaG_Trim_QC_Reads</code></p>
<p>This directory contains fourteen fastq files which contain the paired-end forward and reverse metagenomic reads for each SI072 sample depth. These trimmed and QC’d fastqs were generated by processing the raw reads through the Megahit workflow described below. You will use these files for treesapp abundance to get the metagenomic abundance of your assigned genes.</p>
</li>
<li>
<p><code>MetaT_Raw_Reads</code></p>
<p>This directory contains seven filtered and QC’d metatranscriptome fastq files for each SI072 Sample depth. These files are paired end and interleaved. These files we provided by the the JGI and generated based on the methodology below. You will use these files in <code>treesapp abundance</code> to calculate the metatransciptomic abundances of each gene of interest.</p>
</li>
<li>
<p><code>SAGs</code></p>
<p>Within the <code>Concatenated_Med_Plus</code> subdirectory, there is a single <code>Saanich_Med_Plus_SAGs.fasta</code> file which you will use with both <code>treesapp assign</code> and <code>treesapp update</code>. After the MAGs were generated with the SAG Assembly and Decontamination Workflow <span class="citation">(<a href="references.html#ref-Bolger.2014" role="doc-biblioref">13</a>–<a href="references.html#ref-Tennessen.2016" role="doc-biblioref">16</a>)</span> (see <a href="the-saanich-inlet-data-set.html#methods">Methods</a>), sample IDs were added to the contig headers of each MAG produced from each SI072 sample depth. The individual MAGs were then concatenated into this file.</p>
</li>
<li>
<p><code>seq2lineage_Tables</code></p>
<p>This directory contains two files that will be used for treesapp update. One file contains the lineage information from the MAGs, and the other contains information for the SAGs. These tables were generated by taking each separate MAG and SAG respectively and passing them through the Genome Taxonomic Database Toolkit v1.4.0 classify workflow <span class="citation">(<a href="references.html#ref-Chaumeil.2019" role="doc-biblioref">7</a>)</span> (see <a href="the-saanich-inlet-data-set.html#methods">Methods</a>). Then, the first two columns of the archaeal and bacterial summary files were taken and combined into each of these files.</p>
</li>
</ul>
</div>
<div id="methods" class="section level2">
<h2>
<span class="header-section-number">A.4</span> Methods<a class="anchor" aria-label="anchor" href="#methods"><i class="fas fa-link"></i></a>
</h2>
<div id="metagenomes-and-metatransriptopmes" class="section level3">
<h3>
<span class="header-section-number">A.4.1</span> Metagenomes and metatransriptopmes<a class="anchor" aria-label="anchor" href="#metagenomes-and-metatransriptopmes"><i class="fas fa-link"></i></a>
</h3>
<div id="sample-collection" class="section level4">
<h4>
<span class="header-section-number">A.4.1.1</span> Sample Collection<a class="anchor" aria-label="anchor" href="#sample-collection"><i class="fas fa-link"></i></a>
</h4>
<p>Water was collected at 10, 100, 120, 135, 150, 165, and 200m at Saanich Inlet on August 1st, 2012 and filtered through a 0.22 µm Sterivex filter to collect biomass. Total genomic DNA and RNA were extracted from these filters. RNA was reversed transcribed into cDNA and both genomic DNA and cDNA were used in the construction of shotgun Illumina libraries. Sequencing data were generated on the Illumina HiSeq platform with <strong>2x150bp</strong> technology. For more in-depth sampling and sequencing methods, please see <span class="citation">(<a href="references.html#ref-Hawley.2017" role="doc-biblioref">17</a>)</span>.</p>
</div>
<div id="quality-filtering-of-reads" class="section level4">
<h4>
<span class="header-section-number">A.4.1.2</span> Quality filtering of reads<a class="anchor" aria-label="anchor" href="#quality-filtering-of-reads"><i class="fas fa-link"></i></a>
</h4>
<p>The resulting reads were processed, quality controlled and filtered with Trimmomatic (v.0.35, <a href="http://www.usadellab.org/cms/?page=trimmomatic">documentation</a>) <span class="citation">(<a href="references.html#ref-Bolger.2014" role="doc-biblioref">13</a>)</span>. Trimmomatic command is as follows, where SI072_XXX represents the same command being applied to each of the seven depths.</p>
<pre><code>trimmomatic -threads 8 -phred33 \
Path_to/SI072_XXXm/Raw/forward_dir/SI072_XXXm_R1.fastq \
Path_To/SI072_200m/Raw/reverse_dir/SI072_XXXm_R2.fastq \

Path_To/SI072_200m//trim/SI072_XXXm_pe.1.fq \

Path_To/SI072_200m//trim/SI072_XXXm_pe.2.fq \

ILLUMINACLIP:/usr/local/share/Trimmomatic-0.35/adapters/TruSeq3-PE.fa:2:3:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36</code></pre>
<p>The resulting trimmed fastq files were also deposited into the MICB425 server in <code>/mnt/datasets/saanich/MetaG_Trim_QC_Reads</code></p>
</div>
<div id="contig-assembly" class="section level4">
<h4>
<span class="header-section-number">A.4.1.3</span> Contig Assembly<a class="anchor" aria-label="anchor" href="#contig-assembly"><i class="fas fa-link"></i></a>
</h4>
<p>MEGAHIT (v.1.1.3, <a href="https://github.com/voutcn/megahit/wiki/Assembly-Tips">documentation</a>) <span class="citation">(<a href="references.html#ref-Li.2015" role="doc-biblioref">18</a>)</span> was used to assemble the filtered metagenomic reads into contigs.</p>
<pre><code>megahit -1 Path_To/SI072_200m//trim/SI072_XXXm_pe.1.fq  -2 Path_To/SI072_200m//trim/SI072_XXXm_pe.2.fq  -m 0.5  -t 12  -o megahit_result --k-min 27 --k-step 10 --min-contig-len 500</code></pre>
<p>The resulting assemblies can be found in <code>/mnt/datasets/saanich/MetaG_Assemblies</code>.</p>
</div>
<div id="binning-and-mag-generation" class="section level4">
<h4>
<span class="header-section-number">A.4.1.4</span> Binning and MAG Generation<a class="anchor" aria-label="anchor" href="#binning-and-mag-generation"><i class="fas fa-link"></i></a>
</h4>
<p>MetaWRAP (v1.2.4, <a href="https://github.com/bxlab/metaWRAP">documentation</a>) <span class="citation">(<a href="references.html#ref-Uritskiy.2018" role="doc-biblioref">12</a>)</span> was used to generate the MAGs from the metagenome assemblies and filtered reads for this project. MetaWRAP leverages multiple binning software (we chose to use MetaBAT2 v2.12.1 <span class="citation">(<a href="references.html#ref-kang.2019" role="doc-biblioref">19</a>)</span> and MaxBin v2.2.7 <span class="citation">(<a href="references.html#ref-Wu.2014" role="doc-biblioref">20</a>)</span>, <span class="citation">(<a href="references.html#ref-Wu.2016" role="doc-biblioref">21</a>)</span>) to create a non-redundant set of MAGs that are better quality than those from any single software. The quality of the resulting bins – assessed by their completeness, contamination, and strain-heterogeneity – was calculated with MetaWRAP’s implementation of CheckM (v1.0.12) <span class="citation">(<a href="references.html#ref-Parks.2015" role="doc-biblioref">15</a>)</span>. The command used to invoke MetaWRAP is as follows:</p>
<pre><code>metawrap binning -a SI072_Assembly.fa -o output_directory -t 16 -m 64 -l 1500 --metabat2 --maxbin2 --universal Path_To/SI072_200m//trimSI072_XXXm_pe.1.fastq Path_To/SI072_200m//trimSI072_XXXm_pe.2.fastq</code></pre>
</div>
<div id="taxonomic-assignment-of-mags" class="section level4">
<h4>
<span class="header-section-number">A.4.1.5</span> Taxonomic Assignment of MAGs<a class="anchor" aria-label="anchor" href="#taxonomic-assignment-of-mags"><i class="fas fa-link"></i></a>
</h4>
<p>The resulting MAGs were then passed through GTDB-TK v1.4.0 classify workflow with the reference data version r95 <a href="https://ecogenomics.github.io/GTDBTk/commands/classify_wf.html">documentation</a> <span class="citation">(<a href="references.html#ref-Chaumeil.2019" role="doc-biblioref">7</a>)</span>.</p>
<pre><code>gtdbtk classify_wf --genome_dir Path_To_SI072/MAGs/ -x .fa --out_dir Path_To_SI072/MAG_GTDB_Outputs/ --cpus 8 --pplacer_cpus 8
</code></pre>
<p>After updating the headers for resulting 219 bins with the sample IDs, the bins were concatenated and deposited into: <code>/mnt/datasets/saanich/MAGs/Concatenated/</code></p>
</div>
</div>
<div id="single-cell-amplified-genomes" class="section level3">
<h3>
<span class="header-section-number">A.4.2</span> Single-Cell Amplified Genomes<a class="anchor" aria-label="anchor" href="#single-cell-amplified-genomes"><i class="fas fa-link"></i></a>
</h3>
<div id="sample-collection-1" class="section level4">
<h4>
<span class="header-section-number">A.4.2.1</span> Sample Collection<a class="anchor" aria-label="anchor" href="#sample-collection-1"><i class="fas fa-link"></i></a>
</h4>
<p>Water was collected at across the water column at Saanich Inlet on August 9th, 2011. 900 µL of seawater was aliquoted into 100 µL of glycerol-TE buffer, then stored at -80 degrees Celsius. Samples from 100m, 150m, and 185m were selected for sorting and sequencing. The selected samples were thawed and had their microbial cells sorted at the Bigelow Laboratory for Ocean Sciences’ Single Cell Genomics Center (scgc.bigelow.org).</p>
</div>
<div id="florescence-activated-cell-sorting" class="section level4">
<h4>
<span class="header-section-number">A.4.2.2</span> Florescence Activated Cell Sorting<a class="anchor" aria-label="anchor" href="#florescence-activated-cell-sorting"><i class="fas fa-link"></i></a>
</h4>
<p>Samples were passed through a sterile 40 𝜇m size mesh before microorganisms were sorted by a non-targeted isolation procedure. For non-target isolation, the microbial particles were labeled with a 5 𝜇M final concentration of the DNA stain SYTO-9 (Thermo Fisher Scientific). Microbial cells were individually sorted using a MoFloTM (Beckman Coulter) or an InFluxTM (BD Biosciences) flow cytometer system equipped with a 488 nm laser for excitation and a 70 μm nozzle orifice30. The gates for the untargeted isolation of microbial cells stained with SYTO-9 were defined based on the green fluorescence of particles as a proxy for nucleic acid content, and side scattered light as a proxy for particle size. All microbial single cells were sorted into 384-well plates containing 600 nL of 1X TE buffer per well and then stored at -80 degrees Celsius. The microbial single-cells sorted into TE buffer were lysed as described previously by adding cold KOH.The microbial nucleic acids were then amplified in each individual wells through Multiple Displacement Amplification (MDA) <span class="citation">(<a href="references.html#ref-Raghunathan.2005" role="doc-biblioref">22</a>)</span>, <span class="citation">(<a href="references.html#ref-Rinke.2014" role="doc-biblioref">23</a>)</span>.</p>
</div>
<div id="amplicon-taxonomic-screening" class="section level4">
<h4>
<span class="header-section-number">A.4.2.3</span> Amplicon Taxonomic Screening<a class="anchor" aria-label="anchor" href="#amplicon-taxonomic-screening"><i class="fas fa-link"></i></a>
</h4>
<p>SAGs generated through the MDA methodology were taxonomically characterized by sequencing a determined phylogenetic marker using an amplification based approach. SAGs were screened for their small subunit ribosomal rRNA gene (SSU rRNA) using primers for bacterial (27-F: 5’- AGAGTTTGATCMTGGCTCAG -3’37, 907-R: 5’- CCGTCAATTCMTTTRAGTTT -3’38 and archaeal sequences (Arc_344F: 5’- ACGGGGYGCAGCAGGCGCGA -3’39, Arch_915R: 5’- GTGCTCCCCCGCCAATTCCT -3’40). The real-time PCR and sequencing procedure of the resulting amplicons was performed as previously described <span class="citation">(<a href="references.html#ref-Tyson.2004" role="doc-biblioref">24</a>)</span>, <span class="citation">(<a href="references.html#ref-Swan.2011" role="doc-biblioref">25</a>)</span>. The partial SSU rRNA gene sequences were then queried against the SILVA database v138.1 <span class="citation">(<a href="references.html#ref-Quast.2013" role="doc-biblioref">26</a>)</span> with blastn, from BLAST+ v2.9.0 <span class="citation">(<a href="references.html#ref-Camacho.2009" role="doc-biblioref">27</a>)</span>.</p>
<pre><code> blastn -query -db -outfmt "6 qacc sacc stitle staxid pident bitscore" -max_target_seqs 1 -num_threads 4 -out </code></pre>
</div>
<div id="sag-sequencing-and-assembly" class="section level4">
<h4>
<span class="header-section-number">A.4.2.4</span> SAG Sequencing and Assembly<a class="anchor" aria-label="anchor" href="#sag-sequencing-and-assembly"><i class="fas fa-link"></i></a>
</h4>
<p>MDA products for the SAGs were sequenced as described previously <span class="citation">(<a href="references.html#ref-Tyson.2004" role="doc-biblioref">24</a>)</span>, <span class="citation">(<a href="references.html#ref-Swan.2011" role="doc-biblioref">25</a>)</span> on an Illumina HiSeq 2000. The resulting raw reads were then filtered and trimmed to remove adaptors with Trimmomatic v0.35 <span class="citation">(<a href="references.html#ref-Bolger.2014" role="doc-biblioref">13</a>)</span>.</p>
<pre><code>trimmomatic -threads 8 -phred33 \
Path_to/SI072_XXXm/Raw/forward_dir/SI072_XXXm_R1.fastq \
Path_To/SI072_200m/Raw/reverse_dir/SI072_XXXm_R2.fastq \

Path_To/SI072_200m//trim/SI072_XXXm_pe.1.fq \
Path_To/SI072_200m//trim/SI072_XXXm_se.1.fq \
Path_To/SI072_200m//trim/SI072_XXXm_pe.2.fq \
Path_To/SI072_200m//trim/SI072_XXXm_se.2.fq \

ILLUMINACLIP:/usr/local/share/Trimmomatic-0.35/adapters/TruSeq3-PE.fa:2:3:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36</code></pre>
<p>Trimmed and quality controlled reads were the then assembled with SPAdes v3.9.0 <span class="citation">(<a href="references.html#ref-Bankevich.2012" role="doc-biblioref">28</a>)</span> with standard parameters.</p>
<pre><code>spades.py \
--sc \
-o Path_To_assembly_dir/ \
-1 Path_To_trim_dir/SI072_XXXm_pe.1.fq \
-2 Path_To_trim_dir/SI072_XXXm_pe.1.fq \
-s Path_To_trim_dir/$sample\_unpaired.fq \
-k $k_series \
--memory 90 \
--threads $threads \
--careful \
--cov-cutoff auto
</code></pre>
</div>
<div id="sag-assembly-quality-control-and-decontamination" class="section level4">
<h4>
<span class="header-section-number">A.4.2.5</span> SAG Assembly Quality Control and Decontamination<a class="anchor" aria-label="anchor" href="#sag-assembly-quality-control-and-decontamination"><i class="fas fa-link"></i></a>
</h4>
<p>Quality of the SAGs was assessed using CheckM (v1.0.5) <span class="citation">(<a href="references.html#ref-Parks.2015" role="doc-biblioref">15</a>)</span> with the following command:</p>
<pre><code>checkm lineage_wf --tab_table -x .fna --threads 8 --pplacer_threads 8</code></pre>
<p>SAGs found to have &gt;5% contamination were passed through ProDeGe v2.3.0 <span class="citation">(<a href="references.html#ref-Tennessen.2016" role="doc-biblioref">16</a>)</span>. The resulting decontaminated SAGs were re-assesed with CheckM and those that still exceeded 5% contamination had all of their short contigs (i.e. &lt;2000 bp) removed from the assembly. These were again re-assessed with CheckM to ensure they met our standards.</p>
<p>For this project, of the 376 SAGs recovered, 154 SAGs that were estimated to have &gt;50% completeness and &lt;10% contamination were selected for the remainder of the analysis.</p>
</div>
<div id="final-taxonomic-assignment-of-sags" class="section level4">
<h4>
<span class="header-section-number">A.4.2.6</span> Final Taxonomic Assignment of SAGs<a class="anchor" aria-label="anchor" href="#final-taxonomic-assignment-of-sags"><i class="fas fa-link"></i></a>
</h4>
<p>The resulting SAGs were then passed through GTDB-TK v1.4.0 classify workflow <a href="https://ecogenomics.github.io/GTDBTk/commands/classify_wf.html">documentation</a> <span class="citation">(<a href="references.html#ref-Chaumeil.2019" role="doc-biblioref">7</a>)</span>.</p>
<pre><code>gtdbtk classify_wf --genome_dir Path_To_SI_SAGs/ -x .fna --out_dir Path_To_SI_SAGs/GTDB_1.4.0/ --cpus 8 --pplacer_cpus 8
</code></pre>
<p>After updating the headers for resulting SAGs with the sample IDs, the SAGs were concatenated and deposited into: <code>/mnt/datasets/saanich/SAGs/Concatenated_Med_Plus/</code></p>
<p><strong>Note:</strong> The identifier for each SAG consists of a combination of the plate ID and the well location it was sorted into. The identifiers take the form (AB-7XX_YYY). These identifiers were incorporated into the headers of the final SAG assemblies. Each plate corresponds to a specific depth as shown below:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Plate ID</th>
<th align="center">Sample Depth (m)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">AB-746</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center">AB-747</td>
<td align="center">100</td>
</tr>
<tr class="odd">
<td align="center">AB-750</td>
<td align="center">150</td>
</tr>
<tr class="even">
<td align="center">AB-751</td>
<td align="center">150</td>
</tr>
<tr class="odd">
<td align="center">AB-754</td>
<td align="center">185</td>
</tr>
<tr class="even">
<td align="center">AB-755</td>
<td align="center">185</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div id="installing-and-running-gtdb-tk" class="section level2">
<h2>
<span class="header-section-number">A.5</span> Installing and running GTDB-Tk<a class="anchor" aria-label="anchor" href="#installing-and-running-gtdb-tk"><i class="fas fa-link"></i></a>
</h2>
<p>If you would like to use additional genomes or MAGs for you capstone project, you can also classify them with GTDB-Tk.</p>
<p>If you would like to install GTDB-TK with conda, you will first need to create a new conda environment. First, deactivate the treesapp environment:</p>
<pre><code>conda deactivate treesapp_cenv</code></pre>
<p>follow the instructions below (originally from: <a href="https://ecogenomics.github.io/GTDBTk/installing/bioconda.html">GTDB</a>)</p>
<p>To install GTDB with conda:</p>
<pre><code># specific version (replace 1.4.1 with the version you wish to install, recommended)
conda create -n gtdbtk-1.4.1 -c conda-forge -c bioconda gtdbtk=1.4.1
</code></pre>
<p>Once you have made your new GTDB environment, you will need to add a path to the latest GTDB reference data.</p>
<pre><code>conda activate gtdbtk-1.4.1</code></pre>
<p>Next, determine the GTDB-Tk environment path</p>
<pre><code>which gtdbtk
</code></pre>
<p>It should be <code>root/miniconda3/envs/gtdbtk-1.4.1/bin/gtdbtk</code></p>
<p>Next, edit the activate file</p>
<pre><code>echo "export GTDBTK_DATA_PATH=/mnt/datasets/GTDB-Tk/release95/" &gt; /root/miniconda3/envs/gtdbtk-1.4.1/etc/conda/activate.d/gtdbtk.sh</code></pre>
<p>You are now ready to use the classify workflow command listed above. You will need to substitute the directory name that you would like to write out to, as well as the extension of the fasta files for your genomes.</p>
<p><strong>It is very important you set the cpus and pplacer_cpus flags to 4 threads to make sure you do not tie up all of the server’s resources!</strong></p>
<pre><code>gtdbtk classify_wf --genome_dir Path_To_Genomes/ \
    -x [Choose either .fa, .fasta, or .fna depending on the file extension] \
    --out_dir [Path_To_New_Genome_Output/here] \
    --cpus 4 \
    --pplacer_cpus 4</code></pre>
<p>After running GTDB, you can deactivate the environment with:</p>
<pre><code>conda deactivate</code></pre>
<p>You can then turn the treesapp environment back and continue with your treesapp analysis.</p>
<pre><code>conda activate treesapp_cenv</code></pre>
<p>We recommend concatenating your new genomes together with <code>cat</code> into a single file for ease of use. For example:</p>
<pre><code>cat *.fasta &gt; All_Genomes.fasta
</code></pre>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="running-treesapp-on-a-server.html"><span class="header-section-number">10</span> Running TreeSAPP on a server</a></div>
<div class="next"><a href="treesapp-reference-packages.html"><span class="header-section-number">B</span> TreeSAPP reference packages</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-saanich-inlet-data-set"><span class="header-section-number">A</span> The Saanich Inlet data set</a></li>
<li><a class="nav-link" href="#description"><span class="header-section-number">A.1</span> Description</a></li>
<li><a class="nav-link" href="#data-on-the-server"><span class="header-section-number">A.2</span> Data on the server</a></li>
<li><a class="nav-link" href="#description-of-input-data"><span class="header-section-number">A.3</span> Description of input data</a></li>
<li>
<a class="nav-link" href="#methods"><span class="header-section-number">A.4</span> Methods</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#metagenomes-and-metatransriptopmes"><span class="header-section-number">A.4.1</span> Metagenomes and metatransriptopmes</a></li>
<li><a class="nav-link" href="#single-cell-amplified-genomes"><span class="header-section-number">A.4.2</span> Single-Cell Amplified Genomes</a></li>
</ul>
</li>
<li><a class="nav-link" href="#installing-and-running-gtdb-tk"><span class="header-section-number">A.5</span> Installing and running GTDB-Tk</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Gene-centric mapping of microbial community structure and function</strong>: 2020.21 MICB425 Mirobial Ecological Genomics Capstone project" was written by Stephan Koenig, Kim Dill-McFarland, Connor Morgan-Lang, Ryan McLaughlin, Julia Anstett, Resmi Radhamony, Sean Crowe and Steven Hallam. It was last built on August 18, 2021.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
