<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5 Classifying unknown sequences with TreeSAPP and updating a reference package | Gene-centric mapping of microbial community structure and function</title>
<meta name="author" content="Stephan Koenig, Kim Dill-McFarland, Connor Morgan-Lang, Ryan McLaughlin, Julia Anstett, Resmi Radhamony, Sean Crowe and Steven Hallam">
<meta name="description" content="5.1 Introduction and goals We will be updating the new particulate methane monooxygenase (pMMO) and ammonia monooxygenase (AMO) alpha subunit, or XmoA, reference package with XmoA amino acid...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="5 Classifying unknown sequences with TreeSAPP and updating a reference package | Gene-centric mapping of microbial community structure and function">
<meta property="og:type" content="book">
<meta property="og:description" content="5.1 Introduction and goals We will be updating the new particulate methane monooxygenase (pMMO) and ammonia monooxygenase (AMO) alpha subunit, or XmoA, reference package with XmoA amino acid...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5 Classifying unknown sequences with TreeSAPP and updating a reference package | Gene-centric mapping of microbial community structure and function">
<meta name="twitter:description" content="5.1 Introduction and goals We will be updating the new particulate methane monooxygenase (pMMO) and ammonia monooxygenase (AMO) alpha subunit, or XmoA, reference package with XmoA amino acid...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="2020.21 MICB425 Mirobial Ecological Genomics Capstone project">Gene-centric mapping of microbial community structure and function</a>:
        <small class="text-muted">2020.21 MICB425 Mirobial Ecological Genomics Capstone project</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="exploring-the-microcosmos.html"><span class="header-section-number">1</span> Exploring the microcosmos</a></li>
<li class="book-part">Tutorials</li>
<li><a class="" href="a-tutorial-for-using-treesapp.html"><span class="header-section-number">2</span> A tutorial for using TreeSAPP</a></li>
<li><a class="" href="acquiring-reference-sequence-data.html"><span class="header-section-number">3</span> Acquiring reference sequence data</a></li>
<li><a class="" href="treesapp-create.html"><span class="header-section-number">4</span> Creating a reference package for TreeSAPP</a></li>
<li><a class="active" href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html"><span class="header-section-number">5</span> Classifying unknown sequences with TreeSAPP and updating a reference package</a></li>
<li><a class="" href="calculating-relative-abundance-of-metaomic-data.html"><span class="header-section-number">6</span> Calculating relative abundance of meta’omic data</a></li>
<li><a class="" href="analysing-the-treesapp-classifications-in-r.html"><span class="header-section-number">7</span> Analysing the TreeSAPP classifications in R</a></li>
<li><a class="" href="basic-automation-with-r.html"><span class="header-section-number">8</span> Basic Automation with R</a></li>
<li class="book-part">Capstone project</li>
<li><a class="" href="project-description.html"><span class="header-section-number">9</span> Project description</a></li>
<li><a class="" href="assessment.html"><span class="header-section-number">10</span> Assessment</a></li>
<li><a class="" href="running-treesapp-on-a-server.html"><span class="header-section-number">11</span> Running TreeSAPP on a server</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="the-saanich-inlet-data-set.html"><span class="header-section-number">A</span> The Saanich Inlet data set</a></li>
<li><a class="" href="treesapp-reference-packages.html"><span class="header-section-number">B</span> TreeSAPP reference packages</a></li>
<li><a class="" href="shell-cheat-sheet.html"><span class="header-section-number">C</span> Shell cheat sheet</a></li>
<li><a class="" href="references.html"><span class="header-section-number">D</span> References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/EDUCE-UBC/MICB425">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package" class="section level1">
<h1>
<span class="header-section-number">5</span> Classifying unknown sequences with TreeSAPP and updating a reference package<a class="anchor" aria-label="anchor" href="#classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-and-goals-3" class="section level2">
<h2>
<span class="header-section-number">5.1</span> Introduction and goals<a class="anchor" aria-label="anchor" href="#introduction-and-goals-3"><i class="fas fa-link"></i></a>
</h2>
<p>We will be updating the new particulate methane monooxygenase (pMMO) and ammonia monooxygenase (AMO) alpha subunit, or XmoA, reference package with XmoA amino acid sequences sourced from UniProt. You already created the reference package (<a href="treesapp-create.html#treesapp-create">Creating a Reference Package For TreeSAPP</a>) and downloaded the sequences that will be used to update it (<a href="acquiring-reference-sequence-data.html#acquiring-reference-sequence-data">Acquiring reference sequence data</a>).</p>
<p>There are four goals of this tutorial:</p>
<ol style="list-style-type: decimal">
<li>Learn how to classify query sequences using <code>treesapp assign</code>.</li>
<li>Learn how to update a TreeSAPP reference package with <code>treesapp update</code>.</li>
<li>Learn how to use <code>treesapp colour</code> to colour a phylogeny in iTOL.</li>
<li>Learn how to annotate features of phylogenetic clades using <code>treesapp layer</code>.</li>
</ol>
<p>The first step involves using <code>treesapp assign</code> to classify the UniProt XmoA sequences. The second step is to use <code>treesapp update</code> to add the new sequences to the original XmoA reference package.</p>
</div>
<div id="classify-new-sequences" class="section level2">
<h2>
<span class="header-section-number">5.2</span> Classify new sequences<a class="anchor" aria-label="anchor" href="#classify-new-sequences"><i class="fas fa-link"></i></a>
</h2>
<p>Before we can begin using TreeSAPP, we must log onto the server and make sure we’re in the same directory as all our data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb17-1"></a><span class="bu">cd</span> /data/<span class="op">&lt;</span>user<span class="op">&gt;</span>/tutorial/</span></code></pre></div>
<p>According to <code>treesapp purity</code> in the <a href="treesapp-create.html#treesapp-create">last chapter</a>, and all other sanity checks, the XmoA reference package (contained in your working directory, <code>/data/&lt;user&gt;/tutorial</code>, at <code>XmoA_seed/final_outputs/XmoA_build.pkl</code>) only contains XmoA sequences. At this point, you’re able to use this reference package to classify sequences in any dataset using <code>treesapp assign</code>.</p>
<p>The command <code>treesapp assign</code> is perhaps the most popular command and is described in detail on the <a href="https://github.com/hallamlab/TreeSAPP/wiki/Classifying-sequences-with-treesapp-assign">TreeSAPP wiki</a>.</p>
<p>For these commands we will use the Block Mapping and Gathering with Entropy (BMGE) software to filter out regions of questionable homology from the alignment <span class="citation">(<a href="references.html#ref-Criscuolo.2010" role="doc-biblioref">6</a>)</span>. Refer to the <a href="https://bmcecolevol.biomedcentral.com/articles/10.1186/1471-2148-10-210">BMGE publication</a> for more information. To trim the multiple sequence alignments prior to phylogenetic placement use the <code>--trim_align</code> flag.
To use the PmoA and AmoA reference package we’ve built instead of any other reference packages that come with TreeSAPP we can use the argument <code>--refpkg_dir</code> with the path to a directory containing reference packages we want to use.</p>
<p>As usual, if you’re unclear as to what any arguments are, you can use <code>treesapp assign -h</code> to get the complete usage and descriptions of each argument.</p>
<div id="classifying-amino-acid-sequences" class="section level3">
<h3>
<span class="header-section-number">5.2.1</span> Classifying amino acid sequences<a class="anchor" aria-label="anchor" href="#classifying-amino-acid-sequences"><i class="fas fa-link"></i></a>
</h3>
<p>We’re first going to classify PmoA and AmoA sequences sourced from UniProt.
Before we classify them, the sequences all need to be combined in a single file using the <code>cat</code> shell command.</p>
<ul>
<li>Use <code>cat</code> to combine PmoA and AmoA sequences into the file <code>UniProt_XmoA.fasta</code>.
The output of <code>cat</code> is redirected from the console with the <code>&gt;</code> symbol to a <code>&lt;new file&gt;</code>.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb18-1"></a><span class="fu">cat</span> UniProt_AmoA.fasta UniProt_PmoA.fasta <span class="op">&gt;</span> UniProt_XmoA.fasta</span></code></pre></div>
<p>This new file will be the input to <code>treesapp assign</code>, provided with the <code>--fastx_input</code> argument.
In past TreeSAPP commands we specified the path to a single reference package with the <code>--refpkg_path</code> argument.
Since <code>treesapp assign</code> is capable of using multiple reference packages, the analogous argument is <code>--refpkg_dir</code>.
This should point to a directory containing one or more reference package .pkl files, all of which can be used for classifying the query sequences.
The output directory is <code>UniProt_XmoA_assign/</code>.</p>
<ul>
<li>Classify the 6966<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This is the number of sequences included in the files provided. Your files may be slightly different, and that’s &lt;em&gt;probably&lt;/em&gt; okay.&lt;/p&gt;"><sup>1</sup></a> protein sequences in <code>UniProt_XmoA.fasta</code> using <code>treesapp assign</code>.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb19-1"></a><span class="ex">treesapp</span> assign \</span>
<span id="cb19-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb19-2"></a>  -n 4 \</span>
<span id="cb19-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb19-3"></a>  --trim_align \</span>
<span id="cb19-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb19-4"></a>  --refpkg_dir XmoA_seed/final_outputs/ \</span>
<span id="cb19-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb19-5"></a>  --fastx_input UniProt_XmoA.fasta \</span>
<span id="cb19-6"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb19-6"></a>  --output UniProt_XmoA_assign/</span></code></pre></div>
<p>The command should take approximately twenty seconds to complete and if you see the line <code>TreeSAPP has finished successfully.</code> at the end then you’re good to move on.</p>
</div>
<div id="classifying-orfs-predicted-from-genomes" class="section level3">
<h3>
<span class="header-section-number">5.2.2</span> Classifying ORFs predicted from genomes<a class="anchor" aria-label="anchor" href="#classifying-orfs-predicted-from-genomes"><i class="fas fa-link"></i></a>
</h3>
<p>The second batch of sequences that we will classify XmoA from are metagenome-assembled genomes (MAGs). MAGs are derived from assembled metagenome datasets (i.e. contigs or scaffolds) and represent the genome of a closely related microbial population. You can think of them as representing a single strain present in a microbial community.</p>
<p>We will need to download two files: the FASTA file containing the genomes and a table with the taxonomic label for each genome. These files, <code>SI072_MAGs.fa</code> and <code>SI072_MAGs_gtdbtk.bac120.summary.tsv</code>, are contained within a larger data package that we will be revisiting in the next tutorial.</p>
<ul>
<li>Download the data package <code>SI072_sequence_data.tar.gz</code> from Zenodo and decompress it with <code>tar</code>.</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb20-1"></a><span class="fu">wget</span> https://zenodo.org/record/6323402/files/SI072_sequence_data.tar.gz <span class="kw">&amp;&amp;</span> <span class="kw">\</span></span>
<span id="cb20-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb20-2"></a><span class="fu">tar</span> -xzvf SI072_sequence_data.tar.gz</span></code></pre></div>
<p>The FASTA file was created by concatenating twelve different MAGs into a single file and prepending each sequence name (i.e. header) with the MAG name using the software <a href="https://bioinf.shenwei.me/seqkit/">seqkit</a>.
Concatenating multiple genomes into a single file saves time since you only need to run <code>treesapp assign</code> once instead of classifying each MAG individually.
Prepending the header with its respective MAG name is necessary to properly map the names of the query sequences back to their original genome names during the update process. Here is the shell command used (do not run):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb21-1"></a><span class="kw">for</span> <span class="ex">f</span> in *fa</span>
<span id="cb21-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb21-2"></a><span class="kw">do</span></span>
<span id="cb21-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb21-3"></a>  <span class="va">mag_name=$(</span> <span class="fu">basename</span> <span class="va">$f</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">'s/.fa//g'</span> <span class="va">)</span></span>
<span id="cb21-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb21-4"></a>  <span class="fu">cat</span> <span class="va">$f</span> <span class="kw">|</span> <span class="ex">seqkit</span> replace -p <span class="st">"^"</span> -r <span class="st">"</span><span class="va">${mag_name}</span><span class="st">_"</span> <span class="op">&gt;&gt;</span>SI072_MAGs.fa</span>
<span id="cb21-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb21-5"></a><span class="kw">done</span></span></code></pre></div>
<p>The <code>treesapp assign</code> command we use is very similar from those we’ve used in the past.
We do not need to indicate which molecule type it is (i.e., nucleotides or amino acids) as TreeSAPP automatically determines this when reading the input.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb22-1"></a><span class="ex">treesapp</span> assign \</span>
<span id="cb22-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb22-2"></a>  -n 4 \</span>
<span id="cb22-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb22-3"></a>  --trim_align \</span>
<span id="cb22-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb22-4"></a>  --refpkg_dir XmoA_seed/final_outputs/ \</span>
<span id="cb22-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb22-5"></a>  --fastx_input SI072_sequence_data/SI072_MAGs.fa \</span>
<span id="cb22-6"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb22-6"></a>  --output SI072_MAGs_assign/</span></code></pre></div>
<p>This command should take less than a minute to complete.
An extra step was required here for open reading frames (ORFs) to be predicted using the software <a href="https://github.com/hyattpd/Prodigal">Prodigal</a>.
The ORFs were translated to create protein sequences required by TreeSAPP for homology search, phylogenetic placement, etc.</p>
</div>
</div>
<div id="update-the-reference-package-with-new-sequences" class="section level2">
<h2>
<span class="header-section-number">5.3</span> Update the reference package with new sequences<a class="anchor" aria-label="anchor" href="#update-the-reference-package-with-new-sequences"><i class="fas fa-link"></i></a>
</h2>
<p>The initial XmoA_seed reference package was pretty small with just 36 sequences (information was retrieved using <code>treesapp package view num_seqs -r XmoA_seed/final_outputs/XmoA_build.pkl</code>). Also, there were only bacterial sequences included in this version and we know there are archaeal ammonia oxidizers too.
Let’s see if we can expand on this seed reference package using the sequences from UniProt.</p>
<div id="updating-with-publicly-available-sequences" class="section level3">
<h3>
<span class="header-section-number">5.3.1</span> Updating with publicly available sequences<a class="anchor" aria-label="anchor" href="#updating-with-publicly-available-sequences"><i class="fas fa-link"></i></a>
</h3>
<p>You have already seen many of these flags and arguments before, and they’re used again here just to remind TreeSAPP that we want results fast.
A couple of new ones are used, though. <code>treesapp update</code> won’t take just any old FASTA file but relies on the outputs produced by <code>treesapp assign</code>.
So we’ll guide it to the relevant output directory with <code>--treesapp_output UniProt_XmoA_assign/</code>.
From there, it will figure out what sequences were classified and what their assigned lineages were.</p>
<p>By default TreeSAPP will use the lineage that was assigned to each classified query sequence from the <code>treesapp assign</code> outputs.
Although these sequences are from UniProt (and originally GenBank) they do not have NCBI accessions or taxonomy IDs in the header, so we must provide taxonomic lineages for each sequence in a table.
Fortunately, we already have this information in the files <code>UniProt_AmoA.tab</code> and <code>UniProt_PmoA.tab</code>.</p>
<ul>
<li>Create a table mapping sequence names to taxonomic lineage information for <code>treesapp update</code>.
The first command creates a new file (<code>UniProt_XmoA.tsv</code>) with the table column names.
The second command pipes all rows in the UniProt lineage tables except the header line by using the <code>tail</code> command.
The <code>-q</code> parameter prevents <code>tail</code> from including the file name in the output.
The UniProt table rows are appended to the new file by using <code>&gt;&gt;</code> instead of one <code>&gt;</code>.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb23-1"></a><span class="bu">echo</span> -e <span class="st">"SeqID\tOrganism\tDomain\tPhylum\tClass\tOrder\tFamily\tGenus\tSpecies"</span> <span class="op">&gt;</span>UniProt_XmoA.tsv</span>
<span id="cb23-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb23-2"></a><span class="fu">tail</span> -q -n +2 UniProt_*tab <span class="op">&gt;&gt;</span>UniProt_XmoA.tsv</span></code></pre></div>
<p>Alternatively, inverse pattern matching the word “Entry” — the first column name in the exported UniProt tables — with <code>grep --no-filename -v Entry UniProt_*tab</code> could have also worked.</p>
<p>To make TreeSAPP use this new table instead of using the taxonomic classifications generated by <code>treesapp assign</code> we use the <code>--skip_assign</code> flag.<br>
Finally, we are going to require that taxonomic lineages are resolved to at least the rank of <em>Order</em> with the argument <code>--min_taxonomic_rank</code>.
Resolving lineages of sequences to at least this rank will help us link them to their respective CuMMO groups more precisely.
This level of resolution isn’t necessary for all reference packages but given the metabolic diversity within the CuMMOs of <em>Proteobacteria</em> alone, it is here.</p>
<ul>
<li>Update the reference package <code>XmoA_seed/final_outputs/XmoA_build.pkl</code> with classified UniProt XmoA sequences.
Use the argument <code>--seqs2lineage</code> to specify the path to the table containing taxonomic lineages for all UniProt XmoA sequences.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-1"></a><span class="ex">treesapp</span> update \</span>
<span id="cb24-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-2"></a>  --fast \</span>
<span id="cb24-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-3"></a>  --headless \</span>
<span id="cb24-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-4"></a>  --overwrite \</span>
<span id="cb24-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-5"></a>  --delete \</span>
<span id="cb24-6"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-6"></a>  --cluster \</span>
<span id="cb24-7"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-7"></a>  --trim_align \</span>
<span id="cb24-8"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-8"></a>  --min_taxonomic_rank o \</span>
<span id="cb24-9"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-9"></a>  -n 4 \</span>
<span id="cb24-10"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-10"></a>  --output XmoA_UniProt_update/ \</span>
<span id="cb24-11"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-11"></a>  --skip_assign \</span>
<span id="cb24-12"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-12"></a>  --treesapp_output UniProt_XmoA_assign/ \</span>
<span id="cb24-13"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-13"></a>  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkl \</span>
<span id="cb24-14"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb24-14"></a>  --seqs2lineage UniProt_XmoA.tsv</span></code></pre></div>
<p>It looks like 39 new sequences were introduced into the reference package, bringing the total to 75 sequences.
And judging from the taxonomic rank summary printed during runtime both Archaea and Bacteria are now included:</p>
<pre><code>Number of unique lineages:
    root       1
    domain     2
    phylum     6
    class      7
    order     10
    family    14
    genus     29
    species   46</code></pre>
</div>
<div id="updating-with-mag-sequences" class="section level3">
<h3>
<span class="header-section-number">5.3.2</span> Updating with MAG sequences<a class="anchor" aria-label="anchor" href="#updating-with-mag-sequences"><i class="fas fa-link"></i></a>
</h3>
<p>We are now going to update the reference package that we just updated using the MAG sequences to demonstrate how to iteratively update reference packages.
Like the previous update, we must provide the taxonomic labels for each MAG.
The MAGs were assigned taxonomic labels using the <a href="https://gtdb.ecogenomic.org/">Genome Taxonomy Database</a> toolkit (GTDB-tk)<span class="citation">(<a href="references.html#ref-Chaumeil.2019" role="doc-biblioref">7</a>)</span>.</p>
<p>We first need to reformat the table containing the taxonomic labels of the MAGs. We will employ the shell functions <code>awk</code> and <code>sed</code> to pull out the two columns we need and find-and-replace words and characters.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb26-1"></a><span class="fu">awk</span> -F<span class="st">"\t"</span> <span class="st">'{ OFS="\t"; print $1,$2 }'</span> SI072_sequence_data/SI072_MAGs_gtdbtk.bac120.summary.tsv <span class="kw">|</span> <span class="kw">\</span></span>
<span id="cb26-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb26-2"></a><span class="fu">sed</span> <span class="st">'s/user_genome/Organism/g'</span> <span class="kw">|</span> <span class="kw">\</span></span>
<span id="cb26-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb26-3"></a><span class="fu">sed</span> <span class="st">'s/classification/Lineage/g'</span> <span class="kw">|</span> <span class="kw">\</span></span>
<span id="cb26-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb26-4"></a><span class="fu">sed</span> <span class="st">'s/;/; /g'</span> <span class="op">&gt;</span>gtdb_classifications.tsv</span></code></pre></div>
<p>Now that we have everything we need we can proceed to run <code>treesapp update</code> to add the MAG sequences to the reference package.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb27-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-1"></a><span class="ex">treesapp</span> update \</span>
<span id="cb27-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-2"></a>  --fast \</span>
<span id="cb27-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-3"></a>  --headless \</span>
<span id="cb27-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-4"></a>  --overwrite \</span>
<span id="cb27-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-5"></a>  --delete \</span>
<span id="cb27-6"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-6"></a>  --cluster \</span>
<span id="cb27-7"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-7"></a>  --trim_align \</span>
<span id="cb27-8"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-8"></a>  -n 4 \</span>
<span id="cb27-9"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-9"></a>  --output XmoA_MAG_update/ \</span>
<span id="cb27-10"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-10"></a>  --skip_assign \</span>
<span id="cb27-11"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-11"></a>  --seqs2lineage gtdb_classifications.tsv \</span>
<span id="cb27-12"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-12"></a>  --treesapp_output SI072_MAGs_assign/ \</span>
<span id="cb27-13"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb27-13"></a>  --refpkg_path XmoA_UniProt_update/final_outputs/XmoA_build.pkl</span></code></pre></div>
<p>One of the XmoA sequences from the MAGs should have been added to the reference package bringing the total to 77 reference sequences.</p>
<p>A summary of the reference package will have been printed to the screen if <code>treesapp update</code> completed properly, and it should look like this:</p>
<pre><code>Summary of the updated reference package:
ReferencePackage instance of XmoA (N0102):
    Molecule type:                                      'prot'
    TreeSAPP version:                                   '0.11.3'
    Profile HMM length:                                 '246'
    Substitution model used for phylogenetic inference: 'LG+G4'
    Number of reference sequences (leaf nodes):          77
    Software used to infer phylogeny:                   'FastTree'
    Date of last update:                                '2022-03-01'
    Description:                                        'Alpha subunits of copper membrane monooxygenase enzymes'</code></pre>
<p>For supplementary reading on how to integrate sequences from SAGs and MAGs into reference packages please visit the <a href="https://github.com/hallamlab/TreeSAPP/wiki/Integrating-MAGs-and-SAGs-in-reference-packages">TreeSAPP Wiki</a>.</p>
</div>
</div>
<div id="annotate-clades" class="section level2">
<h2>
<span class="header-section-number">5.4</span> Annotate clades<a class="anchor" aria-label="anchor" href="#annotate-clades"><i class="fas fa-link"></i></a>
</h2>
<p>Protein families vary in their evolutionary complexity; many, especially genes involved in scavenging and metabolizing nutrients, have often been involved in some gene duplication and/or lateral gene transfer event. Moreover, closely related enzymes can vary in their activities and it is often valuable, though not necessary, to annotate such features. As previously discussed, XmoA includes PmoA and AmoA, which are involved in oxidizing methane and ammonia, respectively. Still other activities are mediated by members of this metabolically diverse protein family, including ethylene, propane and butane oxidation <span class="citation">(<a href="references.html#ref-Khadka.2018" role="doc-biblioref">5</a>)</span>. Here, we will annotate reference sequences in the XmoA reference package so TreeSAPP can classify sequences more precisely and create colour-annotation files for iTOL.</p>
<p>Creating your own annotations involves scouring the literature to identify the phenotypes associated with each organism or taxon. For example, you would need to determine what paralogs or substrates are used by each organism in the reference package. Often though, these phenotypes are conserved across larger taxonomic groups, such as whole genera, families, orders, etc.
If you are not familiar with the evolution of a protein family it may be helpful to find reference sequences for the activity, function, or other feature you’re interested in and place them on the tree with <code>treesapp assign</code>. Then, guided by these sequences, it should be easier to annotate the clades.
Seeing as a literature review can’t be accomplished within the time span of this tutorial, you can use the annotations already created for the XmoA reference package with extensive support from the literature <span class="citation">(<a href="references.html#ref-Khadka.2018" role="doc-biblioref">5</a>, <a href="references.html#ref-Hallam2006" role="doc-biblioref">8</a>–<a href="references.html#ref-Rochman2020" role="doc-biblioref">11</a>)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb29-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb29-1"></a><span class="fu">wget</span> https://raw.githubusercontent.com/hallamlab/RefPkgs/master/Nitrogen_metabolism/Nitrification/XmoA/XmoA_taxonomy-phenotype_map.tsv</span></code></pre></div>
<p>You can view the contents of this file with the Unix command <code>less</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb30-1"></a><span class="fu">less</span> XmoA_taxonomy-phenotype_map.tsv</span></code></pre></div>
<pre><code>d__Archaea      AmoA_AOA
p__Verrucomicrobia      PmoA
p__Actinobacteria       BmoA
o__Chromatiales AmoA_AOB
f__Methylococcaceae     PmoA
f__Nitrosomonadaceae    AmoA_AOB
g__Haliea       EmoA
g__Methylocystis        PmoA
g__Methylosinus PmoA
g__Methylohalobius      PmoA
g__Methylocapsa PmoA
g__Methylothermus       PmoA
g__Methylomarinovum     PmoA
g__Hydrogenophaga       Unknown
s__Crenothrix polyspora PmoA
Candidatus Methylomirabilis oxyfera     PmoA
1116472.MGMO_167c00070  PxmA 
743836.AYNA01000128_gene1400    PxmA
1116472.MGMO_123c00040  PxmA
697282.Mettu_1055       PxmA
686340.Metal_1434       PxmA
ACE95886        PxmA
ACE95893        PxmA
ACE95890        PxmA
AEF15859        PxmA
tr|A0A1R4H2I8|A0A1R4H2I8_9GAMM  PxmA</code></pre>
<p>To create annotate the XmoA reference sequences as these more resolved orthologous groups we will use <code>treesapp package</code>.
The specific reference package attribute that is modified is “feature_annotations”.
The <code>treesapp package edit</code> subcommand only allows for a single attribute to be specified.
If the “feature_annotations” attribute is being edited the next command-line parameter indicates the name of the feature-annotation to edit.</p>
<ul>
<li>Add a new reference package feature annotation called CuMMO that will store the type of CuMMO for each reference XmoA sequence.
Include <code>--overwrite</code> to write the updated reference package to the same file.
<!-- file compatible with iTOL you will need to convert the taxonomy-phenotype mapping file with `treesapp colour`.  -->
</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb32-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb32-1"></a><span class="ex">treesapp</span> package edit \</span>
<span id="cb32-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb32-2"></a>  feature_annotations CuMMO \</span>
<span id="cb32-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb32-3"></a>  -r XmoA_MAG_update/final_outputs/XmoA_build.pkl \</span>
<span id="cb32-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb32-4"></a>  --taxa_map XmoA_taxonomy-phenotype_map.tsv \</span>
<span id="cb32-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb32-5"></a>  --overwrite</span></code></pre></div>
<div id="annotate-features" class="section level3">
<h3>
<span class="header-section-number">5.4.1</span> Annotate features<a class="anchor" aria-label="anchor" href="#annotate-features"><i class="fas fa-link"></i></a>
</h3>
<p>With the CuMMO feature annotation included in the reference package, we can re-classify the PmoA and AmoA sequences from UniProt onto the MAG-updated reference package with <code>treesapp assign</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb33-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb33-1"></a><span class="ex">treesapp</span> assign \</span>
<span id="cb33-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb33-2"></a>  -n 4 \</span>
<span id="cb33-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb33-3"></a>  --trim_align \</span>
<span id="cb33-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb33-4"></a>  --refpkg_dir XmoA_MAG_update/final_outputs/ \</span>
<span id="cb33-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb33-5"></a>  --fastx_input UniProt_XmoA.fasta \</span>
<span id="cb33-6"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb33-6"></a>  --output UniProt_XmoA_update_assign/</span></code></pre></div>
<p>With the clade colours file in the tutorial directory, it is now simple to assign each of the classified query sequences to its respective functional guild with <code>treesapp layer</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb34-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb34-1"></a><span class="ex">treesapp</span> layer \</span>
<span id="cb34-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb34-2"></a>  --refpkg_dir XmoA_MAG_update/final_outputs/ \</span>
<span id="cb34-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb34-3"></a>  --treesapp_output UniProt_XmoA_update_assign/</span></code></pre></div>
<p>The output of this command is <code>UniProt_XmoA_update_assign/final_outputs/layered_classifications.tsv</code>.
It contains an extra column for the functional annotations but is otherwise identical to the original <code>classifications.tsv</code> file.
You can view the first 10 lines by using the Unix command <code>head</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb35-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb35-1"></a><span class="fu">head</span> UniProt_XmoA_update_assign/final_outputs/layered_classifications.tsv</span></code></pre></div>
</div>
<div id="colouring-phylogenies-in-itol" class="section level3">
<h3>
<span class="header-section-number">5.4.2</span> Colouring phylogenies in iTOL<a class="anchor" aria-label="anchor" href="#colouring-phylogenies-in-itol"><i class="fas fa-link"></i></a>
</h3>
<p>TreeSAPP can also create iTOL-compatible annotation files for colouring the phylogeny.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb36-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb36-1"></a><span class="ex">treesapp</span> colour \</span>
<span id="cb36-2"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb36-2"></a>  --output_dir XmoA_MAG_update/final_outputs/ \</span>
<span id="cb36-3"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb36-3"></a>  --refpkg_path XmoA_MAG_update/final_outputs/XmoA_build.pkl \</span>
<span id="cb36-4"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb36-4"></a>  --attribute CuMMO \</span>
<span id="cb36-5"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb36-5"></a>  --unknown_colour grey</span></code></pre></div>
<p>The two output files —<code>XmoA_CuMMO_colours_style.txt</code> and <code>XmoA_CuMMO_colour_strip.txt</code>— can be used to bring colour to the JPlace file in iTOL.
The default colour palette used is “BrBG” from <a href="https://colorbrewer2.org/">colorbrewer.org</a> but this can be changed by the <code>--palette</code> argument to any other colorbrewer palette.</p>
<p>Let’s copy these two files into the <code>UniProt_XmoA_update_assign/iTOL_output</code> directory and transfer them to <code>&lt;path to ts_tutorial_local&gt;</code> on your (local) computer.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb37-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb37-1"></a><span class="fu">cp</span> XmoA_MAG_update/final_outputs/XmoA_CuMMO_*.txt UniProt_XmoA_update_assign/iTOL_output/</span></code></pre></div>
<ul>
<li>
<strong>On your computer:</strong> Transfer <code>UniProt_XmoA_update_assign/iTOL_output/</code> from the server to your local directory <code>ts_tutorial_local</code>.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#cb38-1"></a><span class="fu">scp</span> -r root@<span class="op">&lt;</span>server address<span class="op">&gt;</span>:/data/<span class="op">&lt;</span>user<span class="op">&gt;</span>/tutorial/UniProt_XmoA_update_assign/iTOL_output <span class="op">&lt;</span>path to ts_tutorial_local<span class="op">&gt;</span></span></code></pre></div>
<ul>
<li><p>Navigate to <a href="https://itol.embl.de/" class="uri">https://itol.embl.de/</a> using a web browser and sign in using the group’s username and password.</p></li>
<li><p>Upload the file <code>XmoA_complete_profile.jplace</code>. You can do this using either your computer’s file browser then navigating to the <code>iTOL_output</code> directory and clicking-and-dragging the file, or iTOL’s file uploader—the “Upload tree files” button.</p></li>
<li><p>Next, navigate to the page displaying the phylogeny and click-and-drag the file <code>XmoA_labels.txt</code> from your file browser into the iTOL window. This should convert the TreeSAPP identifiers (e.g. 1_XmoA) to more useful descriptions with the organism name and accession for each leaf node.</p></li>
<li><p>The two files <code>XmoA_CuMMO_colours_style.txt</code> and <code>XmoA_CuMMO_colour_strip.txt</code> can be dragged into the iTOL browser window to bring colour to the XmoA tree.</p></li>
<li><p>Finally, turn on the “Phylogenetic Placements” dataset (right of the screen). The figure should look identical to Figure <a href="classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html#fig:XmoA-Classified">5.1</a></p></li>
</ul>
<div class="figure">
<span style="display:block;" id="fig:XmoA-Classified"></span>
<img src="images/XmoA_tree_MAG_update_mapped.svg" style="width:100.0%" alt=""><p class="caption">FIGURE 5.1: XmoA phylogeny after functional annotation. Red bubbles are positioned at the mid-point of branches where 6921 query proteins from UniProt were placed. Phylogeny was rooted at the midpoint in iTOL.</p>
</div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="treesapp-create.html"><span class="header-section-number">4</span> Creating a reference package for TreeSAPP</a></div>
<div class="next"><a href="calculating-relative-abundance-of-metaomic-data.html"><span class="header-section-number">6</span> Calculating relative abundance of meta’omic data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package"><span class="header-section-number">5</span> Classifying unknown sequences with TreeSAPP and updating a reference package</a></li>
<li><a class="nav-link" href="#introduction-and-goals-3"><span class="header-section-number">5.1</span> Introduction and goals</a></li>
<li>
<a class="nav-link" href="#classify-new-sequences"><span class="header-section-number">5.2</span> Classify new sequences</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#classifying-amino-acid-sequences"><span class="header-section-number">5.2.1</span> Classifying amino acid sequences</a></li>
<li><a class="nav-link" href="#classifying-orfs-predicted-from-genomes"><span class="header-section-number">5.2.2</span> Classifying ORFs predicted from genomes</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#update-the-reference-package-with-new-sequences"><span class="header-section-number">5.3</span> Update the reference package with new sequences</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#updating-with-publicly-available-sequences"><span class="header-section-number">5.3.1</span> Updating with publicly available sequences</a></li>
<li><a class="nav-link" href="#updating-with-mag-sequences"><span class="header-section-number">5.3.2</span> Updating with MAG sequences</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#annotate-clades"><span class="header-section-number">5.4</span> Annotate clades</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#annotate-features"><span class="header-section-number">5.4.1</span> Annotate features</a></li>
<li><a class="nav-link" href="#colouring-phylogenies-in-itol"><span class="header-section-number">5.4.2</span> Colouring phylogenies in iTOL</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/EDUCE-UBC/MICB425/blob/main/treesapp_assign_and_update.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/EDUCE-UBC/MICB425/edit/main/treesapp_assign_and_update.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Gene-centric mapping of microbial community structure and function</strong>: 2020.21 MICB425 Mirobial Ecological Genomics Capstone project" was written by Stephan Koenig, Kim Dill-McFarland, Connor Morgan-Lang, Ryan McLaughlin, Julia Anstett, Resmi Radhamony, Sean Crowe and Steven Hallam. It was last built on March 27, 2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
