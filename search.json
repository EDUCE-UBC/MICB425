[{"path":"index.html","id":"overview","chapter":"Overview","heading":"Overview","text":"document introduces bioinformatics workflows useful gene-centric mapping functional phylogenetic anchors encoded microbial genomes sourced natural engineered environments.Part outlines motivation insights afforded use workflows study uncultivated microbial community structure function.Part II provides hands-tutorials learn two effective tools gene-centric analysis, TreeSAPP iTOL.Part III described capstone project explore primary metagenomic metatranscriptomic data collected Saanich Inlet water column spanning defined nutrient energy gradient.","code":""},{"path":"exploring-the-microcosmos.html","id":"exploring-the-microcosmos","chapter":"1 Exploring the microcosmos","heading":"1 Exploring the microcosmos","text":"","code":""},{"path":"exploring-the-microcosmos.html","id":"background","chapter":"1 Exploring the microcosmos","heading":"1.1 Background","text":"live world dominated microbial life. Accounting bacteria archaea (prokaryotes) alone, estimated 1030 cells occupy biosphere. Earth’s history, microcosmos driving matter energy transformations distributed networks metabolite exchange resulting global biogeochemical cycles symbiotic interactions create sustain conditions multicellular existence, including .Recent advances high-throughput sequencing mass spectrometry platforms enabled us develop quantitative insights networks’ structure function individual, population, community levels biological organization. resulting data sets revealed incredible diversity ecological resilience provided opportunity develop predictive models sustainable biotechnologies potential transform way humans interact natural world one another.Despite power promise new perception, exist dangerously close upsetting planetary boundaries promoted successful human expansion past 20,000 years. Global climate change one manifestation cost paid pursuit material energy resources. Still, others, including biodiversity loss habitat destruction, rampant pollution, imbalances integral element cycling nitrogen phosphorous.Given increasing availability data sets describing microbial community structure function world around us, opportunity learn information using bioinformatic tools approaches. course, focus one manifestation climate change-related dissolved oxygen () loss ocean using model ecosystem source multi-omic (DNA RNA) geochemical parameter information space time.Oxygen minimum zones (OMZs) widespread areas low subsurface waters. Climate change resulting increased stratification reduced oxygen solubility warming waters leads OMZ expansion. Consequently, oxygen levels decline, microbial communities inhabiting OMZ waters shift metabolisms utilize alternative terminal electron acceptors. shift results production climate-active trace gases nitrous oxide (N2O) methane (CH4).Specifically, study effects changing oxygen levels communities bacteria archaea inhabiting Saanich Inlet water column. Saanich Inlet, situated coast Vancouver Island, British Columbia, seasonally anoxic fjord provides biodynamic perspective OMZ expansion. systems ecology perspective, OMZs provide useful environmental contexts study coupled biogeochemical cycling distributed metabolic networks, especially integration carbon, nitrogen sulphur cycles.combining multi-omics geochemical parameter information OMZs, becomes possible evaluate microbial communities’ regulatory response dynamics changing levels. example, OMZs hotspots nitrogen loss processes reconstructing nitrogen cycle distributed metabolic process can shed new insight microbial controls matter energy transformations integral ocean health climate balance. Genes encoding key steps nitrogen cycle well defined (Figure 1.1), providing basis functional anchor screening determine distribution across Tree Life.\nFIGURE 1.1: Nitrogen cycle\n","code":""},{"path":"exploring-the-microcosmos.html","id":"using-multi-omic-data-to-reconstruct-distributed-networks-of-metabolite-exchange","chapter":"1 Exploring the microcosmos","heading":"1.2 Using multi-omic data to reconstruct distributed networks of metabolite exchange","text":"nitrogen cycle just one aspect distributed metabolic network defines microbial interaction space. Throughout capstone project, opportunity explore space using gene-centric approach. approach based identifying quantifying phylogenetic functional anchor genes represent key microbial players metabolic pathways system study. big picture sense, want use data answer three foundational questions concerning microbial community structure function: ? ? respond change?Biological information flow can described process converting genotypic information encoded DNA base pairs genome transcribed RNA messages translated proteins level ribosome. proteins, turn, go catalyze metabolic transformations regulatory dynamics ultimately give rise phenotypic expression, adaptation response. flow information formally referred Central Dogma Biology.Genomic sequence information provides basis determining types microorganisms present sample inferring metabolic potential individual, population community levels biological organization. DNA can persist environment longer RNA protein, can also use abundance gene X gene Y tell us prior metabolic activity, e.g. gene abundance proxy process. can use gene abundance information numerical models infer metabolic flux given pathway abundance gene X proportional genome replication resides. Genomic information also robust sampling noise collect process samples downstream analysis. information gene-centric modelling incorporating DNA, RNA protein information Saanich Inlet, see paper (1).genomic information tells us metabolic potential, transcriptome guides action gene expression. certain extent, can use information identify , often, indicate pathways active time sampling. Transcriptomic data can open window response patterns along environmental gradients caveat short-lived nature less robust sampling noise. presence transcripts given gene X guarantee conversion protein. However, prokaryotes couple transcription translation, typically infer direct relationship. information relationships DNA, RNA protein Saanich Inlet, see paper well (2).","code":""},{"path":"exploring-the-microcosmos.html","id":"treesapp","chapter":"1 Exploring the microcosmos","heading":"1.3 TreeSAPP","text":"project, implementing software application called Tree-based Sensitive Accurate Protein Profiler (TreeSAPP) (3). Given current set reference packages available, position reconstruct key steps selected biogeochemical cycles, e.g. carbon, nitrogen sulphur, along defined redox gradients Saanich Inlet. TreeSAPP takes either metagenomic metatranscriptomic reads aligns reference packages representing phylogenetic functional anchor genes interest. reference packages constructed trusted sources consist phylogenetic tree, multiple sequence alignment, hidden Markov model taxonomic lineage information. Reference packages can updated refined new sequence information becomes available, including isolate reference genomes, metagenome-assembled genomes (MAGs) single-cell amplified genomes (SAGs), thereby improving precision taxonomic placement. TreeSAPP outputs can readily visualized using interactive Tree Life (iTOL) (4) plotted R make beautiful informative data visualization products.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"a-tutorial-for-using-treesapp","chapter":"2 A tutorial for using TreeSAPP","heading":"2 A tutorial for using TreeSAPP","text":"","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"introduction-and-goals","chapter":"2 A tutorial for using TreeSAPP","heading":"2.1 Introduction and goals","text":"series tutorials, students analyze gene family creating TreeSAPP reference package (refpkg). Students work typical workflow TreeSAPP example gene (XmoA) familiarize tools, repeat steps gene assigned group reference package exists. document efforts new reference package Problem Set 5.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"treesapp-workflow","chapter":"2 A tutorial for using TreeSAPP","heading":"2.2 TreeSAPP workflow","text":"TreeSAPP Python package gene-centric analysis. uses custom protein sequence databases called reference packages (RefPkg)Acquiring reference sequence data.Creating Reference Package TreeSAPP.Classifying unknown sequences TreeSAPP updating reference package.Calculating relative abundance meta’omic data.Analysing TreeSAPP classifications R.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"genes-for-creating-reference-packages","chapter":"2 A tutorial for using TreeSAPP","heading":"2.3 Genes for creating reference packages","text":"Reference packages can built nearly protein-encoding gene demonstrate process gene-centric analysis create use reference package XmoA.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"xmoa","chapter":"2 A tutorial for using TreeSAPP","heading":"2.3.1 XmoA","text":"protein family focusing copper-containing membrane-bound monooxygenases (5). family contains particulate methane monooxygenase (pMMO) ammonia monooxygenase (AMO) well building reference package alpha subunits enzymes called XmoA. students work example individually.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"tools","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4 Tools","text":"","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"shell","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4.1 Shell","text":"Please use short Shell cheat sheet commonly used commands review previous tutorials Canvas.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"treesapp-1","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4.2 TreeSAPP","text":"Tree-based Sensitive Accurate Phylogenetic Profiler (TreeSAPP) (3) can found GitHub including excellent wiki additional information treesapp subcommands.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"itol","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4.3 iTOL","text":"Interactive Tree Life (iTOL) (4) browser-based tool allows visualize data generated TreeSAPP phylogenetic tree additional annotations.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"data","chapter":"2 A tutorial for using TreeSAPP","heading":"2.5 Data","text":"Saanich Inlet data set already located server, may download data different databases:FunGene, functional gene pipeline repositoryEggNOG, evolutionary genealogy genes: Non-supervised Orthologous Groups","code":""},{"path":"acquiring-reference-sequence-data.html","id":"acquiring-reference-sequence-data","chapter":"3 Acquiring reference sequence data","heading":"3 Acquiring reference sequence data","text":"","code":""},{"path":"acquiring-reference-sequence-data.html","id":"introduction-and-goals-1","chapter":"3 Acquiring reference sequence data","heading":"3.1 Introduction and goals","text":"Reference data context biological sequence analysis come well-curated open-source databases. data used create TreeSAPP reference packages date, used create future reference packages. “well-curated” mean, can identify data meet standard?goals tutorial :Develop sense biological sequence database curation qualityLearn subset download sequences EggNOG UniProt databases","code":""},{"path":"acquiring-reference-sequence-data.html","id":"the-golden-standard","chapter":"3 Acquiring reference sequence data","heading":"3.2 The golden standard","text":"field genomics blessed abundance reference data. fact, uncommon biologists bioinformaticians alike gripe increased run-time computational analyses caused steps include comparisons large reference databases. data , however, quality. vast majority automatically curated using algorithms known shortcomings, small portion manually curated verified functional characterization. latter data ones consider well-curated golden. details choosing databases retrieving sequences can found TreeSAPP wiki.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"recommended-biological-sequence-databases","chapter":"3 Acquiring reference sequence data","heading":"3.3 Recommended biological sequence databases","text":"One comprehensive reputable biological sequence databases SwissProt. protein sequences curated within SwissProt can accessed downloaded UniProt Knowledgebase selecting “Swiss-Prot” “UniProtKB” panel left landing page. can submit queries protein family search bar add filters query using advanced search options. example, can search reviewed RuBisCO sequences entering query ‘rubisco taxonomy:“Bacteria [2]” reviewed:yes’.EggNOG another source curated orthologous groups. breadth families available astounding often sequences ’re looking . couple benefits accessing data EggNOG. first use common identifier format. Using correct identifier protein family, single search yield available amino acid sequences belonging protein family COG. ’ve found handy first looking Clusters Orthologous Gene (COG) identifier NCBI’s Conserved Domains database. ’d use identifier search sequences ’m interested EggNOG. second benefit quality automated annotation pipeline. every version EggNOG, entire set protein sequences clustered orthologous groups defined de novo. prevents incorrect legacy annotations propagating new sequences. Unfortunately, breadth taxa covered EggNOG limited just 5,090 organisms. many cases, good enough build “seed” reference package, especially ’re building reference package well-conserved—housekeeping—gene. Yet, plenty scenarios number sequences downloaded just objective, comprehensive reference package required—.addition general -encompassing databases, smaller curated databases independently maintained. tend gene- function-specific , long ’re still maintained, highly reliable. Perhaps notable Carbohydrate Active enZYmes (CAZy) database. maintainers CAZy constantly screen new sequenced GenBank sort hits different families based putative biochemical characterization. FunGene also used extensively build reference packages due system instability variability curation quality database used less often. Still, focus biogeochemical cycles convenient organization, export process, sequence header format make database good back-.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"xmoa-example","chapter":"3 Acquiring reference sequence data","heading":"3.4 XmoA example","text":"show access data, download alpha subunit sequences enzymes particulate methane monooxygenase (PmoA) ammonia monooxygenase (AmoA) used treesapp create tutorial EggNOG UniProt databases. Since XmoA recognized identifier, convenient label reflects operon structure (xmoCAB) homologous oxidoreductase enzymes, need search databases multiple times.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"eggnog","chapter":"3 Acquiring reference sequence data","heading":"3.4.1 EggNOG","text":"Go EggNOG website http://eggnog5.embl.de/#/app/home search either “ENOG5028JPK” “arCOG08676” search bar top page. EggNOG ortholog identifiers correspond PmoA/AmoA Bacteria AmoA Archaea, respectively. image , ’ve searched “ENOG5028JPK”.Click “Download” bottom-left panel select “XX sequences (FASTA)”, XX number sequences belonging orthologous group (OG). open new window sequences OG FASTA format. Download file file computer following format <OG name>_EggNOGv5.faa <OG name> EggNOG ortholog identifier.Repeat steps EggNOG identifier.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"uniprot","chapter":"3 Acquiring reference sequence data","heading":"3.4.2 UniProt","text":"UniProt database architecture built upon standard biological attributes, contrast de novo clustering classification scheme EggNOG. Protein sequences therefore searchable using multiple keys covering range taxonomic functional specificities. specific unique identifier single protein sequence (e.g. Q04507 AmoA sequence Nitrosomonas europaea). broad searchable attributes include protein names, gene names, organism, Enzyme Commission (EC) numbers, identifiers databases PFam TIGRFAM., use gene names AmoA PmoA find reference sequences UniProt. Begin navigating https://www.uniprot.org/ typing “Particulate methane monooxygenase” (including double quotation marks) search bar top page.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"refining-the-search","chapter":"3 Acquiring reference sequence data","heading":"3.4.2.1 Refining the search","text":"12,231 sequences returned initial query. following figure, can see many entries unrelated pmoA (e.g. ftsH, ffsA, carB).\nremove -target search results, need expand search terms turn “Advanced” drop-menu right side search bar. Add “pmoa” Gene name [GN] remove sequences unresolved lineages specifying “uncultured bacterium” Taxonomy [OC] logical operator. latter filter applied since poorly annotated sequences typically derived short environmental samples taxonomically informative. advanced search fields look identical figure .specific search yield >3800 entries vast majority predicted pmoA sequences.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"download-sequences","chapter":"3 Acquiring reference sequence data","heading":"3.4.2.2 Download sequences","text":"Downloading sequences UniProt quick easy. Click  button (atop table), ensure format FASTA, click “Go” specify file saved computer. Change file name UniProt_PmoA.fasta.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"download-taxonomic-lineages","chapter":"3 Acquiring reference sequence data","heading":"3.4.2.3 Download taxonomic lineages","text":"UniProt sequence names searchable within NCBI’s database, software (including TreeSAPP) unable pair corresponding taxonomic lineages like EggNOG. Therefore, separate table must downloaded UniProt provided TreeSAPP reference package creation., check boxes organism, superkingdom, phylum, class, order, family, genus species shown .\nClick “Save” near top-right page save selection.can export table similar .\nClick  button select sequences, change format “Tab-separated”, click “Go” save table computer.\nChange file name UniProt_PmoA.tab.gather sequences UniProt XmoA reference package, repeat previous three steps string “Ammonia monooxygenase alpha subunit”, Gene name [GN] “amoA”, taxonomic filter.\n>3,000 entries returned.\nSave sequences taxonomic lineages UniProt_AmoA.fasta UniProt_AmoA.tab, respectively.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"downloading-reviewed-sequences-from-swissprot","chapter":"3 Acquiring reference sequence data","heading":"3.4.2.4 Downloading reviewed sequences from SwissProt","text":"may noticed previous steps, single manually-reviewed sequence PmoA AmoA .\ncase, sequences build seed reference package scaffolded eventually construct phylogenetically comprehensive reference package.\nStill, ten phylogenetically diverse manually-reviewed sequences, UniProt/SwissProt database sufficient construct seed reference package.\nfiltering reviewed sequenced (gold star) following previous two steps can retrieve sequences manually curated, indicating high-degree confidence functional annotation sequences.\nKeep functionality mind future reference packages.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"copying-data-onto-the-server","chapter":"3 Acquiring reference sequence data","heading":"3.4.3 Copying data onto the server","text":"computer: Create new directory called ts_tutorial_local inside home directory using file browser, .e. File Explorer (Windows 10) Finder (macOS).\nPlace reference sequences ts_tutorial_local identified downloaded databases.\nNext, connect personal server using terminal app, .e. Windows Terminal (Windows 10) Terminal (macOS).\nssh root@<server address>computer: Create new directory called ts_tutorial_local inside home directory using file browser, .e. File Explorer (Windows 10) Finder (macOS).\nPlace reference sequences ts_tutorial_local identified downloaded databases.Next, connect personal server using terminal app, .e. Windows Terminal (Windows 10) Terminal (macOS).server: Move directory /data (working directory already), create new directory called ts_tutorial move .\ncd /data/\nmkdir ts_tutorial\ncd ts_tutorialOn server: Move directory /data (working directory already), create new directory called ts_tutorial move .computer: Open second terminal window connected local computer, copy reference sequences computer server.\nscp -r <path ts_tutorial_local> root@<server address>:/data/ts_tutorial computer: Open second terminal window connected local computer, copy reference sequences computer server.","code":"ssh root@<server address>cd /data/\nmkdir ts_tutorial\ncd ts_tutorialscp -r <path to ts_tutorial_local> root@<server address>:/data/ts_tutorial "},{"path":"acquiring-reference-sequence-data.html","id":"alternative-sources","chapter":"3 Acquiring reference sequence data","heading":"3.5 Alternative sources","text":"EggNOG UniProt often useful sources, though leaves majority biological sequence databases reason simplicity. IMG, KEGG, PFam, similar databases great utility blunted either lack API retrieve lineage information, requiring separate table link information, sequence accession (database sequences uniquely named) allow easy referencing NCBI taxonomic hierarchy. Details table’s format provide can found treesapp create wiki page.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"data-access-hazards","chapter":"3 Acquiring reference sequence data","heading":"3.6 Data access hazards","text":"Accessing fraction well-curated data multiple databases trivial. Perhaps obvious reason unrelated genes shared names. example, gene product mcrB E. coli widely refers 5-methylcytosine-specific restriction enzyme B, Archaea, refer beta subunit methyl-coenzyme M reductase—completely unrelated protein. inevitability field science broad biology, scientists responsible naming genes possibly aware gene names circulation. Another issue can genes proteins synonyms, making search data complex. cases, may need search multiple databases several queries order access sequences belonging protein family.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"validation","chapter":"3 Acquiring reference sequence data","heading":"3.7 Validation","text":"number quality control measures can taken ensure functional characteristics expected.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"basic","chapter":"3 Acquiring reference sequence data","heading":"3.7.1 Basic","text":"BLAST: first method validating set candidate reference sequences use web-based Basic Local Alignment Search Tool available NCBI. Submit FASTA file containing sequences Protein BLAST (blastp) appropriate database. reduce processing time, can restrict reference sequences specific taxa use different algorithms. One thing note query size limit - blastp accept FASTA files containing fewer 100,000 characters. , good idea take representative sample cluster sequences submitting job.BLAST: first method validating set candidate reference sequences use web-based Basic Local Alignment Search Tool available NCBI. Submit FASTA file containing sequences Protein BLAST (blastp) appropriate database. reduce processing time, can restrict reference sequences specific taxa use different algorithms. One thing note query size limit - blastp accept FASTA files containing fewer 100,000 characters. , good idea take representative sample cluster sequences submitting job.EggNOG-mapper: didn’t download query sequences EggNOG database, good resource check sequences EggNOG mapper. annotate query sequences EggNOG database serve result several formats.EggNOG-mapper: didn’t download query sequences EggNOG database, good resource check sequences EggNOG mapper. annotate query sequences EggNOG database serve result several formats.","code":""},{"path":"acquiring-reference-sequence-data.html","id":"advanced","chapter":"3 Acquiring reference sequence data","heading":"3.7.2 Advanced","text":"Phylogenetic inference: Try building phylogeny candidate reference sequences see whether anomolously long branches clades.hmmsearch across PFam database: Got time kill? Try aligning candidate reference sequences profile HMMs PFam database! need done command-line need download Pfam-.hmm.gz PFam ftp site.","code":""},{"path":"treesapp-create.html","id":"treesapp-create","chapter":"4 Creating a reference package for TreeSAPP","heading":"4 Creating a reference package for TreeSAPP","text":"","code":""},{"path":"treesapp-create.html","id":"introduction-and-goals-2","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.1 Introduction and goals","text":"tutorial demonstrate build TreeSAPP reference package assess whether mis-annotated final product.goals tutorial :learn use treesapp create build reference package simple protein family (XmoA) using sequences acquired previous tutorial.Learn assess whether reference package contains homologous sequences using treesapp purity.Learn view reference package’s phylogenetic tree using interactive Tree Life (iTOL).","code":""},{"path":"treesapp-create.html","id":"making-the-reference-package","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.2 Making the reference package","text":"Acquiring reference sequence data tutorial, PmoA & AmoA sequences downloaded EggNOG UniProt. , use EggNOG sequences.\n\nLet’s call seed reference package. steps involved :steps executed server unless stated otherwise. Connect personal server continue work /data/ts_tutorial directory.Optional: download reference sequences XmoA (see Acquiring reference sequence data), download xmoa_file_list.txt — list necessary fasta files — wget ts_tutorial directory, run wget retrieve file within list.73 PmoA AmoA fasta sequences file.Let’s look briefly newly generated fasta file using cat less. cat stands concatenate, .e. files pasted together. output cat funneled, piped, | symbol text viewer called less, .e. cat file_1.ext file_2.ext | less. -S argument less command turns line-wrapping maintain readable format.notice lines start > character. character indicates subsequent characters line correspond name sequence (potentially information depending database), protein sequence one lines .can count confirm number sequences fasta file counting > using grep. grep incredibly powerful tool find matching text patterns (using format called “regular expression”) beyond scope tutorial. code searches > beginning lines (defined \"^>\") counts occurrence due option -c.Use submodule treesapp create build XmoA reference package different arguments (see visualization create workflow). speed things along, use FastTree infer phylogeny skip bootstrapping --fast. remove potential redundant sequences, cluster candidate reference sequences 97% similarity using argument -p. clustering candidate sequences TreeSAPP normally ask sequence use representative cluster. can handy cases sequences better annotated /especially important. speed things even , flag --headless prevent requests. command take ~2 minutes complete.final reference package file located XmoA_seed/final_outputs/XmoA_build.pkl. file contains individual components reference package (multiple sequence alignment, profile HMM, phylogenetic tree, taxonomic lineages) well data. files bundled using joblib Python library. can accessed individually using submodule treesapp package.Replace current refpkg_code Z1111 unique identifier N0102.can also modify reference package’s description ’re .","code":"cd /data/ts_tutorialcd /data/ts_tutorial\nwget https://raw.githubusercontent.com/hallamlab/TreeSAPP/master/docs/xmoa_file_list.txt\nwget -i xmoa_file_list.txtcat ENOG5028JPK_EggNOGv5.faa arCOG08676_EggNOGv5.faa | less -Scat ENOG5028JPK_EggNOGv5.faa arCOG08676_EggNOGv5.faa | grep -c \"^>\"treesapp create \\\n  --fast \\\n  --headless \\\n  --cluster \\\n  -n 4 \\\n  -p 0.97 \\\n  --fastx_input ENOG5028JPK_EggNOGv5.faa arCOG08676_EggNOGv5.faa \\\n  -c XmoA \\\n  --output XmoA_seedtreesapp package edit \\\n  refpkg_code N0102 \\\n  --overwrite \\\n  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkltreesapp package edit \\\n  description \"Alpha subunits of copper membrane monooxygenase enzymes\" \\\n  --overwrite \\\n  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkl"},{"path":"treesapp-create.html","id":"testing-the-purity-of-the-reference-package","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.3 Testing the purity of the reference package","text":"determine whether mis-annotated sequences included reference package treesapp purity. , take well-curated database attempt classify sequences using treesapp assign. results analysed displayed user evaluate. TIGRFAM database fairly comprehensive, representing 4488 different groups version 15, using just TIGRFAM seed sequences (TIGRFAM_seed_named.faa) can fairly sure won’t evaluating classifications mis-annotated sequences.important bit output look like thisFrom summary appears reference package classified three homologous sequences placed leaf nodes tree (.e. ’re closely related) sequences family “TIGR03080”, also known “methane monooxygenase/ammonia monooxygenase, subunit ”. , probably good proceed!","code":"treesapp purity \\\n  -n 4 \\\n  -r XmoA_seed/final_outputs/XmoA_build.pkl \\\n  --extra_info TIGRFAM_info.tsv \\\n  -i TIGRFAM_seed_named.faa \\\n  --output XmoA_puritySummarizing assignments for reference package XmoA\nOrtholog        Hits    Leaves  Tree-coverage   Description\n--------------------------------------------------------------------------------\nTIGR03080       3       3       8.3    methane monooxygenase/ammonia monooxygenase, subunit A"},{"path":"treesapp-create.html","id":"viewing-the-reference-package-tree-with-itol","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.4 Viewing the reference package tree with iTOL","text":"Among many files inferred treesapp create phylogenetic tree XmoA. ensure tree topology sensible, without anomalously long branches example, visualize iTOL. Since reference packages compressed files many attributes, use subcommand treesapp package extract tree Newick format.Use treesapp package write reference package tree file.computer: Transfer XmoA_seed/XmoA_labelled_tree.txt server local directory ts_tutorial_local.can quickly easily view sequences placed phylogeny using iTOL. uploading text file produced TreeSAPP.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Upload file XmoA_labelled_tree.txt. can using either computer’s file browser navigating parent directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.Upload file XmoA_labelled_tree.txt. can using either computer’s file browser navigating parent directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.figure look identical figure Figure 4.1.\n\nFIGURE 4.1:  Phylogenetic tree seed XmoA reference package viewed iTOL. Sequence names tree’s leaf tips show organism name unique EggNOG accession identifier.\nfigure look identical figure Figure 4.1.FIGURE 4.1:  Phylogenetic tree seed XmoA reference package viewed iTOL. Sequence names tree’s leaf tips show organism name unique EggNOG accession identifier.","code":"treesapp package \\\n  view tree \\\n  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkl > \\\n  XmoA_seed/XmoA_labelled_tree.txt scp root@<server address>:/data/ts_tutorial/XmoA_seed/XmoA_labelled_tree.txt <path to ts_tutorial_local>"},{"path":"treesapp-create.html","id":"booster-shot","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.5 Booster shot","text":"reference package XmoA relatively small, ideal -class tutorial. However, many protein families much complex members spread broadly across tree life. cases, may need use tactics reduce size reference package treesapp create can finish hours. Using following options required, may useful.Remove candidate reference sequences final reference package decreasing percent similarity used sequence clustering. tutorial set “-p”/“--similarity” 0.97 going high many cases. Try something 0.80 0.95 get 100 2000 sequences.Remove candidate reference sequences final reference package decreasing percent similarity used sequence clustering. tutorial set “-p”/“--similarity” 0.97 going high many cases. Try something 0.80 0.95 get 100 2000 sequences.profile HMM can used accomplish two things: first can used remove sequences remote homology protein family ’re building reference package ; second, HMM alignment can used trim input sequences just conserved regions improving quality multiple sequence alignment phylogeny.\ncan download profile HMM EggNOG going gene’s EggNOG page, clicking Download ᐁ “HMM model”. typically available subgroups “Bacteria”, “Archaea”, “Proteobacteria”, etc. (.e. ‘root’).\nProvide HMM file treesapp create “--profile” argument.profile HMM can used accomplish two things: first can used remove sequences remote homology protein family ’re building reference package ; second, HMM alignment can used trim input sequences just conserved regions improving quality multiple sequence alignment phylogeny.\ncan download profile HMM EggNOG going gene’s EggNOG page, clicking Download ᐁ “HMM model”. typically available subgroups “Bacteria”, “Archaea”, “Proteobacteria”, etc. (.e. ‘root’).\nProvide HMM file treesapp create “--profile” argument.Metagenomic data Saanich Inlet generated biomass larger Eukaryotic cells physically removed prior sequencing. Therefore, organisms need present reference packages. can remove sequences Eukaryotic origin using either “--screen” “--filter” arguments. example, include Bacteria Archaea use --screen Bacteria,Archaea --filter Eukaryota.Metagenomic data Saanich Inlet generated biomass larger Eukaryotic cells physically removed prior sequencing. Therefore, organisms need present reference packages. can remove sequences Eukaryotic origin using either “--screen” “--filter” arguments. example, include Bacteria Archaea use --screen Bacteria,Archaea --filter Eukaryota.“--min_taxonomic_rank” argument specifies minimum taxonomic rank sequence’s taxonomic lineage must resolved . example, using --min_taxonomic_rank g ensure sequences reference package annotated genus, species strain taxonomic rank. specify others ranks , use lowercase first letter taxonomic rank.\nreference package still large using options, setting argument highly resolved taxonomic rank can potent way remove candidate reference sequences.“--min_taxonomic_rank” argument specifies minimum taxonomic rank sequence’s taxonomic lineage must resolved . example, using --min_taxonomic_rank g ensure sequences reference package annotated genus, species strain taxonomic rank. specify others ranks , use lowercase first letter taxonomic rank.\nreference package still large using options, setting argument highly resolved taxonomic rank can potent way remove candidate reference sequences.bring arguments together example command:","code":"treesapp create\n  --fast \\\n  --headless \\\n  --overwrite \\\n  --cluster \\\n  --trim_align \\\n  -n 4 \\\n  --similarity 0.90 \\\n  --screen Bacteria,Archaea \\\n  --min_taxonomic_rank g \\\n  --profile arCOG08676_hmm.txt \\\n  --fastx_input XmoA_seed.faa \\\n  -c XmoA \\\n  --output XmoA_seed"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","text":"","code":""},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"introduction-and-goals-3","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.1 Introduction and goals","text":"updating new particulate methane monooxygenase (pMMO) ammonia monooxygenase (AMO) alpha subunit, XmoA, reference package XmoA amino acid sequences sourced UniProt. already created reference package (Creating Reference Package TreeSAPP) downloaded sequences used update (Acquiring reference sequence data).four goals tutorial:Learn classify query sequences using treesapp assign.Learn update TreeSAPP reference package treesapp update.Learn use treesapp colour colour phylogeny iTOL.Learn annotate features phylogenetic clades using treesapp layer.first step involves using treesapp assign classify UniProt XmoA sequences. second step use treesapp update add new sequences original XmoA reference package.","code":""},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classify-new-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.2 Classify new sequences","text":"can begin using TreeSAPP, must log onto server make sure ’re directory data.According treesapp purity last chapter, sanity checks, XmoA reference package (contained working directory, /data/ts_tutorial, XmoA_seed/final_outputs/XmoA_build.pkl) contains XmoA sequences. point, ’re able use reference package classify sequences dataset using treesapp assign.command treesapp assign perhaps popular command described detail TreeSAPP wiki.commands use Block Mapping Gathering Entropy (BMGE) software filter regions questionable homology alignment (6). Refer BMGE publication information. trim multiple sequence alignments prior phylogenetic placement use --trim_align flag.\nuse PmoA AmoA reference package ’ve built instead reference packages come TreeSAPP can use argument --refpkg_dir path directory containing reference packages want use.usual, ’re unclear arguments , can use treesapp assign -h get complete usage descriptions argument.","code":"cd /data/ts_tutorial/"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classifying-amino-acid-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.2.1 Classifying amino acid sequences","text":"’re first going classify PmoA AmoA sequences sourced UniProt.\nclassify , sequences need combined single file using cat shell command.Use cat combine PmoA AmoA sequences file UniProt_XmoA.fasta.\noutput cat redirected console > symbol <new file>.new file input treesapp assign, provided --fastx_input argument.\npast TreeSAPP commands specified path single reference package --refpkg_path argument.\nSince treesapp assign capable using multiple reference packages, analogous argument --refpkg_dir.\npoint directory containing one reference package .pkl files, can used classifying query sequences.\noutput directory UniProt_XmoA_assign/.Classify 69661 protein sequences UniProt_XmoA.fasta using treesapp assign.command take approximately twenty seconds complete see line TreeSAPP finished successfully. end ’re good move .","code":"cat UniProt_AmoA.fasta UniProt_PmoA.fasta > UniProt_XmoA.fastatreesapp assign \\\n  -n 4 \\\n  --trim_align \\\n  --refpkg_dir XmoA_seed/final_outputs/ \\\n  --fastx_input UniProt_XmoA.fasta \\\n  --output UniProt_XmoA_assign/"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classifying-orfs-predicted-from-genomes","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.2.2 Classifying ORFs predicted from genomes","text":"second batch sequences classify XmoA metagenome-assembled genomes (MAGs). MAGs derived assembled metagenome datasets (.e. contigs scaffolds) represent genome closely related microbial population. can think representing single strain present microbial community.need download two files: FASTA file containing genomes table taxonomic label genome. files, SI072_MAGs.fa SI072_MAGs_gtdbtk.bac120.summary.tsv, contained within larger data package revisiting next tutorial.Download data package SI072_sequence_data.tar.gz Zenodo decompress tar.FASTA file created concatenating twelve different MAGs single file prepending sequence name (.e. header) MAG name using software seqkit.\nConcatenating multiple genomes single file saves time since need run treesapp assign instead classifying MAG individually.\nPrepending header respective MAG name necessary properly map names query sequences back original genome names update process. shell command used (run):treesapp assign command use similar ’ve used past.\nneed indicate molecule type (.e., nucleotides amino acids) TreeSAPP automatically determines reading input.command take less minute complete.\nextra step required open reading frames (ORFs) predicted using software Prodigal.\nORFs translated create protein sequences required TreeSAPP homology search, phylogenetic placement, etc.","code":"wget https://zenodo.org/record/6323402/files/SI072_sequence_data.tar.gz && \\\ntar -xzvf SI072_sequence_data.tar.gzfor f in *fa\ndo\n  mag_name=$( basename $f | sed 's/.fa//g' )\n  cat $f | seqkit replace -p \"^\" -r \"${mag_name}_\" >>SI072_MAGs.fa\ndonetreesapp assign \\\n  -n 4 \\\n  --trim_align \\\n  --refpkg_dir XmoA_seed/final_outputs/ \\\n  --fastx_input SI072_sequence_data/SI072_MAGs.fa \\\n  --output SI072_MAGs_assign/"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"update-the-reference-package-with-new-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.3 Update the reference package with new sequences","text":"initial XmoA_seed reference package pretty small just 36 sequences (information retrieved using treesapp package view num_seqs -r XmoA_seed/final_outputs/XmoA_build.pkl). Also, bacterial sequences included version know archaeal ammonia oxidizers .\nLet’s see can expand seed reference package using sequences UniProt.","code":""},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"updating-with-publicly-available-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.3.1 Updating with publicly available sequences","text":"already seen many flags arguments , ’re used just remind TreeSAPP want results fast.\ncouple new ones used, though. treesapp update won’t take just old FASTA file relies outputs produced treesapp assign.\n’ll guide relevant output directory --treesapp_output UniProt_XmoA_assign/.\n, figure sequences classified assigned lineages .default TreeSAPP use lineage assigned classified query sequence treesapp assign outputs.\nAlthough sequences UniProt (originally GenBank) NCBI accessions taxonomy IDs header, must provide taxonomic lineages sequence table.\nFortunately, already information files UniProt_AmoA.tab UniProt_PmoA.tab.Create table mapping sequence names taxonomic lineage information treesapp update.\nfirst command creates new file (UniProt_XmoA.tsv) table column names.\nsecond command pipes rows UniProt lineage tables except header line using tail command.\n-q parameter prevents tail including file name output.\nUniProt table rows appended new file using >> instead one >.Alternatively, inverse pattern matching word “Entry” — first column name exported UniProt tables — grep ---filename -v Entry UniProt_*tab also worked.make TreeSAPP use new table instead using taxonomic classifications generated treesapp assign use --skip_assign flag.\nFinally, going require taxonomic lineages resolved least rank Order argument --min_taxonomic_rank.\nResolving lineages sequences least rank help us link respective CuMMO groups precisely.\nlevel resolution isn’t necessary reference packages given metabolic diversity within CuMMOs Proteobacteria alone, .Update reference package XmoA_seed/final_outputs/XmoA_build.pkl classified UniProt XmoA sequences.\nUse argument --seqs2lineage specify path table containing taxonomic lineages UniProt XmoA sequences.looks like 39 new sequences introduced reference package, bringing total 75 sequences.\njudging taxonomic rank summary printed runtime Archaea Bacteria now included:","code":"echo -e \"SeqID\\tOrganism\\tDomain\\tPhylum\\tClass\\tOrder\\tFamily\\tGenus\\tSpecies\" >UniProt_XmoA.tsv\ntail -q -n +2 UniProt_*tab >>UniProt_XmoA.tsvtreesapp update \\\n  --fast \\\n  --headless \\\n  --overwrite \\\n  --delete \\\n  --cluster \\\n  --trim_align \\\n  --min_taxonomic_rank o \\\n  -n 4 \\\n  --output XmoA_UniProt_update/ \\\n  --skip_assign \\\n  --treesapp_output UniProt_XmoA_assign/ \\\n  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkl \\\n  --seqs2lineage UniProt_XmoA.tsvNumber of unique lineages:\n    root       1\n    domain     2\n    phylum     6\n    class      7\n    order     10\n    family    14\n    genus     29\n    species   46"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"updating-with-mag-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.3.2 Updating with MAG sequences","text":"now going update reference package just updated using MAG sequences demonstrate iteratively update reference packages.\nLike previous update, must provide taxonomic labels MAG.\nMAGs assigned taxonomic labels using Genome Taxonomy Database toolkit (GTDB-tk)(7).first need reformat table containing taxonomic labels MAGs. employ shell functions awk sed pull two columns need find--replace words characters.Now everything need can proceed run treesapp update add MAG sequences reference package.One XmoA sequences MAGs added reference package bringing total 144 reference sequences.summary reference package printed screen treesapp update completed properly, look like :supplementary reading integrate sequences SAGs MAGs reference packages please visit TreeSAPP Wiki.","code":"awk -F\"\\t\" '{ OFS=\"\\t\"; print $1,$2 }' SI072_sequence_data/SI072_MAGs_gtdbtk.bac120.summary.tsv | \\\nsed 's/user_genome/Organism/g' | \\\nsed 's/classification/Lineage/g' | \\\nsed 's/;/; /g' >gtdb_classifications.tsvtreesapp update \\\n  --fast \\\n  --headless \\\n  --overwrite \\\n  --delete \\\n  --cluster \\\n  --trim_align \\\n  -n 4 \\\n  --output XmoA_MAG_update/ \\\n  --skip_assign \\\n  --seqs2lineage gtdb_classifications.tsv \\\n  --treesapp_output SI072_MAGs_assign/ \\\n  --refpkg_path XmoA_UniProt_update/final_outputs/XmoA_build.pklSummary of the updated reference package:\nReferencePackage instance of XmoA (N0102):\n    Molecule type:                                      'prot'\n    TreeSAPP version:                                   '0.11.3'\n    Profile HMM length:                                 '246'\n    Substitution model used for phylogenetic inference: 'LG+G4'\n    Number of reference sequences (leaf nodes):          144\n    Software used to infer phylogeny:                   'FastTree'\n    Date of last update:                                '2022-03-01'\n    Description:                                        'Alpha subunits of copper membrane monooxygenase enzymes'"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"annotate-clades","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.4 Annotate clades","text":"Protein families vary evolutionary complexity; many, especially genes involved scavenging metabolizing nutrients, often involved gene duplication /lateral gene transfer event. Moreover, closely related enzymes can vary activities often valuable, though necessary, annotate features. previously discussed, XmoA includes PmoA AmoA, involved oxidizing methane ammonia, respectively. Still activities mediated members metabolically diverse protein family, including ethylene, propane butane oxidation (5). , annotate reference sequences XmoA reference package TreeSAPP can classify sequences precisely create colour-annotation files iTOL.Creating annotations involves scouring literature identify phenotypes associated organism taxon. example, need determine paralogs substrates used organism reference package. Often though, phenotypes conserved across larger taxonomic groups, whole genera, families, orders, etc.\nfamiliar evolution protein family may helpful find reference sequences activity, function, feature ’re interested place tree treesapp assign. , guided sequences, easier annotate clades.\nSeeing literature review can’t accomplished within time span tutorial, can use annotations already created XmoA reference package extensive support literature (5, 8–11).can view contents file Unix command less:create annotate XmoA reference sequences resolved orthologous groups use treesapp package.\nspecific reference package attribute modified “feature_annotations”.\ntreesapp package edit subcommand allows single attribute specified.\n“feature_annotations” attribute edited next command-line parameter indicates name feature-annotation edit.Add new reference package feature annotation called CuMMO store type CuMMO reference XmoA sequence.\nInclude --overwrite write updated reference package file.\n","code":"wget https://raw.githubusercontent.com/hallamlab/RefPkgs/master/Nitrogen_metabolism/Nitrification/XmoA/XmoA_taxonomy-phenotype_map.tsvless XmoA_taxonomy-phenotype_map.tsvd__Archaea      AmoA_AOA\np__Verrucomicrobia      PmoA\np__Actinobacteria       BmoA\no__Chromatiales AmoA_AOB\nf__Methylococcaceae     PmoA\nf__Nitrosomonadaceae    AmoA_AOB\ng__Haliea       EmoA\ng__Methylocystis        PmoA\ng__Methylosinus PmoA\ng__Methylohalobius      PmoA\ng__Methylocapsa PmoA\ng__Methylothermus       PmoA\ng__Methylomarinovum     PmoA\ng__Hydrogenophaga       Unknown\ns__Crenothrix polyspora PmoA\nCandidatus Methylomirabilis oxyfera     PmoA\n1116472.MGMO_167c00070  PxmA \n743836.AYNA01000128_gene1400    PxmA\n1116472.MGMO_123c00040  PxmA\n697282.Mettu_1055       PxmA\n686340.Metal_1434       PxmA\nACE95886        PxmA\nACE95893        PxmA\nACE95890        PxmA\nAEF15859        PxmA\ntr|A0A1R4H2I8|A0A1R4H2I8_9GAMM  PxmAtreesapp package edit \\\n  feature_annotations CuMMO \\\n  -r XmoA_MAG_update/final_outputs/XmoA_build.pkl \\\n  --taxa_map XmoA_taxonomy-phenotype_map.tsv \\\n  --overwrite"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"annotate-features","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.4.1 Annotate features","text":"CuMMO feature annotation included reference package, can re-classify PmoA AmoA sequences UniProt onto MAG-updated reference package treesapp assign.clade colours file tutorial directory, now simple assign classified query sequences respective functional guild treesapp layer.output command UniProt_XmoA_update_assign/final_outputs/layered_classifications.tsv.\ncontains extra column functional annotations otherwise identical original classifications.tsv file.\ncan view first 10 lines using Unix command head:","code":"treesapp assign \\\n  -n 4 \\\n  --trim_align \\\n  --refpkg_dir XmoA_MAG_update/final_outputs/ \\\n  --fastx_input UniProt_XmoA.fasta \\\n  --output UniProt_XmoA_update_assign/treesapp layer \\\n  --refpkg_dir XmoA_MAG_update/final_outputs/ \\\n  --treesapp_output UniProt_XmoA_update_assign/head UniProt_XmoA_update_assign/final_outputs/layered_classifications.tsv"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"colouring-phylogenies-in-itol","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.4.2 Colouring phylogenies in iTOL","text":"TreeSAPP can also create iTOL-compatible annotation files colouring phylogeny.two output files —XmoA_CuMMO_colours_style.txt XmoA_CuMMO_colour_strip.txt— can used bring colour JPlace file iTOL.\ndefault colour palette used “BrBG” colorbrewer.org can changed --palette argument colorbrewer palette.Let’s copy two files UniProt_XmoA_update_assign/iTOL_output directory transfer <path ts_tutorial_local> (local) computer.computer: Transfer UniProt_XmoA_update_assign/iTOL_output/ server local directory ts_tutorial_local.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Upload file XmoA_complete_profile.jplace. can using either computer’s file browser navigating iTOL_output directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.Upload file XmoA_complete_profile.jplace. can using either computer’s file browser navigating iTOL_output directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.Next, navigate page displaying phylogeny click--drag file XmoA_labels.txt file browser iTOL window. convert TreeSAPP identifiers (e.g. 1_XmoA) useful descriptions organism name accession leaf node.Next, navigate page displaying phylogeny click--drag file XmoA_labels.txt file browser iTOL window. convert TreeSAPP identifiers (e.g. 1_XmoA) useful descriptions organism name accession leaf node.two files XmoA_CuMMO_colours_style.txt XmoA_CuMMO_colour_strip.txt can dragged iTOL browser window bring colour XmoA tree.two files XmoA_CuMMO_colours_style.txt XmoA_CuMMO_colour_strip.txt can dragged iTOL browser window bring colour XmoA tree.Finally, turn “Phylogenetic Placements” dataset (right screen). figure look identical Figure 5.1Finally, turn “Phylogenetic Placements” dataset (right screen). figure look identical Figure 5.1FIGURE 5.1: XmoA phylogeny functional annotation. Red bubbles positioned mid-point branches 6921 query proteins UniProt placed. Phylogeny rooted midpoint iTOL.","code":"treesapp colour \\\n  --output_dir XmoA_MAG_update/final_outputs/ \\\n  --refpkg_path XmoA_MAG_update/final_outputs/XmoA_build.pkl \\\n  --attribute CuMMO \\\n  --unknown_colour greycp XmoA_MAG_update/final_outputs/XmoA_CuMMO_*.txt UniProt_XmoA_update_assign/iTOL_output/scp -r root@<server address>:/data/ts_tutorial/UniProt_XmoA_update_assign/iTOL_output <path to ts_tutorial_local>"},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"calculating-relative-abundance-of-metaomic-data","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6 Calculating relative abundance of meta’omic data","text":"","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"introduction-and-goals-4","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.1 Introduction and goals","text":"Genome assemblies contain less information sequence reads recovering always possible.\nshotgun DNA sequencing technique samples subsequences genomes comprise microbial community. Sequencing bias, present, subtle enough can assume subsequence’s frequency reads approximates abundance underlying community. Whenever (meta)genome assembled reads, however, sequences tricky assemble (due repetitive motifs low coverage) removed abundance information effectively lost.\nOne way recover read-level abundances aligning reads back contigs calculating number reads mapped . One can go step still use relative abundance normalization measures popular transcriptomics, fragments per kilobase per million mappable reads (FPKM) transcripts per million (TPM) (12).TreeSAPP’s subcommand abundance capable calculating FPKM TPM classified query sequences. can derived reads FASTQ files multiple different samples. possible input fasta nucleotide sequences ORFs predicted within pipeline (.e. thisn’t possible amino acid sequences).goal tutorial show use treesapp abundance calculate TPM metagenome-derived ORF sequences.","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"workflow-description","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.2 Workflow description","text":"workflow employed TreeSAPP common many bioinformatics pipelines:Collect nucleotide sequences classified ORFs.BWA (13) creates index nucleotide sequences - reference database.Align short reads reference database BWA MEM.Calculate relative abundance metrics. TreeSAPP uses samsum.potentially two common use cases treesapp abundance.treesapp assign single sample’s read data mapped corresponding assembly (.e. contigs scaffolds) relative abundances sequences obtained.combined assembly generated multiple samples, classified treesapp assign, reads sample mapped individually generate sample-specific relative abundance values treesapp abundance.","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"usage","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.3 Usage","text":"two required arguments treesapp abundance:treesapp_output: Path output directory treesapp assign.reads: Path FASTQ file containing single-end reads, foward mates interleaved reads paired-end sequencing library.descriptions important options:reverse: Path FASTQ file containing reverse mates paired-end sequencing library.report: argument controls treesapp abundance resulting abundance values. ‘nothing’ option applicable Python API, used treesapp assign simply return abundance object instances. ‘update’ can used abundance values classification table replaced newly calculated values. ‘append’ used reads new samples used calculate abundance (e.g. reads time-course experiment).metric: Either Fragments per Kilobase per Mllion mappable reads (FPKM) Transcripts per Million (TPM).","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"outputs","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.4 Outputs","text":"sole output treesapp abundance edited classification table, previously generated treesapp assign. new files generated, beyond intermediate files (e.g. SAM files). values ‘Abundance’ field final_outputs/classifications.tsv.","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"tutorial-steps","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.5 Tutorial steps","text":"Connect group’s server, move directory /data/ts_tutorial.tutorial requires many FASTQ FASTA-formatted files subsetted versions originals.\ncreated searching metagenome assemblies reads XmoA pulling sequences matched new files.\navailable SI072_sequence_data directory downloaded last tutorial .begin classifying XmoA sequences found metagenome contigs. Since nucleotide sequences representing random stretches DNA microbial community, treesapp assign begin predicting open reading frames (ORFs) . TreeSAPP classify amino acid sequences predicted ORFs. XmoA sequences classified ORFs can begin generate relative abundance values XmoA sequences.Assign taxonomic labels Saanich Inlet metagenomic contigs using updated XmoA reference package treesapp assign.Now ’ll need access processed data generated treesapp assign SI072_MetaG_contigs_XmoA_assign/. treesapp abundance access ORFs SI072_MetaG_contigs_XmoA_assign/intermediates/orf-call/SI072_MetaG_contigs_ORFs.fna pass bwa mem sequence alignment. Due , flag ‘--delete’ used treesapp assign want eventually run treesapp abundance intermediates directory removed.begin calculating TPM metagenome reads.\nreads using calculate values paired-end meaning two reads represent sequenced DNA fragment. two reads, case metagenomic data, split across two files: one reads sequenced forward direction another reads sequenced reverse. extensions ‘.1.fq.gz’ ‘.2.fq.gz’, respectively. Therefore, must use parameters ‘--reads’ ‘--reverse’ point TreeSAPP towards files. ’ll notice didn’t list seven files , either; used wildcard character (asterisk). forward reads, shell interpret files within SI072_sequence_data directory begin ‘SI072_’ end ‘m_pe.1.fq.gz’. can test expansion using ls command.like replace current abundance values treesapp assign (set 1) new TPM values, set ‘--report’ parameter ‘update’.\nFinally, can specify want TPM values --metric tpm. Although, ‘tpm’ default isn’t necessary.Run treesapp abundance overwrite previous abundance values TPM values calculated seven SI072 datasets.Now ’re going generate TPM values seven matching metatranscriptome datasets. notice format FASTQ files different metagenomes. reads sample contained single file, referred interleaved FASTQ format.\nSince file reverse reads can just use ‘--reads’ parameter.\nAnother key difference ’re setting ‘--report’ parameter ‘append’. don’t want overwrite TPM values just generated metagenomes. Instead, want new metatranscriptome values added SI072_MetaG_contigs_XmoA_assign/final_outputs/classifications.tsv, end classification table hold TPM values metagenomes metatranscriptomes.Use treesapp abundance calculate TPM values seven metatranscriptomes.next tutorial cover visualizing TreeSAPP classifications. also want functional annotations generated last tutorial.Run treesapp layer annotate XmoA query sequences respective paralog.’s ! ’re now seasoned veteran TreeSAPP.","code":"cd /data/ts_tutorial/treesapp assign \\\n  -n 4 \\\n  --trim_align \\\n  --refpkg_dir XmoA_MAG_update/final_outputs/ \\\n  --fastx_input SI072_sequence_data/SI072_MetaG_contigs.fasta \\\n  --output SI072_MetaG_contigs_XmoA_assign/ls SI072_sequence_data/SI072_*m_pe.1.fq.gztreesapp abundance \\\n  -n 4 \\\n  --treesapp_output SI072_MetaG_contigs_XmoA_assign/ \\\n  --reads SI072_sequence_data/SI072_*m_pe.1.fq.gz \\\n  --reverse SI072_sequence_data/SI072_*m_pe.2.fq.gz \\\n  --report update \\\n  --metric tpmtreesapp abundance \\\n -n 4 \\\n --treesapp_output SI072_MetaG_contigs_XmoA_assign/ \\\n --reads SI072_sequence_data/SI072_*m_MetaT_QC_Filtered.fq.gz \\\n --pairing pe \\\n --metric tpm \\\n --report appendtreesapp layer \\\n -o SI072_MetaG_contigs_XmoA_assign/ \\\n --refpkg_dir XmoA_MAG_update/final_outputs/"},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"use-your-groups-reference-package-to-calculate-abundances","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.6 Use your group’s reference package to calculate abundances","text":"Continue work group’s reference package directory /data/<gene name>. Visualize appropriate outputs iTOL.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analysing-the-treesapp-classifications-in-r","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7 Analysing the TreeSAPP classifications in R","text":"","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"introduction-and-goals-5","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.1 Introduction and goals","text":"instructions help complete script template treesapp_analysis.R complete initial analysis TreeSAPP classifications.\nfollowing code chunks show load, aggregate, subset transform continuous discrete variables R using tidyverse.\nalso provided examples plotting TreeSAPP classification data using ggplot2 library.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"resources-for-analysis-of-treesapp-output-in-r","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.2 Resources for analysis of TreeSAPP output in R","text":"TreeSAPP output file layered_classifications.tsv metagenome metatranscriptome abundances gene functions generated TreeSAPP. unable retrieve file, can downloaded .R script template called treesapp_analysis.R Canvas.Saanich_TimeSeries_Chemical_DATA.csv file containing geochemical measurements Canvas.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"checklist-to-write-and-run-r-script","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.3 Checklist to write and run R script","text":"\nPlace treesapp_analysis.R, layered_classifications.tsv Saanich_TimeSeries_Chemical_DATA.csv files single folder create new RStudio project folder local computer.\nEdit treesapp_analysis.R script following instructions .","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"writing-the-r-script","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.4 Writing the R script","text":"treesapp_analysis.R script load subset TreeSAPP data variables marker genes interest. break one taxonomic information column multiple taxonomic ranks. also load Saanich_TimeSeries_Chemical_DATA.csv file geochemical measurements learn conditions assigned depth.\nFinally, visualize taxonomic, functional chemical data using ggplot2 library.complete , replace instances test angle brackets, like <TEXT>, code section.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"load-any-required-packages","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.5 Load any required packages","text":"","code":"\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"load-metagenomic-and-metatranscriptomic-treesapp-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.6 Load metagenomic and metatranscriptomic TreeSAPP data","text":"","code":"\nts_dat <- read.table(file=\"layered_classifications.tsv\",\n                     header=TRUE,\n                     sep=\"\\t\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"classification-table","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.6.1 Classification table","text":"Let’s look TreeSAPP’s classification table FunGene XmoA sequences. RStudio, able click variable name “Environment” tab top-right panel. Optionally, can use View function R-console view object. example, run View(ts_dat).description fields can found treesapp assign documentation page.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"subset-your-data-to-the-variables-and-marker-genes-of-interest","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.7 Subset your data to the variables and marker genes of interest","text":"Determine variables marker genes need subset data . “Marker” data XmoA, filter XmoA.working real data may analyzing multiple reference package’s worth data. want subset data couple reference packages find ‘%%’ operator handy. following example keeping data Marker variable equal “XmoA”, “PmoA” “AmoA”. reality, match “XmoA”.","code":"\nts_df <- ts_dat %>%\n  filter(Marker == \"XmoA\")\nts_df <- ts_df %>%\n  filter(Marker %in% c(\"XmoA\", \"PmoA\", \"AmoA\"))"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"reformat-variables","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8 Reformat variables","text":"","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"processing-taxonomic-information","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8.1 Processing taxonomic information","text":"taxonomic information contains information highest lowest available rank. Look rows containing taxonomic information determine separator rank. can use function tidyverse called separate allows split character object separators. result, initial single taxonomic variable split multiple new variables, one rank. Use R object taxa_ranks assign names new variables.","code":"\ntaxa_ranks <- c(\"Root\", \"Domain\", \"Phylum\", \"Class\",\n                \"Order\", \"Family\", \"Genus\", \"Species\")\nts_df <- ts_df %>%\n  separate(col = Taxonomy,\n           into = taxa_ranks,\n           sep = \"; \", fill = \"right\", remove = T)"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"distinguishing-metagenomes-from-metatranscriptomes","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8.2 Distinguishing metagenomes from metatranscriptomes","text":"","code":"\nts_df <- ts_df %>% \n  mutate(Sample = gsub(\"_pe\", \"_MetaG\", Sample)) %>% \n  separate(col = Sample,\n           into = c(\"Cruise\", \"Depth\", \"SeqType\"),\n           extra = \"drop\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"processing-depth-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8.3 Processing depth data","text":"Modify data frame split sample name “Cruise” “Depth” variables. , remove ‘m’ character “Depth” variable create numeric variable called “Depth.m”.","code":"\nts_df <- ts_df %>%\n  mutate(Depth.m = as.numeric(gsub('m', '', Depth))) %>% \n  mutate(Cruise = as.numeric(gsub('SI0', '', Cruise)))"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"load-the-geochemical-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.9 Load the geochemical data","text":"Geochemical data Saanich Inlet time series another file called Saanich_TimeSeries_Chemical_DATA.csv. first load data frame called geochem_df, subset just samples interested .going use function left_join dplyr library merge geochemical data cruise 72 TreeSAPP classifications XmoA Sample. combined data saved new data frame called ts_geo_df.","code":"\ngeochem_df <- read.table(\"Saanich_TimeSeries_Chemical_DATA.csv\",\n                          header=TRUE, sep=',') %>% \n  filter(Cruise == 72) %>% \n  select(Cruise, Depth,\n         CTD_O2, NO3,\n         Mean_NH4, Mean_NO2, Mean_H2S, Mean_CH4) %>% \n  mutate(Mean_CH4 = Mean_CH4*1E-3) %>% \n  mutate(across(.fns=as.numeric))\nts_geo_df <- left_join(ts_df,\n                       geochem_df,\n                       by=c(\"Cruise\",\n                            \"Depth.m\" = \"Depth\"))"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"visualize-the-taxonomic-functional-and-chemical-data-from-saanich-inlet","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10 Visualize the taxonomic, functional and chemical data from Saanich Inlet","text":"","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyze-treesapps-taxonomic-classifications","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.1 Analyze TreeSAPP’s taxonomic classifications","text":"’re going begin making line plot show distribution abundances taxonomic orders different depths. taxa shown XmoA gene organisms Saanich Inlet!\ncreate new variable called Sum sums Abundance (TPM values) taxonomic order depth. Without group_by() function, return single value since ’re grouping Depth Order, sum yields value taxon depth.plot gives us idea absolute TPM values, taxon’s share total abundance depth? answer create stacked barplot show relative change proportions different depths.\nInstead creating variable hold taxon’s total TPM create new variable store proportion TPM called Proportion. easily changed percentage multiplying 100.ts_geo_df dataframe two variables storing sample depth: one numeric type character type. plotting character type depth (Depth) x-axis default R’s alphabetical ordering makes ‘100m’ precede ‘10m’. reorder function used ensure depth sorted numerically ordering Depth (character type) Depth.m (numeric type).Additionally, faceting plot sequence type: ‘MetaG’ (metagenome) ‘MetaT’ (metatranscriptome).","code":"\nts_geo_df %>%\n  filter(SeqType == \"MetaG\") %>% \n  group_by(Depth.m, Order) %>%\n  summarise(Sum = sum(Abundance)) %>%\n  ungroup() %>%\n  ggplot(aes(x=Depth.m, y=Sum, colour=Order)) +\n  geom_line() +\n  coord_flip() +\n  scale_x_reverse() +\n  labs(x=\"Depth (m)\",\n       y=\"Relative abundance (TPM)\")\n\nggsave(\"taxonomic_order_lineplot.png\")\nts_geo_df %>% \n  group_by(Depth, Depth.m, SeqType) %>% \n  mutate(Proportion = Abundance/sum(Abundance)) %>% \n  group_by(Depth, Depth.m, Order, SeqType) %>% \n  summarise(sum = sum(Proportion)) %>% \n  ungroup() %>% \n  mutate(Depth = reorder(Depth, Depth.m)) %>% \n  ggplot(aes(x=Depth, y=sum, fill=Order)) +\n  geom_bar(stat = \"identity\") +\n  facet_wrap(~SeqType) +\n  labs(x=\"Depth\",\n       y=\"Relative abundance\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggsave(\"taxonomic_order_barplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyze-the-functional-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.2 Analyze the functional data","text":"following figure instead going visualize abundance classified XmoA’s function (indicated CuMMO field) across water column.\ngoing use bubble-plot figure bubbles depth-order intersection scaled TPM value (Abundance).\ncolouring bubbles according assigned CuMMO.\nfaceting plot sequence type.Can see discrepancies metagenome metatranscriptome abundances?","code":"\nts_geo_df %>% \n  group_by(Depth, Depth.m, SeqType, Order, CuMMO) %>% \n  summarise(Sum = sum(Abundance)) %>% \n  ungroup() %>%\n  mutate(Depth = reorder(Depth, desc(Depth.m))) %>% \n  ggplot(aes(x=Depth, y=Order, colour=CuMMO)) +\n  geom_point(aes(size=Sum)) +\n  facet_wrap(~SeqType) +\n  coord_flip() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggsave(\"functional_bubbleplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyze-the-chemical-measurements","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.3 Analyze the chemical measurements","text":"following plot visualizing chemical profiles depth. exhaustive include molecules ’re interested .generate plot, ’ve perform common data manipulation technique called pivoting. Essentially, instead separate variable chemical measurements, combined two columns: one name molecule (previously variable name) another value.Notice x-axis scales differ. enabled scales = \"free_x\" function facet_wrap essential observe trends across water column. Without many values squished y-axis values close zero oxygen concentration gets ~200 micromolar.","code":"\nts_geo_df %>% \n  pivot_longer(cols=c(starts_with(\"Mean\"), NO3, CTD_O2),\n               values_to = \"Value.uM\",\n               names_to = \"Molecule\") %>%\n  ggplot(aes(x=Depth.m, y=Value.uM)) +\n  geom_point() +\n  geom_line() +\n  facet_wrap(~Molecule, scales = \"free_x\") +\n  coord_flip() +\n  scale_x_reverse()\n\nggsave(\"geochemical_lineplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"bringing-them-all-together","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.4 Bringing them all together","text":"final figure going combine methane concentration data TPM values two orders, Methylococcales Nitrosomonadales.abundance two groups change methane concentration?","code":"\nts_geo_df %>%\n  filter(SeqType==\"MetaT\") %>%\n  filter(!is.na(Order)) %>% \n  mutate(Depth = reorder(Depth, Depth.m)) %>% \n  ggplot(aes(x=Depth, y=Abundance, colour=Mean_CH4)) +\n  geom_boxplot() +\n  geom_point() +\n  facet_wrap(~Order) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggsave(\"taxonomic_order_boxplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyzing-classifications-for-your-groups-reference-package","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.11 Analyzing classifications for your group’s reference package","text":"abundance gene vary depth? trends similar RNA DNA?abundance gene vary depth? trends similar RNA DNA?microbial diversity vary depth? trends similar RNA DNA?\nneed make decision taxonomic rank calculate diversity. might able use lowest possible? taxonomic rank high?microbial diversity vary depth? trends similar RNA DNA?\nneed make decision taxonomic rank calculate diversity. might able use lowest possible? taxonomic rank high?abundance gene relate water column geochemistry Saanich Inlet (use chemical measurement data Saanich_TimeSeries_Chemical_DATA.csv)?abundance gene relate water column geochemistry Saanich Inlet (use chemical measurement data Saanich_TimeSeries_Chemical_DATA.csv)?Determine geochemical conditions given depths. best available terminal electron acceptor?Determine geochemical conditions given depths. best available terminal electron acceptor?","code":""},{"path":"basic-automation-with-r.html","id":"basic-automation-with-r","chapter":"8 Basic Automation with R","heading":"8 Basic Automation with R","text":"","code":""},{"path":"basic-automation-with-r.html","id":"introduction-and-goals-6","chapter":"8 Basic Automation with R","heading":"8.1 Introduction and goals","text":"library dplyr provides many useful functions like select(), filter(), mutate() cover vast majority use cases, real data messy. Sometimes may existing functions. tutorial teach fundamental building blocks scripting can produce “” know “.”warning though, using dplyr driving car, tutorial teaching walk. locations reachable walking, always get much faster driving. Try find tools first hacking together .","code":""},{"path":"basic-automation-with-r.html","id":"prerequisites","chapter":"8 Basic Automation with R","heading":"8.2 Prerequisites","text":"Please download following:numbers.csvbrokenNumbers.csvdummyData.zipR libraries","code":"\nlibrary(tidyverse)## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──## ✔ ggplot2 3.3.5     ✔ purrr   0.3.4\n## ✔ tibble  3.1.6     ✔ stringr 1.4.0\n## ✔ tidyr   1.2.0     ✔ forcats 0.5.1## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n## ✖ dplyr::filter()          masks stats::filter()\n## ✖ kableExtra::group_rows() masks dplyr::group_rows()\n## ✖ dplyr::lag()             masks stats::lag()"},{"path":"basic-automation-with-r.html","id":"making-a-function","chapter":"8 Basic Automation with R","heading":"8.3 Making a function","text":"math, specify functions like : \\(f(x) = 2x\\), function \\(f\\) takes parameter \\(x\\) performs action \\(2x\\) handing back result. R, look like ……can used like .","code":"\nf <- function(x) {\n  return(2 * x)\n}\nf(2)## [1] 4"},{"path":"basic-automation-with-r.html","id":"decisions-with-conditionals","chapter":"8 Basic Automation with R","heading":"8.4 Decisions with conditionals","text":"allows selective execution based condition.one condition can used……conditions can combined logical operatorsTry following","code":"\ndoubleIfLessThan <- function(x, threshold) {\n  if (x < threshold) {\n    return(2 * x)\n  } else {\n    return(x) # if no condition satisfied\n  }\n}\n\nprint(doubleIfLessThan(12, 100)) # 12 < 100, so doubled 12## [1] 24\nprint(doubleIfLessThan(12, 10)) # 12 ≮ 10, so just give back 12## [1] 12\ndoubleOutsideRange <- function(x, lower, upper) {\n  if (x < lower) {\n    return( 2 *x)\n  } else if (x > upper) {\n    return( 2 *x)\n  } else {\n    return(x)\n  }\n}\n\nprint(doubleOutsideRange(5, 10, 20))## [1] 10\nprint(doubleOutsideRange(5, 0, 2))## [1] 10\nprint(doubleOutsideRange(5, 0, 10))## [1] 5\ndoubleIfInRange <- function(x, lower, upper) {\n  if (x >= lower && x <= upper) { # && is the same as AND\n    return(2*x)\n  } else {\n    return(x)\n  }\n}\n\nprint(doubleIfInRange(5, 10, 20))## [1] 5\nprint(doubleIfInRange(5, 0, 2))## [1] 5\nprint(doubleIfInRange(5, 0, 10))## [1] 10\n1==1## [1] TRUE\n1==1 && 2==1## [1] FALSE\n!(2==1) || FALSE## [1] TRUE"},{"path":"basic-automation-with-r.html","id":"iterating-with-loops","chapter":"8 Basic Automation with R","heading":"8.5 Iterating with loops","text":"Suppose wanted double number list.can use loop. behaves……use contextIf number repeats unknown, can use loop. condition used instead tell stop.Loops can repeat forever. Click red octagon (🛑) top right RStudio console force script stop.","code":"\nnumbers <- read.csv(file=\"data/numbers.csv\", header=TRUE)\nnumbers##     n\n## 1   1\n## 2   2\n## 3   3\n## 4   4\n## 5   5\n## 6   6\n## 7   7\n## 8   8\n## 9   9\n## 10 10\nfor (i in 1:5) {\n  print(i)\n}## [1] 1\n## [1] 2\n## [1] 3\n## [1] 4\n## [1] 5\nfor (rowNumber in 1:nrow(numbers)) {\n  n <- numbers[rowNumber, \"n\"] # get value from row \"rowNumber\", column \"n\"\n  print(2 * n)\n}## [1] 2\n## [1] 4\n## [1] 6\n## [1] 8\n## [1] 10\n## [1] 12\n## [1] 14\n## [1] 16\n## [1] 18\n## [1] 20\nn <- 1\nwhile (n < 1000) {\n  n <-  n * 2\n}\n\nn## [1] 1024\nwhile (TRUE) {\n  # loop forever\n}"},{"path":"basic-automation-with-r.html","id":"reading-files","chapter":"8 Basic Automation with R","heading":"8.6 Reading files","text":"Files can opened read one line time like .last parameter specifies read/write permissions opened file.Files can also written one line time like .Check data folder new file.Reading writing csvs done much better read.csv() write.csv(), suppose come across file……seems innocent enough, trying load csv…","code":"\nnumbersFileConnection <- file(\"data/numbers.csv\", \"r\") # r is for read\n\nwhile (TRUE) {\n  line <-  readLines(numbersFileConnection, n = 1) # read 1 line\n  if (length(line) == 0) { # if no more lines ...\n    break # ... exit loop\n  }\n  print(line)\n}## [1] \"n\"\n## [1] \"1\"\n## [1] \"2\"\n## [1] \"3\"\n## [1] \"4\"\n## [1] \"5\"\n## [1] \"6\"\n## [1] \"7\"\n## [1] \"8\"\n## [1] \"9\"\n## [1] \"10\"\nclose(numbersFileConnection)\ncon <- file(\"data/numbers.csv\", \"r\")\nwrite(\"some new text\", file = con)## Error in cat(x, file = file, sep = c(rep.int(sep, ncolumns - 1), \"\\n\"), : cannot write to this connection\ncon <- file(\"data/myNumbers.csv\", \"w\")\n\nwrite(\"n\", con) # header\nfor (i in 1:10) {\n  line <- toString(i+10)\n  write(line, con)\n}\n\nclose(con)\ncon <- file(\"data/brokenNumbers.csv\",\"r\")\nline <- readLines(con) \nfor (i in 1:10) {\n  print(line[i])\n}## [1] \"n, comment, half_n, 2n\"\n## [1] \"1, ofcourse, odd, 0.5, 2\"\n## [1] \"2, 1.0, 4\"\n## [1] \"3, very odd, 1.5, 6\"\n## [1] \"4, 2.0, 8\"\n## [1] \"5, yes, odd, 2.5, 10\"\n## [1] \"6, 3.0, 12\"\n## [1] \"7, certainly odd, 3.5, 14\"\n## [1] \"8, 4.0, 16\"\n## [1] \"9, odd, 4.5, 18\"\nclose(con)\nisOdd <- read.csv(file = \"data/brokenNumbers.csv\", header = TRUE)\nisOdd %>% slice(50:60)##                          n             comment half_n  X2n\n## 50                    25.0                 100          NA\n## 51           very much odd                25.5    102   NA\n## 52                    26.0                 104          NA\n## 53                not even                26.5    106   NA\n## 54                    27.0                 108          NA\n## 55                   it is  if I were to guess    odd 27.5\n##  110                                                    NA\n## 56                    28.0                 112          NA\n## 57    pretty sure it's odd                28.5    114   NA\n## 58                    29.0                 116          NA\n## 59                very odd                29.5    118   NA"},{"path":"basic-automation-with-r.html","id":"practice-1","chapter":"8 Basic Automation with R","heading":"8.7 Practice 1","text":"…’s format obviously broken. Investigate file see can fix .Documentation strsplit()","code":"\ncon <- file(\"data/brokenNumbers.csv\", \"r\")\noutCon <- file(\"data/fixedNumbers.csv\", \"w\")\n\nheaders <- readLines(con, n = 1)\nwhile (TRUE) {\n  row = readLines(con, n = 1)\n  if (length(row) == 0) {\n    break\n  }\n  \n  fixedRow <- \"\"\n  \n  # split row into cells\n  cells <- str_split(row, \", \")[[1]] # see str_split above\n  \n  # look at cells by index like so\n  n = cells[1]\n  twoN = cells[length(cells)]\n  # ...\n  \n  # join strings using paste()\n  fixedRow <- paste(n, \", \", twoN) # ...\n\n  write(fixedRow, outCon)\n}\n\nclose(con)\nclose(outCon)"},{"path":"basic-automation-with-r.html","id":"practice-2","chapter":"8 Basic Automation with R","heading":"8.8 Practice 2","text":"TreeSAPP’s assign function wants single fasta file, data separated bins previous taxonomic classifier! See can append together one file.","code":"\nfor (f in list.files('data/dummyData')) {\n  print(f)\n  # append files\n}"},{"path":"project-description.html","id":"project-description","chapter":"9 Project description","heading":"9 Project description","text":"project, work groups conduct gene-centric mapping functional phylogenetic anchors encoded microbial genomes sourced Saanich Inlet water column. Saanich Inlet seasonally anoxic fjord coast Vancouver Island British Columbia serves model ecosystem studying microbial community responses ocean deoxygenation.Numerous studies Saanich Inlet years identified key microbial players mediating coupled biogeochemical cycling carbon, nitrogen sulfur extensible expanding marine oxygen minimum zones throughout global ocean. , use metagenomic metatranscriptomic data sets generated Cruise 72 spanning 7 depths Saanich Inlet. addition fastq reads, metagenomic data sets include assembled contigs, metagenome assembled genomes (MAGs) single-cell amplified genomes (SAGs) spanning genomic information hierarchy.Cruise 72 metagenomic metatranscriptomic data sets can evaluated relation geochemical parameter information better resolve metabolic potential gene expression patterns microbial communities inhabiting Saanich Inlet water column. capstone project group opportunity use TreeSAPP iToL chart abundance, expression taxonomic diversity functional phylogenetic anchor genes represented current reference package collection. Groups can augment collection new reference packages produced TreeSAPP tutorial time project phase depending research interests. Reference packages can also updated using taxonomic information associated MAGs SAGs described .underlying conceptual framework project described three lectures associated course Module 2 along examples data visualization approaches useful developing coherent scientific narrative. given gene encoding biochemical transformation consider extent functionality distributed within community represented different levels biological information flow e.g. DNA versus RNA.","code":""},{"path":"project-description.html","id":"guiding-research-questions","chapter":"9 Project description","heading":"9.1 Guiding research questions","text":"Several options provided help develop capstone project, although group free come original plan action. Please consult teaching team questions.Select reference package(s) analysis based one following options:\nChoose one pathways geochemical cycle e.g. nitrogen reference packages already available TreeSAPP (see table available TreeSAPP reference packages). example, select NapA, NirK, NirS, NorB, NorC NosZ investigate denitrification Saanich Inlet water column.\nCreate new reference packages expand TreeSAPP collection analyze results. select pthway within biogeocehmical cycle reference packages available covering complete pathway e.g. sulfur cycle including sulfur oxidation DMSP conversion, completely new pathway reference packages avaialble.\nSelect reference packages collection including developed class treesapp create tutorial map results. Focus evaluating purity reference package update needed reflect diversity genes endemic Saanich Inlet water column.\nSelect reference package(s) analysis based one following options:Choose one pathways geochemical cycle e.g. nitrogen reference packages already available TreeSAPP (see table available TreeSAPP reference packages). example, select NapA, NirK, NirS, NorB, NorC NosZ investigate denitrification Saanich Inlet water column.Choose one pathways geochemical cycle e.g. nitrogen reference packages already available TreeSAPP (see table available TreeSAPP reference packages). example, select NapA, NirK, NirS, NorB, NorC NosZ investigate denitrification Saanich Inlet water column.Create new reference packages expand TreeSAPP collection analyze results. select pthway within biogeocehmical cycle reference packages available covering complete pathway e.g. sulfur cycle including sulfur oxidation DMSP conversion, completely new pathway reference packages avaialble.Create new reference packages expand TreeSAPP collection analyze results. select pthway within biogeocehmical cycle reference packages available covering complete pathway e.g. sulfur cycle including sulfur oxidation DMSP conversion, completely new pathway reference packages avaialble.Select reference packages collection including developed class treesapp create tutorial map results. Focus evaluating purity reference package update needed reflect diversity genes endemic Saanich Inlet water column.Select reference packages collection including developed class treesapp create tutorial map results. Focus evaluating purity reference package update needed reflect diversity genes endemic Saanich Inlet water column.Perform preliminary analysis using Saanich Inlet data depths.Perform preliminary analysis using Saanich Inlet data depths.Update reference packages needed based preliminary analysis.Update reference packages needed based preliminary analysis.Look patterns gene abundance, expression diversity function water column geochemical parameter information.Look patterns gene abundance, expression diversity function water column geochemical parameter information.","code":""},{"path":"project-description.html","id":"questions-for-project-with-a-focus-on-biogeochemical-cycles-repeated-in-report-structure-below","chapter":"9 Project description","heading":"9.1.1 Questions for project with a focus on biogeochemical cycles (repeated in report structure below)","text":"gene transcript abundance vary across depths reference package given biogeochemical cycle?gene transcript abundance vary across depths reference package given biogeochemical cycle?microbial diversity differ among steps within pathway e.g. denitrification? trends similar genes transcripts different depths?microbial diversity differ among steps within pathway e.g. denitrification? trends similar genes transcripts different depths?taxonomic breakdown genes transcripts within given biogeochemcial cycle? Can discern evidence horizontal gene transfer one functional anchor genes?taxonomic breakdown genes transcripts within given biogeochemcial cycle? Can discern evidence horizontal gene transfer one functional anchor genes?Can identify evidence distributed metabolism within one pathways? trends similar genes transcripts different depths?Can identify evidence distributed metabolism within one pathways? trends similar genes transcripts different depths?answers questions 2 3 vary depending taxonomic rank used analysis?answers questions 2 3 vary depending taxonomic rank used analysis?abundance, expression taxonomy identified genes relate water column geochemical parameter information (use geochemical data Saanich_Data.csv previous data science sessions)?abundance, expression taxonomy identified genes relate water column geochemical parameter information (use geochemical data Saanich_Data.csv previous data science sessions)?","code":""},{"path":"project-description.html","id":"questions-for-project-with-a-focus-on-using-all-reference-packages","chapter":"9 Project description","heading":"9.1.2 Questions for project with a focus on using all reference packages","text":"addition questions provided biogeochemical cycles consider quality control metrics analysis.purity reference package impact results?purity reference package impact results?much information discarded due insufficient taxonomic resolution?much information discarded due insufficient taxonomic resolution?much information retained updating reference packages MAGs SAGs?much information retained updating reference packages MAGs SAGs?impact diversity metrics following use updated reference packages?impact diversity metrics following use updated reference packages?","code":""},{"path":"project-description.html","id":"resources","chapter":"9 Project description","heading":"9.2 Resources","text":"provided script template shell R portion analysis (treesapp_analysis.sh treesapp_analysis.R) guide develop code.stated project description, access metagenomic metatranscriptomic data sets generated Cruise 72 spanning 7 depths Saanich Inlet, MAGs SAGs.","code":""},{"path":"project-description.html","id":"your-submission","chapter":"9 Project description","heading":"9.3 Your submission","text":"final submission consist 3 separate files: report (docx pdf), one shell script treesapp_analysis.sh, one R script treesapp_analysis.R (script files must plain text format). report contain code, contain versions software tools used high-level description workflow (.e describe done ).","code":""},{"path":"project-description.html","id":"timeline","chapter":"9 Project description","heading":"9.4 Timeline","text":"following provides outline well specific milestones within project.Capstone timelineIntroduction begin running TreeSAPPIdeally, analyses server run nightStart capstone projectGroup workReport writingGroups expected meet remotely needed Finals Period order complete report. report serves final course treated .Final due dateFor reports completed portfolios","code":""},{"path":"project-description.html","id":"reports","chapter":"9 Project description","heading":"9.5 Reports","text":"Reports formatted per Instructions Authors Journal Bacteriology.group submit one report sections .Report structureAbstract200–250 wordsIntroduction500–750 wordsIntroduce Saanich Inlet model ecosystem studying microbial community responses ocean deoxygenation e.g. seasonal cycles, relevant biogeochemistry, previous studies, etc.Overview geochemical cycle including global impacts, microbial foundations involved genes.Methods300–500 wordsBriefly describe data (sampling, sequencing, processing, etc.)Briefly describe analysis methods includingTreeSAPP version commands usedTreeSAPP version commands usediTOL versioniTOL versionR version packages usedR version packages usedStatistics (applicable)Statistics (applicable)Provide one single shell script one single R script (.e treesapp_analysis.sh treesapp_analysis.R) individual files (.e. part manuscript) containing complete code generate results.Results500–750 wordsYour analysis address guiding research questions developed.must include ≥ 5 figures/panels titles full captions. figures can combined multi-panel figures desired.Discussion750–1000 wordsFrame results within broader discussion Saanich Inlet (Apr 14 discussion).Propose evolutionary, environmental, etc. reasoning distributed metabolism seen geochemcial pathway.Future directionsReferences10 moreFormatted ASM style Journal Bacteriology. using reference manager, style can downloaded EndNote, Mendeley, Zotero.Make sure include citations data source papers software tools used!","code":""},{"path":"project-description.html","id":"addendum","chapter":"9 Project description","heading":"9.6 Addendum","text":"","code":""},{"path":"project-description.html","id":"abundance","chapter":"9 Project description","heading":"9.6.1 Abundance","text":"workflow introduced treesapp abundance tutorial supposed serve guide generating TPM values capstone project. However, come attention teaching team treesapp abundance fails generate simple_bar.txt files viewing distribution TPM values across reference package’s phylogenetic tree. Therefore, providing another workflow generate classifications file (marker_contig_map.tsv) TPM values simplebar.txt files iTOL.","code":""},{"path":"project-description.html","id":"generate-the-jplace-with-all-classifications","chapter":"9 Project description","heading":"9.6.1.1 Generate the JPlace with all classifications","text":"concatenated metagenome FASTA file SI072 (MetaG_Assemblies/SI072_All_contigs.fa; see server data locations) run treesapp assign without FASTQ reads abundance flags generate single jplace file containing reference package homologs across depths.","code":""},{"path":"project-description.html","id":"generate-tpm-values-for-metagenomes","chapter":"9 Project description","heading":"9.6.1.2 Generate TPM values for metagenomes","text":"Run treesapp assign seven times abundance flags (--rel_abund --metric TPM) paths metagenome FASTQ files generate TPM values individual depth abundance files needed iToL visualization.gives total 8 treesapp assign runs associated output files metagenome samples.","code":""},{"path":"project-description.html","id":"generate-tpm-values-for-metatranscriptomes","chapter":"9 Project description","heading":"9.6.1.3 Generate TPM values for metatranscriptomes","text":"Run treesapp assign abundance flags seven metatranscriptome samples, including respective FASTQ file path command. give another seven treesapp assign outputs total 15 complete process metagenome metatranscriptome data sets.","code":""},{"path":"project-description.html","id":"generate-the-file-with-all-classifications-and-tpm-values","chapter":"9 Project description","heading":"9.6.1.4 Generate the file with all classifications and TPM values","text":"Now concatenate marker_contig_map.tsv files seven individual depth runs analysis R.first need write header one classification table combined table file (SI072_combined_marker_contig_map.tsv ), write classifications tables without header. avoid including table’s header multiple times partway table, confuse R. ’re using grep accomplish removing lines match word header, ‘Query’.","code":"head -n 1 <path to treesapp assign output directory>/final_outputs/marker_contig_map.tsv >SI072_combined_marker_contig_map.tsv\ncat <path to assign outputs>/*/final_outputs/marker_contig_map.tsv | grep -v Query >>SI072_combined_marker_contig_map.tsv"},{"path":"project-description.html","id":"viewing-the-placements-and-tpm-bars-in-itol","chapter":"9 Project description","heading":"9.6.1.5 Viewing the placements and TPM bars in iTOL","text":"iToL visualization use jplace file treesapp assign concatenated metagenome FASTA visualize phylogenetic tree placements across depths, use _labels.txt file concatenated run name leaves.\nadd TPM abundance layers depth access simple_bar.txt files individual depth run drag drop files iToL GUI.","code":""},{"path":"assessment.html","id":"assessment","chapter":"10 Assessment","heading":"10 Assessment","text":"Reports account 30% course marks distributed follows.","code":""},{"path":"assessment.html","id":"peer-evaluation-10","chapter":"10 Assessment","heading":"10.1 Peer evaluation (10%)","text":"Total: 40 ptsPeer assessment occur CATME wherein everyone assess group members. Marks scaled evaluation score 90%+ (0.9+ 1 within CATME) counting full marks.Individuals adequately contribute group forfeit 5% contributions mark may asked complete project .Peer assessment includes:Contributing team’s workInteracting teammatesExpecting qualityHaving related knowledge, skills, abilitiesIndividuals score team members scale 1 (unsatisfactory) – 3 (satisfactory) – 5 (excellent) categories. Scores averaged scaled within team 1 corresponds team members contributing equally categories assessment:1+ = Mostly 5s0.95 = Mostly 4s0.8 = Mostly 3s0.65 = Mostly 2s0.5 = Mostly 1sMarks scaled CATME score based following:0.9 - 1+ = 100% = 400.8 - 0.89 = 90% = 360.7 - 0.79 = 80% = 320.6 - 0.69 = 70% = 28<0.6 = Assessed case--case basisUnwarranted blanketed low scoring team high scoring result removal scores average unfairly impact team members.issues occur within group, please hesitate contact Dr. Hallam (shallam@mail.ubc.ca), Dr. Koenig (stephan.koenig@ubc.ca) point.","code":""},{"path":"assessment.html","id":"report-20","chapter":"10 Assessment","heading":"10.2 Report (20%)","text":"Total: 80 ptsEach group submit electronic copy group’s final report (due April 24). Reports assessed :Completion relevant analyses toward answering biological questionsLogic completeness conclusions made analysesWriting clarity, grammar, styleFigure clarity, effectiveness, relevanceRubric capstone project","code":""},{"path":"assessment.html","id":"ujemi-submission","chapter":"10 Assessment","heading":"10.3 UJEMI submission","text":"Outstanding reports invited submit Undergraduate Journal Experimental Microbiology Immunology (UJEMI). information provided near end Finals Period.","code":""},{"path":"running-treesapp-on-a-server.html","id":"running-treesapp-on-a-server","chapter":"11 Running TreeSAPP on a server","heading":"11 Running TreeSAPP on a server","text":"instructions help complete script template treesapp_analysis.sh run TreeSAPP analysis Saanich Inlet data assigned depth server copy output files local machine. adjust code examples script template, replace angle brackets, e.g. <TEXT>, missing code.","code":""},{"path":"running-treesapp-on-a-server.html","id":"resources-for-treesapp-analysis","chapter":"11 Running TreeSAPP on a server","heading":"11.1 Resources for TreeSAPP analysis","text":"shell script template called treesapp_analysis.sh Canvas.Access server <server address>.Saanich Inlet data located /mnt/datasets","code":""},{"path":"running-treesapp-on-a-server.html","id":"checklist-to-write-and-run-shell-script","chapter":"11 Running TreeSAPP on a server","heading":"11.2 Checklist to write and run shell script","text":"\nEdit treesapp_analysis.sh script following instructions .\nEdit treesapp_analysis.sh script following instructions .\nUsing terminal computer, copy script group’s server using:scp <path file computer> <user>@<server address>:<destination>\nUsing terminal computer, copy script group’s server using:\nMake script executable server (otherwise won’t able run ). CLI directory containing script, run following command:chmod u+x treesapp_analysis.sh\nMake script executable server (otherwise won’t able run ). CLI directory containing script, run following command:\nStill CLI, start new session screen -S <session name>.\nStill CLI, start new session screen -S <session name>.\nnew session, start script ./treesapp_analysis.sh.\nnew session, start script ./treesapp_analysis.sh.\nscript run (take 8 hours), locate final_output/marker_contig_map.tsv files TreeSAPP output directories copy one local computer using scp.\nscript run (take 8 hours), locate final_output/marker_contig_map.tsv files TreeSAPP output directories copy one local computer using scp.steps, continue analysis results R local computer using R provided treesapp_analysis.R script template.","code":"scp <path to file on your computer> <user>@<server address>:<destination>chmod u+x treesapp_analysis.sh"},{"path":"running-treesapp-on-a-server.html","id":"shell-writing","chapter":"11 Running TreeSAPP on a server","heading":"11.3 Writing the shell script","text":"treesapp_analysis.sh script, define variables make code readable running commands, give feedback user script runs, finally run TreeSAPP workflow. Edit script either local computer copied server using text editor choice (e.g. RStudio local machine nano server).","code":""},{"path":"running-treesapp-on-a-server.html","id":"defining-the-shell","chapter":"11 Running TreeSAPP on a server","heading":"11.3.1 Defining the shell","text":"script template starts :defines shell used interpret script shell located (.e. bash shell /bin directory). need modify anything step.","code":"#! bin/bash"},{"path":"running-treesapp-on-a-server.html","id":"setting-a-variable-for-your-depth","chapter":"11 Running TreeSAPP on a server","heading":"11.3.2 Setting a variable for your depth","text":"Let’s define first variable name “depth”. Replace <depth> depth group assigned (e.g. 100).","code":"depth=\"<your  depth>\""},{"path":"running-treesapp-on-a-server.html","id":"providing-user-feedback","chapter":"11 Running TreeSAPP on a server","heading":"11.3.3 Providing user feedback","text":"good practice provide feedback user script running printing messages terminal. Let’s print welcome message terminal using echo command informing user script going . great opportunity call depth variable just defined.Hint: Remember, call variable, prepend name $, e.g. variable’s name some_variable call $some_variable.","code":"echo \"TreeSAPP analysis of Saanich Inlet Data at Depth <call depth variable> m\""},{"path":"running-treesapp-on-a-server.html","id":"defining-variable-for-input-directory","chapter":"11 Running TreeSAPP on a server","heading":"11.3.4 Defining variable for input directory","text":"Define variable path input data directory. Let’s call variable input_dir.","code":"<variable_name>=\"<path to data directory>\""},{"path":"running-treesapp-on-a-server.html","id":"creating-output-directory","chapter":"11 Running TreeSAPP on a server","heading":"11.3.5 Creating output directory","text":"Define variable TreeSAPP output directory choose name . directory located home directory (also shared host container). refer home directory, use environmental variable HOME automatically defined shell (.e. need first define ). Finally, create output directory.","code":"<set output directory variable>\n<create the ouput directory>"},{"path":"running-treesapp-on-a-server.html","id":"reporting-variables-to-user","chapter":"11 Running TreeSAPP on a server","heading":"11.3.6 Reporting variables to user","text":"Let’s provide user feedback TreeSAPP going save output bind paths set.","code":"<print command> \"<Some text explaining what variables have been set>\""},{"path":"running-treesapp-on-a-server.html","id":"listing-treesapp-version","chapter":"11 Running TreeSAPP on a server","heading":"11.3.7 Listing TreeSAPP version","text":"Let’s print information configuration TreeSAPP.Hint: long commands script, can introduce line breaks using \\ best used right space command (see example word “following”).","code":" treesapp info"},{"path":"running-treesapp-on-a-server.html","id":"executing-treesapp-analysis","chapter":"11 Running TreeSAPP on a server","heading":"11.3.8 Executing TreeSAPP analysis","text":"terminal (.e. part script), check documentation treesapp assign, command use automated reconstruction nutrient cycle (visit wikipage learn ).Looking TreeSAPP documentation, determine flags need addition ones already included .Time run analysis! identify input file(s) need process. run analysis metagenomic (two files, forward reads file contains .1 name, reverse reads file .2) metatranscriptomic reads (single file contains forward reverse reads) align assembled contigs. reads pair-end.need provide following settings using flags:assembly file use.use 8 CPUs analysis.analysis marker genes provided TreeSAPP.output verbose runtime log.save results.calculate rpkm values detected sequences.reads use type (.e. pair-end single-end).delete intermediate files generated analysis.use position masking multiple sequence alignment.Hints:ouput data metagenomic metatranscriptomic analysis folder? folder already exist?want default value flag, need provide .input data located singularity container?Metatrascriptomic reads rRNA.scripts often refer variables combined additional text. Let’s say defined variable file_name=\"some_file\" refer file some_file. Now want save modified version file some_file_modified. write $file_name_modified, shell know just want call variable called $file_name instead assume calling variable called $file_name_modified return empty string. indicate beginning end variable name, use curly braces. example, use ${file_name}_modified.Optional bonus challenge:\nEarlier defined depth variable. use way define assembly reads using analysis?","code":"treesapp assign -h# Metagenomic analysis\ntreesapp assign \\\n-i <input data dir><file path to your assembly> \\\n-m <choose the correct option> \\\n<number of CPU threads, set to 8>\n<your output directory> \\\n<your remaining settings>\n\n# Metatranscriptomic analysis\n<you are on your own now :)>"},{"path":"the-saanich-inlet-data-set.html","id":"the-saanich-inlet-data-set","chapter":"A The Saanich Inlet data set","heading":"A The Saanich Inlet data set","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"description","chapter":"A The Saanich Inlet data set","heading":"A.1 Description","text":"work real-world data collected part ongoing oceanographic time series program Saanich Inlet, seasonally anoxic fjord East coast Vancouver Island, British Columbia:\nFIGURE .1: Saanich Inlet\nFigure .1 shows map Saanich Inlet indicating conventional sample collection stations (S1-S9). data used tutorial (sourced S3, Cruise 72) include various geochemical measurements genomic transcriptomic data microbial samples depths 10, 100, 120, 135, 150, 165 200 m.details data, see (14), detailed information environmental context time series data, see (15).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"data-on-the-server","chapter":"A The Saanich Inlet data set","heading":"A.2 Data on the server","text":"Saanich data located MICB425 server /mnt/datasets/saanich/.Additionally, like run GTDB-TK, path GTDB refrence directory located /mnt/datasets/GTDB-Tk/release95/","code":"/mnt/datasets/saanich/\n├── [   0]  directory_structure.txt\n├── [492M]  MAGs\n│   └── [492M]  Concatenated\n│       └── [492M]  All_SI072_Metawrap_MAGs.fa\n├── [3.5G]  MetaG_Assemblies\n│   ├── [630M]  SI072_100m_contig.fa\n│   ├── [525M]  SI072_10m_contig.fa\n│   ├── [571M]  SI072_120m_contig.fa\n│   ├── [505M]  SI072_135m_contig.fa\n│   ├── [396M]  SI072_150m_contig.fa\n│   ├── [748M]  SI072_165m_contig.fa\n│   └── [219M]  SI072_200m_contig.fa\n│   └── [3.5G]  SI072_All_contigs.fa\n├── [ 64G]  MetaG_Trim_QC_Reads\n│   ├── [4.7G]  SI072_100m_pe.1.fq.gz\n│   ├── [4.7G]  SI072_100m_pe.2.fq.gz\n│   ├── [4.2G]  SI072_10m_pe.1.fq.gz\n│   ├── [4.2G]  SI072_10m_pe.2.fq.gz\n│   ├── [4.2G]  SI072_120m_pe.1.fq.gz\n│   ├── [4.2G]  SI072_120m_pe.2.fq.gz\n│   ├── [4.4G]  SI072_135m_pe.1.fq.gz\n│   ├── [4.4G]  SI072_135m_pe.2.fq.gz\n│   ├── [4.8G]  SI072_150m_pe.1.fq.gz\n│   ├── [4.7G]  SI072_150m_pe.2.fq.gz\n│   ├── [6.5G]  SI072_165m_pe.1.fq.gz\n│   ├── [6.4G]  SI072_165m_pe.2.fq.gz\n│   ├── [3.3G]  SI072_200m_pe.1.fq.gz\n│   └── [3.3G]  SI072_200m_pe.2.fq.gz\n├── [ 54G]  MetaT_Raw_Reads\n│   ├── [8.9G]  SI072_100m_MetaT_QC_Filtered.fastq.gz\n│   ├── [6.4G]  SI072_10m_MetaT_QC_Filtered.fastq.gz\n│   ├── [6.8G]  SI072_120m_MetaT_QC_Filtered.fastq.gz\n│   ├── [7.2G]  SI072_135m_MetaT_QC_Filtered.fastq.gz\n│   ├── [10.0G]  SI072_150m_MetaT_QC_Filtered.fastq.gz\n│   ├── [8.7G]  SI072_165m_MetaT_QC_Filtered.fastq.gz\n│   └── [6.0G]  SI072_200m_MetaT_QC_Filtered.fastq.gz\n├── [181M]  SAGs\n│   └── [181M]  Concatenated_Med_Plus\n│       └── [181M]  Saanich_Med_Plus_SAGs.fasta\n└── [ 42K]  seq2lineage_Tables\n    ├── [ 17K]  Med_Plus_SAGs_GTDB_Taxonomies.tsv\n    └── [ 25K]  SI072_MAGs_All_GTDB_taxonomies.tsv\n\n 122G used in 8 directories, 33 files"},{"path":"the-saanich-inlet-data-set.html","id":"description-of-input-data","chapter":"A The Saanich Inlet data set","heading":"A.3 Description of input data","text":"List directories contentsMAGs\nWithin Concatonated subdirectory, single All_SI072_Metawrap_MAGs.fa fasta file use treesapp assign treesapp update. MAGs generated MetaWrap pipeline (16) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.MAGsWithin Concatonated subdirectory, single All_SI072_Metawrap_MAGs.fa fasta file use treesapp assign treesapp update. MAGs generated MetaWrap pipeline (16) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.MetaG_Assemblies\ndirectory contains seven assembled metagenomic contigs SI072 sample depth, one file concatonated single file. files used treesapp assign abundance tutorials. files generated assembling trimmed quality controlled reads generated Illumina HiSeq platform (see Methods).MetaG_AssembliesThis directory contains seven assembled metagenomic contigs SI072 sample depth, one file concatonated single file. files used treesapp assign abundance tutorials. files generated assembling trimmed quality controlled reads generated Illumina HiSeq platform (see Methods).MetaG_Trim_QC_Reads\ndirectory contains fourteen fastq files contain paired-end forward reverse metagenomic reads SI072 sample depth. trimmed QC’d fastqs generated processing raw reads Megahit workflow described . use files treesapp abundance get metagenomic abundance assigned genes.MetaG_Trim_QC_ReadsThis directory contains fourteen fastq files contain paired-end forward reverse metagenomic reads SI072 sample depth. trimmed QC’d fastqs generated processing raw reads Megahit workflow described . use files treesapp abundance get metagenomic abundance assigned genes.MetaT_Raw_Reads\ndirectory contains seven filtered QC’d metatranscriptome fastq files SI072 Sample depth. files paired end interleaved. files provided JGI generated based methodology . use files treesapp abundance calculate metatransciptomic abundances gene interest.MetaT_Raw_ReadsThis directory contains seven filtered QC’d metatranscriptome fastq files SI072 Sample depth. files paired end interleaved. files provided JGI generated based methodology . use files treesapp abundance calculate metatransciptomic abundances gene interest.SAGs\nWithin Concatenated_Med_Plus subdirectory, single Saanich_Med_Plus_SAGs.fasta file use treesapp assign treesapp update. MAGs generated SAG Assembly Decontamination Workflow (17–20) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.SAGsWithin Concatenated_Med_Plus subdirectory, single Saanich_Med_Plus_SAGs.fasta file use treesapp assign treesapp update. MAGs generated SAG Assembly Decontamination Workflow (17–20) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.seq2lineage_Tables\ndirectory contains two files used treesapp update. One file contains lineage information MAGs, contains information SAGs. tables generated taking separate MAG SAG respectively passing Genome Taxonomic Database Toolkit v1.4.0 classify workflow (7) (see Methods). , first two columns archaeal bacterial summary files taken combined files.seq2lineage_TablesThis directory contains two files used treesapp update. One file contains lineage information MAGs, contains information SAGs. tables generated taking separate MAG SAG respectively passing Genome Taxonomic Database Toolkit v1.4.0 classify workflow (7) (see Methods). , first two columns archaeal bacterial summary files taken combined files.","code":""},{"path":"the-saanich-inlet-data-set.html","id":"methods","chapter":"A The Saanich Inlet data set","heading":"A.4 Methods","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"metagenomes-and-metatransriptopmes","chapter":"A The Saanich Inlet data set","heading":"A.4.1 Metagenomes and metatransriptopmes","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"sample-collection","chapter":"A The Saanich Inlet data set","heading":"A.4.1.1 Sample Collection","text":"Water collected 10, 100, 120, 135, 150, 165, 200m Saanich Inlet August 1st, 2012 filtered 0.22 µm Sterivex filter collect biomass. Total genomic DNA RNA extracted filters. RNA reversed transcribed cDNA genomic DNA cDNA used construction shotgun Illumina libraries. Sequencing data generated Illumina HiSeq platform 2x150bp technology. -depth sampling sequencing methods, please see (21).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"quality-filtering-of-reads","chapter":"A The Saanich Inlet data set","heading":"A.4.1.2 Quality filtering of reads","text":"resulting reads processed, quality controlled filtered Trimmomatic (v.0.35, documentation) (17). Trimmomatic command follows, SI072_XXX represents command applied seven depths.resulting trimmed fastq files also deposited MICB425 server /mnt/datasets/saanich/MetaG_Trim_QC_Reads","code":"trimmomatic -threads 8 -phred33 \\\nPath_to/SI072_XXXm/Raw/forward_dir/SI072_XXXm_R1.fastq \\\nPath_To/SI072_200m/Raw/reverse_dir/SI072_XXXm_R2.fastq \\\n\nPath_To/SI072_200m//trim/SI072_XXXm_pe.1.fq \\\n\nPath_To/SI072_200m//trim/SI072_XXXm_pe.2.fq \\\n\nILLUMINACLIP:/usr/local/share/Trimmomatic-0.35/adapters/TruSeq3-PE.fa:2:3:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36"},{"path":"the-saanich-inlet-data-set.html","id":"contig-assembly","chapter":"A The Saanich Inlet data set","heading":"A.4.1.3 Contig Assembly","text":"MEGAHIT (v.1.1.3, documentation) (22) used assemble filtered metagenomic reads contigs.resulting assemblies can found /mnt/datasets/saanich/MetaG_Assemblies.","code":"megahit -1 Path_To/SI072_200m//trim/SI072_XXXm_pe.1.fq  -2 Path_To/SI072_200m//trim/SI072_XXXm_pe.2.fq  -m 0.5  -t 12  -o megahit_result --k-min 27 --k-step 10 --min-contig-len 500"},{"path":"the-saanich-inlet-data-set.html","id":"binning-and-mag-generation","chapter":"A The Saanich Inlet data set","heading":"A.4.1.4 Binning and MAG Generation","text":"MetaWRAP (v1.2.4, documentation) (16) used generate MAGs metagenome assemblies filtered reads project. MetaWRAP leverages multiple binning software (chose use MetaBAT2 v2.12.1 (23) MaxBin v2.2.7 (24), (25)) create non-redundant set MAGs better quality single software. quality resulting bins – assessed completeness, contamination, strain-heterogeneity – calculated MetaWRAP’s implementation CheckM (v1.0.12) (19). command used invoke MetaWRAP follows:","code":"metawrap binning -a SI072_Assembly.fa -o output_directory -t 16 -m 64 -l 1500 --metabat2 --maxbin2 --universal Path_To/SI072_200m//trimSI072_XXXm_pe.1.fastq Path_To/SI072_200m//trimSI072_XXXm_pe.2.fastq"},{"path":"the-saanich-inlet-data-set.html","id":"taxonomic-assignment-of-mags","chapter":"A The Saanich Inlet data set","heading":"A.4.1.5 Taxonomic Assignment of MAGs","text":"resulting MAGs passed GTDB-TK v1.4.0 classify workflow reference data version r95 documentation (7).updating headers resulting 219 bins sample IDs, bins concatenated deposited : /mnt/datasets/saanich/MAGs/Concatenated/","code":"gtdbtk classify_wf --genome_dir Path_To_SI072/MAGs/ -x .fa --out_dir Path_To_SI072/MAG_GTDB_Outputs/ --cpus 8 --pplacer_cpus 8\n"},{"path":"the-saanich-inlet-data-set.html","id":"single-cell-amplified-genomes","chapter":"A The Saanich Inlet data set","heading":"A.4.2 Single-Cell Amplified Genomes","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"sample-collection-1","chapter":"A The Saanich Inlet data set","heading":"A.4.2.1 Sample Collection","text":"Water collected across water column Saanich Inlet August 9th, 2011. 900 µL seawater aliquoted 100 µL glycerol-TE buffer, stored -80 degrees Celsius. Samples 100m, 150m, 185m selected sorting sequencing. selected samples thawed microbial cells sorted Bigelow Laboratory Ocean Sciences’ Single Cell Genomics Center (scgc.bigelow.org).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"florescence-activated-cell-sorting","chapter":"A The Saanich Inlet data set","heading":"A.4.2.2 Florescence Activated Cell Sorting","text":"Samples passed sterile 40 𝜇m size mesh microorganisms sorted non-targeted isolation procedure. non-target isolation, microbial particles labeled 5 𝜇M final concentration DNA stain SYTO-9 (Thermo Fisher Scientific). Microbial cells individually sorted using MoFloTM (Beckman Coulter) InFluxTM (BD Biosciences) flow cytometer system equipped 488 nm laser excitation 70 μm nozzle orifice30. gates untargeted isolation microbial cells stained SYTO-9 defined based green fluorescence particles proxy nucleic acid content, side scattered light proxy particle size. microbial single cells sorted 384-well plates containing 600 nL 1X TE buffer per well stored -80 degrees Celsius. microbial single-cells sorted TE buffer lysed described previously adding cold KOH.microbial nucleic acids amplified individual wells Multiple Displacement Amplification (MDA) (26), (27).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"amplicon-taxonomic-screening","chapter":"A The Saanich Inlet data set","heading":"A.4.2.3 Amplicon Taxonomic Screening","text":"SAGs generated MDA methodology taxonomically characterized sequencing determined phylogenetic marker using amplification based approach. SAGs screened small subunit ribosomal rRNA gene (SSU rRNA) using primers bacterial (27-F: 5’- AGAGTTTGATCMTGGCTCAG -3’37, 907-R: 5’- CCGTCAATTCMTTTRAGTTT -3’38 archaeal sequences (Arc_344F: 5’- ACGGGGYGCAGCAGGCGCGA -3’39, Arch_915R: 5’- GTGCTCCCCCGCCAATTCCT -3’40). real-time PCR sequencing procedure resulting amplicons performed previously described (28), (29). partial SSU rRNA gene sequences queried SILVA database v138.1 (30) blastn, BLAST+ v2.9.0 (31).","code":" blastn -query -db -outfmt \"6 qacc sacc stitle staxid pident bitscore\" -max_target_seqs 1 -num_threads 4 -out "},{"path":"the-saanich-inlet-data-set.html","id":"sag-sequencing-and-assembly","chapter":"A The Saanich Inlet data set","heading":"A.4.2.4 SAG Sequencing and Assembly","text":"MDA products SAGs sequenced described previously (28), (29) Illumina HiSeq 2000. resulting raw reads filtered trimmed remove adaptors Trimmomatic v0.35 (17).Trimmed quality controlled reads assembled SPAdes v3.9.0 (32) standard parameters.","code":"trimmomatic -threads 8 -phred33 \\\nPath_to/SI072_XXXm/Raw/forward_dir/SI072_XXXm_R1.fastq \\\nPath_To/SI072_200m/Raw/reverse_dir/SI072_XXXm_R2.fastq \\\n\nPath_To/SI072_200m//trim/SI072_XXXm_pe.1.fq \\\nPath_To/SI072_200m//trim/SI072_XXXm_se.1.fq \\\nPath_To/SI072_200m//trim/SI072_XXXm_pe.2.fq \\\nPath_To/SI072_200m//trim/SI072_XXXm_se.2.fq \\\n\nILLUMINACLIP:/usr/local/share/Trimmomatic-0.35/adapters/TruSeq3-PE.fa:2:3:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36spades.py \\\n--sc \\\n-o Path_To_assembly_dir/ \\\n-1 Path_To_trim_dir/SI072_XXXm_pe.1.fq \\\n-2 Path_To_trim_dir/SI072_XXXm_pe.1.fq \\\n-s Path_To_trim_dir/$sample\\_unpaired.fq \\\n-k $k_series \\\n--memory 90 \\\n--threads $threads \\\n--careful \\\n--cov-cutoff auto\n"},{"path":"the-saanich-inlet-data-set.html","id":"sag-assembly-quality-control-and-decontamination","chapter":"A The Saanich Inlet data set","heading":"A.4.2.5 SAG Assembly Quality Control and Decontamination","text":"Quality SAGs assessed using CheckM (v1.0.5) (19) following command:SAGs found >5% contamination passed ProDeGe v2.3.0 (20). resulting decontaminated SAGs re-assesed CheckM still exceeded 5% contamination short contigs (.e. <2000 bp) removed assembly. re-assessed CheckM ensure met standards.project, 376 SAGs recovered, 154 SAGs estimated >50% completeness <10% contamination selected remainder analysis.","code":"checkm lineage_wf --tab_table -x .fna --threads 8 --pplacer_threads 8"},{"path":"the-saanich-inlet-data-set.html","id":"final-taxonomic-assignment-of-sags","chapter":"A The Saanich Inlet data set","heading":"A.4.2.6 Final Taxonomic Assignment of SAGs","text":"resulting SAGs passed GTDB-TK v1.4.0 classify workflow documentation (7).updating headers resulting SAGs sample IDs, SAGs concatenated deposited : /mnt/datasets/saanich/SAGs/Concatenated_Med_Plus/Note: identifier SAG consists combination plate ID well location sorted . identifiers take form (AB-7XX_YYY). identifiers incorporated headers final SAG assemblies. plate corresponds specific depth shown :","code":"gtdbtk classify_wf --genome_dir Path_To_SI_SAGs/ -x .fna --out_dir Path_To_SI_SAGs/GTDB_1.4.0/ --cpus 8 --pplacer_cpus 8\n"},{"path":"the-saanich-inlet-data-set.html","id":"installing-and-running-gtdb-tk","chapter":"A The Saanich Inlet data set","heading":"A.5 Installing and running GTDB-Tk","text":"like use additional genomes MAGs capstone project, can also classify GTDB-Tk.like install GTDB-TK conda, first need create new conda environment. First, deactivate treesapp environment:follow instructions (originally : GTDB)install GTDB conda:made new GTDB environment, need add path latest GTDB reference data.Next, determine GTDB-Tk environment pathIt root/miniconda3/envs/gtdbtk-1.4.1/bin/gtdbtkNext, edit activate fileYou now ready use classify workflow command listed . need substitute directory name like write , well extension fasta files genomes.important set cpus pplacer_cpus flags 4 threads make sure tie server’s resources!running GTDB, can deactivate environment :can turn treesapp environment back continue treesapp analysis.recommend concatenating new genomes together cat single file ease use. example:","code":"conda deactivate treesapp_cenv# specific version (replace 1.4.1 with the version you wish to install, recommended)\nconda create -n gtdbtk-1.4.1 -c conda-forge -c bioconda gtdbtk=1.4.1\nconda activate gtdbtk-1.4.1which gtdbtk\necho \"export GTDBTK_DATA_PATH=/mnt/datasets/GTDB-Tk/release95/\" > /root/miniconda3/envs/gtdbtk-1.4.1/etc/conda/activate.d/gtdbtk.shgtdbtk classify_wf --genome_dir Path_To_Genomes/ \\\n    -x [Choose either .fa, .fasta, or .fna depending on the file extension] \\\n    --out_dir [Path_To_New_Genome_Output/here] \\\n    --cpus 4 \\\n    --pplacer_cpus 4conda deactivateconda activate treesapp_cenvcat *.fasta > All_Genomes.fasta\n"},{"path":"treesapp-reference-packages.html","id":"treesapp-reference-packages","chapter":"B TreeSAPP reference packages","heading":"B TreeSAPP reference packages","text":"TABLE B.1:  Available TreeSAPP reference packages","code":""},{"path":"shell-cheat-sheet.html","id":"shell-cheat-sheet","chapter":"C Shell cheat sheet","heading":"C Shell cheat sheet","text":"TABLE C.1:  Shell cheat sheetChange directory.. parent directory~ home directory- last visited directoryList files directory-l listLook text filePress Help navigationPress Quit leaveCopy files local serverGive file path server <user>@<server address>:<file path>Get list command historyFollow !<number> execute corresponding command -<filename> save history current session text file document workman <command>help <command><command> --helpCreate virtual terminal continues run jobs even connection server terminates-S <session name> create session <session name>-ls list running sessions-r <session name> resume sessionTo leave session keep running, first ctrl+activate commands screen, thendetach","code":""},{"path":"references.html","id":"references","chapter":"D References","heading":"D References","text":"1. Louca S, Hawley AK, Katsev S, Torres-Beltran M, Bhatia MP, Kheirandish S, Michiels CC, Capelle D, Lavik G, Doebeli M, Crowe SA, Hallam SJ. 2016. Integrating biogeochemistry multiomic sequence information model oxygen minimum zone. Proceedings National Academy Sciences 113:E5925–E5933.2. Hawley AK, Brewer HM, Norbeck AD, Pa -Toli L, Hallam SJ. 2014. Metaproteomics reveals differential modes metabolic coupling among ubiquitous oxygen minimum zone microbes. Proceedings National Academy Sciences 111:11395–11400.3. Morgan-Lang C, McLaughlin R, Armstrong Z, Zhang G, Chan K, Hallam SJ. 2020. TreeSAPP: Tree-based Sensitive Accurate Phylogenetic Profiler. Bioinformatics btaa588.4. Letunic , Bork P. 2019. Interactive Tree Life (iTOL) v4: recent updates new developments. Nucleic Acids Research 47:gkz239.5. Khadka R, Clothier L, Wang L, Lim CK, Klotz MG, Dunfield PF. 2018. Evolutionary History Copper Membrane Monooxygenases. Frontiers Microbiology 9:2493.6. Criscuolo , Gribaldo S. 2010. BMGE (block mapping gathering entropy): new software selection phylogenetic informative regions multiple sequence alignments. BMC Evol Biol 10.7. Chaumeil P-, Mussig AJ, Hugenholtz P, Parks DH. 2019. GTDB-Tk: toolkit classify genomes genome taxonomy database. Bioinformatics.8. Hallam SJ, Mincer TJ, Schleper C, Preston CM, Roberts K, Richardson PM, DeLong EF. 2006. Pathways carbon assimilation ammonia oxidation suggested environmental genomic analyses marine Crenarchaeota. PLoS biology 4:e95.9. Suzuki T, Nakamura T, Fuse H. 2012. Isolation two novel marine ethylene-assimilating bacteria, Haliea species ETY-M ETY-NAG, containing particulate methane monooxygenase-like genes. Microbes Environments 27:54–60.10. Oswald K, Graf JS, Littmann S, Tienken D, Brand , Wehrli B, Albertsen M, Daims H, Wagner M, Kuypers MMM, Schubert CJ, Milucka J. 2017. Crenothrix major methane consumers stratified lakes. ISME Journal 11:2124–2140.11. Rochman FF, Kwon M, Khadka R, Tamas , Lopez-Jauregui AA, Sheremet , V. Smirnova , Malmstrom RR, Yoon S, Woyke T, Dunfield PF, Verbeke TJ. 2020. Novel copper-containing membrane monooxygenases (CuMMOs) encoded alkane-utilizing Betaproteobacteria. ISME Journal 14:714–726.12. Wagner GP, Kin K, Lynch VJ. 2012. Measurement mRNA abundance using RNA-seq data: RPKM measure inconsistent among samples. Theory Biosciences 131:281–285.13. Li H. 2013. Aligning sequence reads, clone sequences assembly contigs BWA-MEM. arXiv.14. Hallam SJ, Torres-Beltrán M, Hawley AK. 2017. Monitoring microbial responses ocean deoxygenation model oxygen minimum zone. Scientific Data 4:170158.15. Torres-Beltrán M, Hawley AK, Capelle D, Zaikova E, Walsh DA, Mueller , Scofield M, Payne C, Pakhomova L, Kheirandish S, Finke J, Bhatia M, Shevchuk O, Gies EA, Fairley D, Michiels C, Suttle CA, Whitney F, Crowe SA, Tortell PD, Hallam SJ. 2017. compendium geochemical information Saanich Inlet water column. Scientific Data 4:170159.16. Uritskiy GV, DiRuggiero J, Taylor J. 2018. MetaWRAP—flexible pipeline genome-resolved metagenomic data analysis. Microbiome 6:158.17. Bolger , Lohse M, Usadel B. 2014. Trimmomatic: flexible trimmer Illumina sequence data. Bioinformatics 30:2114–2120.18. Prjibelski , Antipov D, Meleshko D, Lapidus , Korobeynikov . 2020. Using SPAdes De Novo Assembler. Current Protocols Bioinformatics 70:e102.19. Parks DH, Imelfort M, Skennerton CT, Hugenholtz P, Tyson GW. 2015. CheckM: assessing quality microbial genomes recovered isolates, single cells, metagenomes. Genome Research 25:1043–1055.20. Tennessen K, Andersen E, Clingenpeel S, Rinke C, Lundberg DS, Han J, Dangl JL, Ivanova N, Woyke T, Kyrpides N, Pati . 2016. ProDeGe: computational protocol fully automated decontamination genomes. ISME Journal 10:269–272.21. Hawley AK, Torres-Beltrán M, Zaikova E, Walsh DA, Mueller , Scofield M, Kheirandish S, Payne C, Pakhomova L, Bhatia M, Shevchuk O, Gies EA, Fairley D, Malfatti SA, Norbeck AD, Brewer HM, Pasa-Tolic L, Rio TG del, Suttle CA, Tringe S, Hallam SJ. 2017. compendium multi-omic sequence information Saanich Inlet water column. Scientific Data 4:170160.22. Li D, Liu C-M, Luo R, Sadakane K, Lam T-W. 2015. MEGAHIT: ultra-fast single-node solution large complex metagenomics assembly via succinct de Bruijn graph. Bioinformatics 31:1674–1676.23. Kang DD, Li F, Kirton E, Thomas , Egan R, H, Wang Z. 2019. MetaBAT 2: adaptive binning algorithm robust efficient genome reconstruction metagenome assemblies. PeerJ 7:e7359.24. Wu Y-W, Tang Y-H, Tringe SG, Simmons BA, Singer SW. 2014. MaxBin: automated binning method recover individual genomes metagenomes using expectation-maximization algorithm. Microbiome 2:1–18.25. Wu Y-W, Simmons BA, Singer SW. 2016. MaxBin 2.0: automated binning algorithm recover genomes multiple metagenomic datasets. Bioinformatics 32:605–607.26. Raghunathan , Ferguson HR, Bornarth CJ, Song W, Driscoll M, Lasken RS. 2005. Genomic dna amplification single bacterium. Applied environmental microbiology 71:3342–3347.27. Rinke C, Lee J, Nath N, Goudeau D, Thompson B, Poulton N, Dmitrieff E, Malmstrom R, Stepanauskas R, Woyke T. 2014. Obtaining genomes uncultivated environmental microorganisms using FACS-based single-cell genomics. Nat Protoc 9:1038–1048.28. Tyson GW, Chapman J, Hugenholtz P, Allen EE, Ram RJ, Richardson PM, Solovyev VV, Rubin EM, Rokhsar DS, Banfield JF. 2004. Community structure metabolism reconstruction microbial genomes environment. Nature 428:37–43.29. Swan BK, Martinez-Garcia M, Preston CM, Sczyrba , Woyke T, Lamy D, Reinthaler T, Poulton NJ, Masland EDP, Gomez ML, Sieracki , DeLong EF, Herndl GJ, Stepanauskas R. 2011. Potential chemolithoautotrophy among ubiquitous bacteria lineages dark ocean. Science 333:1296–1300.30. Quast C, Pruesse E, Yilmaz P, Gerken J, Schweer T, Yarza P, Peplies J, Glöckner FO. 2013. SILVA ribosomal RNA gene database project: Improved data processing web-based tools. Nucleic Acids Res 41:D590–6.31. Camacho C, Coulouris G, Avagyan V, Ma N, Papadopoulos J, Bealer K, Madden TL. 2009. BLAST+: Architecture applications. BMC Bioinformatics 10:421.32. Bankevich , Nurk S, Antipov D, Gurevich AA, Dvorkin M, Kulikov , Lesin VM, Nikolenko SI, Pham S, Prjibelski AD, Pyshkin AV, Sirotkin AV, Vyahhi N, Tesler G, Alekseyev MA, Pevzner PA. 2012. SPAdes: new genome assembly algorithm applications single-cell sequencing. J Comput Biol 19:455–477.","code":""}]
