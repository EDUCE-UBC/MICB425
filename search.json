[{"path":"index.html","id":"overview","chapter":"Overview","heading":"Overview","text":"document introduces bioinformatics workflows useful gene-centric mapping functional phylogenetic anchors encoded microbial genomes sourced natural engineered environments.Part outlines motivation insights afforded use workflows study uncultivated microbial community structure function.Part II provides hands-tutorials learn two effective tools gene-centric analysis, TreeSAPP iTOL.Part III described capstone project explore primary metagenomic metatranscriptomic data collected Saanich Inlet water column spanning defined nutrient energy gradient.","code":""},{"path":"exploring-the-microcosmos.html","id":"exploring-the-microcosmos","chapter":"1 Exploring the microcosmos","heading":"1 Exploring the microcosmos","text":"","code":""},{"path":"exploring-the-microcosmos.html","id":"background","chapter":"1 Exploring the microcosmos","heading":"1.1 Background","text":"live world dominated microbial life. Accounting bacteria archaea (prokaryotes) alone, estimated 1030 cells occupy biosphere. Earth’s history, microcosmos driving matter energy transformations distributed networks metabolite exchange resulting global biogeochemical cycles symbiotic interactions create sustain conditions multicellular existence, including .Recent advances high-throughput sequencing mass spectrometry platforms enabled us develop quantitative insights networks’ structure function individual, population, community levels biological organization. resulting data sets revealed incredible diversity ecological resilience provided opportunity develop predictive models sustainable biotechnologies potential transform way humans interact natural world one another.Despite power promise new perception, exist dangerously close upsetting planetary boundaries promoted successful human expansion past 20,000 years. Global climate change one manifestation cost paid pursuit material energy resources. Still, others, including biodiversity loss habitat destruction, rampant pollution, imbalances integral element cycling nitrogen phosphorous.Given increasing availability data sets describing microbial community structure function world around us, opportunity learn information using bioinformatic tools approaches. course, focus one manifestation climate change-related dissolved oxygen () loss ocean using model ecosystem source multi-omic (DNA RNA) geochemical parameter information space time.Oxygen minimum zones (OMZs) widespread areas low subsurface waters. Climate change resulting increased stratification reduced oxygen solubility warming waters leads OMZ expansion. Consequently, oxygen levels decline, microbial communities inhabiting OMZ waters shift metabolisms utilize alternative terminal electron acceptors. shift results production climate-active trace gases nitrous oxide (N2O) methane (CH4).Specifically, study effects changing oxygen levels communities bacteria archaea inhabiting Saanich Inlet water column. Saanich Inlet, situated coast Vancouver Island, British Columbia, seasonally anoxic fjord provides biodynamic perspective OMZ expansion. systems ecology perspective, OMZs provide useful environmental contexts study coupled biogeochemical cycling distributed metabolic networks, especially integration carbon, nitrogen sulphur cycles.combining multi-omics geochemical parameter information OMZs, becomes possible evaluate microbial communities’ regulatory response dynamics changing levels. example, OMZs hotspots nitrogen loss processes reconstructing nitrogen cycle distributed metabolic process can shed new insight microbial controls matter energy transformations integral ocean health climate balance. Genes encoding key steps nitrogen cycle well defined (Figure 1.1), providing basis functional anchor screening determine distribution across Tree Life.\nFIGURE 1.1: Nitrogen cycle\n","code":""},{"path":"exploring-the-microcosmos.html","id":"using-multi-omic-data-to-reconstruct-distributed-networks-of-metabolite-exchange","chapter":"1 Exploring the microcosmos","heading":"1.2 Using multi-omic data to reconstruct distributed networks of metabolite exchange","text":"nitrogen cycle just one aspect distributed metabolic network defines microbial interaction space. Throughout capstone project, opportunity explore space using gene-centric approach. approach based identifying quantifying phylogenetic functional anchor genes represent key microbial players metabolic pathways system study. big picture sense, want use data answer three foundational questions concerning microbial community structure function: ? ? respond change?Biological information flow can described process converting genotypic information encoded DNA base pairs genome transcribed RNA messages translated proteins level ribosome. proteins, turn, go catalyze metabolic transformations regulatory dynamics ultimately give rise phenotypic expression, adaptation response. flow information formally referred Central Dogma Biology.Genomic sequence information provides basis determining types microorganisms present sample inferring metabolic potential individual, population community levels biological organization. DNA can persist environment longer RNA protein, can also use abundance gene X gene Y tell us prior metabolic activity, e.g. gene abundance proxy process. can use gene abundance information numerical models infer metabolic flux given pathway abundance gene X proportional genome replication resides. Genomic information also robust sampling noise collect process samples downstream analysis. information gene-centric modelling incorporating DNA, RNA protein information Saanich Inlet, see paper (1).genomic information tells us metabolic potential, transcriptome guides action gene expression. certain extent, can use information identify , often, indicate pathways active time sampling. Transcriptomic data can open window response patterns along environmental gradients caveat short-lived nature less robust sampling noise. presence transcripts given gene X guarantee conversion protein. However, prokaryotes couple transcription translation, typically infer direct relationship. information relationships DNA, RNA protein Saanich Inlet, see paper well (2).","code":""},{"path":"exploring-the-microcosmos.html","id":"treesapp","chapter":"1 Exploring the microcosmos","heading":"1.3 TreeSAPP","text":"project, implementing software application called Tree-based Sensitive Accurate Protein Profiler (TreeSAPP) (3). Given current set reference packages available, position reconstruct key steps selected biogeochemical cycles, e.g. carbon, nitrogen sulphur, along defined redox gradients Saanich Inlet. TreeSAPP takes either metagenomic metatranscriptomic reads aligns reference packages representing phylogenetic functional anchor genes interest. reference packages constructed trusted sources consist phylogenetic tree, multiple sequence alignment, hidden Markov model taxonomic lineage information. Reference packages can updated refined new sequence information becomes available, including isolate reference genomes, metagenome-assembled genomes (MAGs) single-cell amplified genomes (SAGs), thereby improving precision taxonomic placement. TreeSAPP outputs can readily visualized using interactive Tree Life (iTOL) (4) plotted R make beautiful informative data visualization products.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"a-tutorial-for-using-treesapp","chapter":"2 A tutorial for using TreeSAPP","heading":"2 A tutorial for using TreeSAPP","text":"","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"introduction-and-goals","chapter":"2 A tutorial for using TreeSAPP","heading":"2.1 Introduction and goals","text":"series tutorials, users analyze gene family lacking existing TreeSAPP reference package (refpkg). work typical workflow TreeSAPP example gene (XmoA) familiarize tools, repeat steps gene assigned group reference package exists. document efforts new reference package Problem Set 5.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"a-typical-treesapp-workflow","chapter":"2 A tutorial for using TreeSAPP","heading":"2.2 A typical TreeSAPP workflow","text":"Acquiring golden data.Creating Reference Package TreeSAPP.Classifying unknown sequences TreeSAPP updating reference package.Calculating relative abundance meta’omic data.Analysing TreeSAPP classifications R.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"genes-for-creating-reference-packages","chapter":"2 A tutorial for using TreeSAPP","heading":"2.3 Genes for creating reference packages","text":"","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"xmoa","chapter":"2 A tutorial for using TreeSAPP","heading":"2.3.1 XmoA","text":"protein family focusing copper-containing membrane-bound monooxygenases (5). family contains particulate methane monooxygenase (pMMO) ammonia monooxygenase (AMO) well building reference package alpha subunits enzymes called XmoA. students work example individually.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"group-assigned-genes","chapter":"2 A tutorial for using TreeSAPP","heading":"2.3.2 Group-assigned genes","text":"create reference package perform steps gene assigned .","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"tools","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4 Tools","text":"","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"shell","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4.1 Shell","text":"Please use short Shell cheat sheet commonly used commands review previous tutorials Canvas.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"treesapp-1","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4.2 TreeSAPP","text":"Tree-based Sensitive Accurate Phylogenetic Profiler (TreeSAPP) (3) can found GitHub including excellent wiki additional information treesapp subcommands.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"itol","chapter":"2 A tutorial for using TreeSAPP","heading":"2.4.3 iTOL","text":"Interactive Tree Life (iTOL) (4) browser-based tool allows visualize data generated TreeSAPP phylogenetic tree additional annotations.","code":""},{"path":"a-tutorial-for-using-treesapp.html","id":"data","chapter":"2 A tutorial for using TreeSAPP","heading":"2.5 Data","text":"Saanich Inlet data set already located server, download data different databases:FunGene, functional gene pipeline repository.EggNOG","code":""},{"path":"acquiring-golden-data.html","id":"acquiring-golden-data","chapter":"3 Acquiring golden data","heading":"3 Acquiring golden data","text":"Golden data context biological sequence analysis come well-curated open-source databases. data used create TreeSAPP reference packages date, used create future reference packages. “well-curated” mean, can identify data meet gold standard?","code":""},{"path":"acquiring-golden-data.html","id":"the-golden-standard","chapter":"3 Acquiring golden data","heading":"3.1 The golden standard","text":"field genomics blessed abundance reference data. fact, uncommon biologists bioinformaticians alike gripe increased run-time computational analyses caused steps include comparisons large reference databases. data , however, quality. vast majority automatically curated using algorithms known shortcomings, small portion manually curated verified functional characterization. latter data ones consider well-curated golden. details choosing databases retrieving sequences can found TreeSAPP wiki.","code":""},{"path":"acquiring-golden-data.html","id":"what-databases-can-i-retrieve-sequences-from","chapter":"3 Acquiring golden data","heading":"3.2 What databases can I retrieve sequences from?","text":"One comprehensive reputable biological sequence databases SwissProt. protein sequences curated within SwissProt can accessed downloaded UniProt Knowledgebase selecting “Swiss-Prot” “UniProtKB” panel left landing page. can submit queries protein family search bar add filters query using advanced search options. example, can search reviewed RuBisCO sequences entering query ‘rubisco taxonomy:“Bacteria [2]” reviewed:yes’.Throughout development TreeSAPP, frequented FunGene, functional gene pipeline repository. database provides curated sequences (varying reliability) many popular functional taxonomic anchor genes. FunGene also great since profile hidden Markov models (HMMs) every gene available. bioinformatics, HMMs commonly used represent group homologous amino acid sequences, often belonging protein family, probabilistic model. inferred modelling amino acid character frequencies motifs along length multiple aligned sequences. Additionally, providing sense full-length protein, allow users filter sequences based percentage HMM covered. Since ’re building reference tree, include roughly full-length sequences setting minimum HMM coverage parameter 60 90%.EggNOG another source curated orthologous groups. breadth families available astounding often sequences ’re looking . couple benefits accessing data EggNOG. first use common identifier format. Using correct identifier protein family, single search yield available amino acid sequences belonging protein family COG. ’ve found handy first looking Clusters Orthologous Gene (COG) identifier NCBI’s Conserved Domains database. ’d use identifier search sequences ’m interested EggNOG. second benefit quality automated annotation pipeline. every version EggNOG, entire set protein sequences clustered orthologous groups defined de novo. prevents incorrect legacy annotations propagating new sequences. Unfortunately, breadth taxa covered EggNOG limited just 5,090 organisms. many cases, good enough build “seed” reference package, especially ’re building reference package well-conserved—housekeeping—gene. Yet, plenty scenarios number sequences downloaded just objective, comprehensive reference package required—.addition general -encompassing databases, smaller curated databases independently maintained. tend gene- function-specific , long ’re still maintained, highly reliable. Perhaps notable Carbohydrate Active enZYmes (CAZy) database. maintainers CAZy constantly screen new sequenced GenBank sort hits different families based putative biochemical characterization.","code":""},{"path":"acquiring-golden-data.html","id":"xmoa-example","chapter":"3 Acquiring golden data","heading":"3.3 XmoA example","text":"show access data, download alpha subunit sequences enzymes particulate methane monooxygenase (PmoA) ammonia monooxygenase (AmoA) used treesapp create tutorial FunGene EggNOG databases.","code":""},{"path":"acquiring-golden-data.html","id":"fungene","chapter":"3 Acquiring golden data","heading":"3.3.1 FunGene","text":"First, navigate http://fungene.cme.msu.edu/. front page organizes genes respective functional groups. sequences ’re interested involved biogeochemical cycling, look panel “AmoA” “PmoA”.can see, AmoA broken four different entries: “amoA_AOA”, “amoA_AOB”, “amoA_AOB_like”, “amoA_comammox”. download sequences “amoA_AOA” “amoA_AOB”, let’s begin alphabetically “amoA_AOA”.sequences, limit just sequences derived isolate genomes functional taxonomic annotations reliable. , go “Display Options” top right. Click “Isolate” option “Update”. also want sequences --less full-length. Click “Show/Hide filter options”, fill “Minimum HMM Coverage” parameter “80” (number 60 90), “Filter”. ’s filtering ’re going . add sequences cart, click “Select Sequences” “Begin Analysis”.Deselect “Aligned” click “Download” button.Repeat steps genes “amoA_AOB” “PmoA”.","code":""},{"path":"acquiring-golden-data.html","id":"eggnog","chapter":"3 Acquiring golden data","heading":"3.3.2 EggNOG","text":"Go EggNOG website http://eggnog5.embl.de/#/app/home search either “ENOG5028JPK” “arCOG08676” search bar top page. EggNOG ortholog identifiers correspond PmoA/AmoA Bacteria AmoA Archaea, respectively. image , ’ve searched “ENOG5028JPK”.Click “Download” bottom-left panel select “XX sequences (FASTA)”, XX number sequences belonging orthologous group (OG). open new window sequences OG FASTA format. Download file file computer following format <OG name>_EggNOGv5.faa <OG name> EggNOG ortholog identifier.Repeat steps EggNOG identifier.","code":""},{"path":"acquiring-golden-data.html","id":"copying-data-onto-the-server","chapter":"3 Acquiring golden data","heading":"3.3.3 Copying data onto the server","text":"computer: Create new directory called Xmoa_sequences inside home directory using file browser, .e. File Explorer (Windows 10) Finder (macOS). Place reference sequences Xmoa_sequences identified downloaded databases.\nNext, connect personal server using terminal app, .e. Windows Terminal (Windows 10) Terminal (macOS).\nssh root@<server address>computer: Create new directory called Xmoa_sequences inside home directory using file browser, .e. File Explorer (Windows 10) Finder (macOS). Place reference sequences Xmoa_sequences identified downloaded databases.Next, connect personal server using terminal app, .e. Windows Terminal (Windows 10) Terminal (macOS).server: Move directory /data (working directory already), create new directory called ts_tutorial move .\ncd /data/\nmkdir ts_tutorial\ncd ts_tutorialOn server: Move directory /data (working directory already), create new directory called ts_tutorial move .computer: Open second terminal window connected local computer, copy reference sequences computer server.\nscp -r <path Xmoa_sequences> root@<server address>:/data/ts_tutorial computer: Open second terminal window connected local computer, copy reference sequences computer server.","code":"ssh root@<server address>cd /data/\nmkdir ts_tutorial\ncd ts_tutorialscp -r <path to Xmoa_sequences> root@<server address>:/data/ts_tutorial "},{"path":"acquiring-golden-data.html","id":"alternative-sources","chapter":"3 Acquiring golden data","heading":"3.4 Alternative sources","text":"EggNOG FunGene favourite sources, though leaves majority biological sequence databases reason simplicity. IMG, KEGG, PFam, similar databases great lack API retrieve lineage information, therefore needs provided separate table. Details table’s format provide can found treesapp create wiki page.","code":""},{"path":"acquiring-golden-data.html","id":"data-access-hazards","chapter":"3 Acquiring golden data","heading":"3.5 Data access hazards","text":"Accessing fraction well-curated data multiple databases trivial. Perhaps obvious reason unrelated genes shared names. example, gene product mcrB E. coli widely refers 5-methylcytosine-specific restriction enzyme B, Archaea, refer beta subunit methyl-coenzyme M reductase—completely unrelated protein. inevitability field science broad biology, scientists responsible naming genes possibly aware gene names circulation. Another issue can genes proteins synonyms, making search data complex. cases, may need search multiple databases several queries order access sequences belonging protein family.","code":""},{"path":"acquiring-golden-data.html","id":"validation","chapter":"3 Acquiring golden data","heading":"3.6 Validation","text":"number quality control measures can taken ensure functional characteristics expected.","code":""},{"path":"acquiring-golden-data.html","id":"basic","chapter":"3 Acquiring golden data","heading":"3.6.1 Basic","text":"BLAST: first method validating set candidate reference sequences use web-based Basic Local Alignment Search Tool available NCBI. Submit FASTA file containing sequences Protein BLAST (blastp) appropriate database. reduce processing time, can restrict reference sequences specific taxa use different algorithms. One thing note query size limit - blastp accept FASTA files containing fewer 100,000 characters. , good idea take representative sample cluster sequences submitting job.BLAST: first method validating set candidate reference sequences use web-based Basic Local Alignment Search Tool available NCBI. Submit FASTA file containing sequences Protein BLAST (blastp) appropriate database. reduce processing time, can restrict reference sequences specific taxa use different algorithms. One thing note query size limit - blastp accept FASTA files containing fewer 100,000 characters. , good idea take representative sample cluster sequences submitting job.EggNOG-mapper: didn’t download query sequences EggNOG database, good resource check sequences EggNOG mapper. annotate query sequences EggNOG database serve result several formats.EggNOG-mapper: didn’t download query sequences EggNOG database, good resource check sequences EggNOG mapper. annotate query sequences EggNOG database serve result several formats.","code":""},{"path":"acquiring-golden-data.html","id":"advanced","chapter":"3 Acquiring golden data","heading":"3.6.2 Advanced","text":"Phylogenetic inference: Try building phylogeny candidate reference sequences see whether anomolously long branches clades.hmmsearch across PFam database: Got time kill? Try aligning candidate reference sequences profile HMMs PFam database! need done command-line need download Pfam-.hmm.gz PFam ftp site.","code":""},{"path":"treesapp-create.html","id":"treesapp-create","chapter":"4 Creating a reference package for TreeSAPP","heading":"4 Creating a reference package for TreeSAPP","text":"","code":""},{"path":"treesapp-create.html","id":"introduction-and-goals-1","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.1 Introduction and goals","text":"tutorial demonstrate build TreeSAPP reference package assess whether mis-annotated final product.goals tutorial :learn use treesapp create build reference package simple protein family (XmoA) using sequences acquired previous tutorialLearn assess whether reference package contains homologous sequences using treesapp purityLearn view reference package’s phylogenetic tree using interactive Tree Life (iTOL)","code":""},{"path":"treesapp-create.html","id":"making-the-reference-package","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.2 Making the reference package","text":"Acquiring golden data tutorial, PmoA & AmoA sequences downloaded TIGRFAM, EggNOG, FunGene. now ’ll just use TIGRFAM seed sequences EggNOG sequences best curated. Let’s call seed reference package. steps involved :steps executed server unless stated otherwise!! Connect personal server continue work /data/ts_tutorial directory.Optional: download reference sequences XmoA (see Acquiring golden data), download xmoa_file_list.txt—list necessary fasta files—wget ts_tutorial directory, run wget retrieve file within list.Create input FASTA file combining EggNOG TIGRFAM reference single file using cat. cat stands concatentate, .e. files pasted together. output cat funneled > symbol <new file>, .e. cat <file 1> <file 2> > <new file>76 well curated PmoA AmoA fasta sequences file.Let’s look briefly newly generated fasta file.notice, lines start > gives name sequence followed line containing actual nucleotide sequence . can count confirm number sequences fasta file counting > using grep. grep incredibly powerful tool find matching text patterns (using format called “regular expression”) beyond scope tutorial. code searches > beginning line (defined \"^>\") file XmoA_seed.faa counts occurrence due option -c.Use submodule treesapp create build XmoA reference package different arguments (see visualization create workflow). speed things along, use FastTree infer phylogeny skip bootstrapping --fast. remove potential redundant sequences, cluster candidate reference sequences 97% similarity using argument -p. clustering candidate sequences TreeSAPP normally ask sequence use representative cluster. can handy cases sequences better annotated /especially important. speed things even , flag --headless prevent requests. command take ~2 minutes complete.final reference package file located XmoA_seed/final_outputs/XmoA_build.pkl. file contains individual components reference package (multiple sequence alignment, profile HMM, phylogenetic tree, taxonomic lineages) well data. files bundled using joblib Python library. can accessed individually using submodule treesapp package.Replace current refpkg_code Z1111 unique identifier N0102.can also modify reference package’s description ’re .","code":"cd /data/ts_tutorialcd /data/ts_tutorial\nwget https://raw.githubusercontent.com/hallamlab/TreeSAPP/master/docs/xmoa_file_list.txt\nwget -i xmoa_file_list.txtcat ENOG5028JPK_EggNOGv5.faa TIGR03080.faa arCOG08676_EggNOGv5.faa > XmoA_seed.faaless XmoA_seed.faagrep -c \"^>\" XmoA_seed.faatreesapp create \\\n  --fast \\\n  --headless \\\n  --overwrite \\\n  --cluster \\\n  --trim_align \\\n  -n 4 \\\n  -m prot \\\n  -p 0.97 \\\n  --fastx_input XmoA_seed.faa \\\n  -c XmoA \\\n  --output XmoA_seedtreesapp package edit \\\n  refpkg_code N0102 \\\n  --overwrite \\\n  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkltreesapp package edit \\\n  description \"Alpha subunits of copper membrane monooxygenase enzymes\" \\\n  --overwrite \\\n  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkl"},{"path":"treesapp-create.html","id":"testing-the-purity-of-the-reference-package","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.3 Testing the purity of the reference package","text":"determine whether mis-annotated sequences included reference package treesapp purity. , take well-curated database attempt classify sequences using treesapp assign. results analysed displayed user evaluate. TIGRFAM database fairly comprehensive, representing 4488 different groups version 15, using just TIGRFAM seed sequences (TIGRFAM_seed_named.faa) can fairly sure won’t evaluating classifications mis-annotated sequences.important bit output look like thisFrom summary appears reference package classified three homologous sequences placed leaf nodes tree (.e. ’re closely related) sequences family “TIGR03080”, also known “methane monooxygenase/ammonia monooxygenase, subunit ”. , probably good proceed!","code":"treesapp purity \\\n  --trim_align \\\n  -m prot \\\n  -n 4 \\\n  -r XmoA_seed/final_outputs/XmoA_build.pkl \\\n  --extra_info TIGRFAM_info.tsv \\\n  -i TIGRFAM_seed_named.faa \\\n  --output XmoA_puritySummarizing assignments for reference package XmoA\nOrtholog        Hits    Leaves  Tree-coverage   Description\n--------------------------------------------------------------------------------\nTIGR03080       3       4       11.1    methane monooxygenase/ammonia monooxygenase, subunit A"},{"path":"treesapp-create.html","id":"viewing-the-reference-package-tree-with-itol","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.4 Viewing the reference package tree with iTOL","text":"now created phylogenetic tree XmoA, visualize , see TreeSAPP identifiers (1_XmoA, 2_XmoA) labels tree meaningful. order assign leaf labels refpkg iTOL tree, use treesapp assign function.Assign reference sequences reference package generate tree labels.treesapp assign output directory (defined flag --output, .e. case XmoA_seed_assign) contains iTOL_output directory.computer: Transfer XmoA_seed_assign/iTOL_output server local directory Xmoa_sequences.can quickly easily view sequences placed phylogeny using iTOL. uploading JPlace file produced TreeSAPP. JPlace file contains phylogeny location placements visualized.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Upload file XmoA_complete_profile.jplace. can using either computer’s file browser navigating iTOL_output directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.Upload file XmoA_complete_profile.jplace. can using either computer’s file browser navigating iTOL_output directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.Next, navigate page displaying phylogeny click--drag file XmoA_labels.txt file browser iTOL window. convert TreeSAPP identifiers (e.g. 1_XmoA) useful descriptions organism name accession leaf node.Next, navigate page displaying phylogeny click--drag file XmoA_labels.txt file browser iTOL window. convert TreeSAPP identifiers (e.g. 1_XmoA) useful descriptions organism name accession leaf node.Finally, turn “Phylogenetic Placements” dataset (right screen) figure look identical figure Figure 4.1.\n\nFIGURE 4.1:  Phylogenetic tree XmoA_seed refpkg. red bubbles represent sequence placements size bubble indicating number placements branch. 76 sequences classified placed 36 leaf nodes.\nFinally, turn “Phylogenetic Placements” dataset (right screen) figure look identical figure Figure 4.1.FIGURE 4.1:  Phylogenetic tree XmoA_seed refpkg. red bubbles represent sequence placements size bubble indicating number placements branch. 76 sequences classified placed 36 leaf nodes.","code":"treesapp assign \\\n  -n 4 \\\n  -m prot \\\n  --trim_align \\\n  --refpkg_dir XmoA_seed/final_outputs/ \\\n  --fastx_input XmoA_seed.faa \\\n  --output XmoA_seed_assign/ scp -r root@<server address>:/data/ts_tutorial/XmoA_seed_assign/iTOL_output <path to Xmoa_sequences>"},{"path":"treesapp-create.html","id":"building-your-groups-reference-package","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.5 Building your group’s reference package","text":"Now covered first steps creating reference package TreeSAPP visualizing outputs. Adapt repeat steps Acquiring golden data creating reference package (chapter) gene assigned group using group’s server.computer: create directory <gene_name_sequences> home directory download reference sequences gene can find databases.computer: create directory <gene_name_sequences> home directory download reference sequences gene can find databases.server: directory /data, create new directory <gene name>.server: directory /data, create new directory <gene name>.computer: Copy reference sequences computer directory /data/<gene name> server.computer: Copy reference sequences computer directory /data/<gene name> server.server: Work /data/<gene name> creating TreeSAPP referenc package outputs.server: Work /data/<gene name> creating TreeSAPP referenc package outputs.computer: Whenever TreeSAPP outputs can visualized iTOL, copy files server computer .computer: Whenever TreeSAPP outputs can visualized iTOL, copy files server computer .","code":""},{"path":"treesapp-create.html","id":"booster-shot","chapter":"4 Creating a reference package for TreeSAPP","heading":"4.5.1 Booster shot","text":"reference package XmoA relatively small, ideal -class tutorial. However, many protein families much complex members spread broadly across tree life. cases, may need use tactics reduce size reference package treesapp create can finish hours. Using following options required, may useful.Remove candidate reference sequences final reference package decreasing percent similarity used sequence clustering. tutorial set “-p”/“--similarity” 0.97 going high many cases. Try something 0.80 0.95 get 100 2000 sequences.Remove candidate reference sequences final reference package decreasing percent similarity used sequence clustering. tutorial set “-p”/“--similarity” 0.97 going high many cases. Try something 0.80 0.95 get 100 2000 sequences.profile HMM can used accomplish two things: first can used remove sequences remote homology protein family ’re building reference package ; second, HMM alignment can used trim input sequences just conserved regions improving quality multiple sequence alignment phylogeny.\ncan download profile HMM EggNOG going gene’s EggNOG page, clicking Download ᐁ “HMM model”. typically available subgroups “Bacteria”, “Archaea”, “Proteobacteria”, etc. (.e. ‘root’).\nProvide HMM file treesapp create “--profile” argument.profile HMM can used accomplish two things: first can used remove sequences remote homology protein family ’re building reference package ; second, HMM alignment can used trim input sequences just conserved regions improving quality multiple sequence alignment phylogeny.\ncan download profile HMM EggNOG going gene’s EggNOG page, clicking Download ᐁ “HMM model”. typically available subgroups “Bacteria”, “Archaea”, “Proteobacteria”, etc. (.e. ‘root’).\nProvide HMM file treesapp create “--profile” argument.Metagenomic data Saanich Inlet generated biomass larger Eukaryotic cells physically removed prior sequencing. Therefore, organisms need present reference packages. can remove sequences Eukaryotic origin using either “--screen” “--filter” arguments. example, include Bacteria Archaea use --screen Bacteria,Archaea --filter Eukaryota.Metagenomic data Saanich Inlet generated biomass larger Eukaryotic cells physically removed prior sequencing. Therefore, organisms need present reference packages. can remove sequences Eukaryotic origin using either “--screen” “--filter” arguments. example, include Bacteria Archaea use --screen Bacteria,Archaea --filter Eukaryota.“--min_taxonomic_rank” argument specifies minimum taxonomic rank sequence’s taxonomic lineage must resolved . example, using --min_taxonomic_rank g ensure sequences reference package annotated genus, species strain taxonomic rank. specify others ranks , use lowercase first letter taxonomic rank.\nreference package still large using options, setting argument highly resolved taxonomic rank can potent way remove candidate reference sequences.“--min_taxonomic_rank” argument specifies minimum taxonomic rank sequence’s taxonomic lineage must resolved . example, using --min_taxonomic_rank g ensure sequences reference package annotated genus, species strain taxonomic rank. specify others ranks , use lowercase first letter taxonomic rank.\nreference package still large using options, setting argument highly resolved taxonomic rank can potent way remove candidate reference sequences.bring arguments together example command:","code":"treesapp create\n  --fast \\\n  --headless \\\n  --overwrite \\\n  --cluster \\\n  --trim_align \\\n  -n 4 \\\n  -m prot \\\n  --similarity 0.90 \\\n  --screen Bacteria,Archaea \\\n  --min_taxonomic_rank g \\\n  --profile arCOG08676_hmm.txt \\\n  --fastx_input XmoA_seed.faa \\\n  -c XmoA \\\n  --output XmoA_seed"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","text":"","code":""},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"introduction-and-goals-2","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.1 Introduction and goals","text":"using new particulate methane monooxygenase (pMMO) ammonia monooxygenase (AMO) alpha subunit, XmoA, reference package update XmoA amino acid sequences sourced FunGene. already created reference package (Creating Reference Package TreeSAPP) downloaded sequences (Acquiring golden data).three goals tutorial:Learn update TreeSAPP reference package treesapp update.Learn use treesapp colour colour phylogeny iTOL.Learn annotate features phylogenetic clades using treesapp layer.first step involves using treesapp assign classify FunGene XmoA sequences. second step use treesapp update add new sequences original XmoA reference package.","code":""},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"change-notes","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.2 Change notes","text":"TreeSAPP version 0.10.4, treesapp update longer automatically retrains reference package. Therefore, doesn’t require FASTA file commands updated reflect change. save significant amount time!","code":""},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classify-new-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.3 Classify new sequences","text":"can begin using TreeSAPP, must log onto server make sure ’re directory data.According treesapp purity last chapter, sanity checks, XmoA reference package (contained working directory, /data/ts_tutorial, XmoA_seed/final_outputs/XmoA_build.pkl) looks functional contains XmoA sequences. point, ’re able use reference package classify sequences dataset using treesapp assign.command treesapp assign perhaps popular command described detail TreeSAPP wiki.commands use Block Mapping Gathering Entropy (BMGE) filters regions questionable homology alignment (6). Please see BMGE publication information. trim multiple sequence alignments prior phylogenetic placement use --trim_align flag.\nuse PmoA AmoA reference package ’ve built instead reference packages come TreeSAPP can use argument --refpkg_dir path directory containing reference packages want use.usual, ’re unclear arguments , can use treesapp assign -h get complete usage descriptions argument.","code":"cd /data/ts_tutorial/"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classifying-amino-acid-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.3.1 Classifying amino acid sequences","text":"’re first going classify PmoA AmoA sequences sourced FunGene. sequences genomes isolated bacteria archaea , FunGene’s quality annotation pipeline, can likely trusted. Environmental sequences (.e. metagenomes amplicon studies) excluded ’re difficult determine organism ’re , taxonomic labels less trustworthy.command take seconds run see ‘TreeSAPP finished successfully.’ end ’re good move .","code":"treesapp assign \\\n  -n 4 \\\n  -m prot \\\n  --trim_align \\\n  --refpkg_dir XmoA_seed/final_outputs/ \\\n  --fastx_input p_amoA_FunGene9.5_isolates_C65S300_uclust99.faa \\\n  --output p_amoA_FunGene9.5_isolates_assign/"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"classifying-orfs-predicted-from-genomes","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.3.2 Classifying ORFs predicted from genomes","text":"second batch sequences classify XmoA metagenome-assembled genomes (MAGs). MAGs derived assembled metagenome datasets (.e. contigs scaffolds) represent genome closely related microbial population. can think representing single strain present microbial community.need download two files: FASTA file containing genomes table taxonomic label genome.first file created concatenating twelve different MAGs single file prepending sequence name (.e. header) MAG name using software seqkit. Concatenating multiple genomes single file saves time since need run treesapp assign instead classifying MAG individually. Prepending header respective MAG name necessary properly map names query sequences back original genome names update process. shell command used (run):treesapp assign command use similar ’ve used past. main difference need include -m prot TreeSAPP assumes input comprised nucleotide sequences default.command take less minute complete.","code":"wget https://raw.githubusercontent.com/EDUCE-UBC/MICB425/main/data/SI072_MAGs.fa ./\nwget https://raw.githubusercontent.com/EDUCE-UBC/MICB425/main/data/SI072_MAGs_gtdbtk.bac120.summary.tsv ./for f in *fa\ndo\n  mag_name=$( basename $f | sed 's/.fa//g' )\n  cat $f | seqkit replace -p \"^\" -r \"${mag_name}_\" >>SI072_MAGs.fa\ndonetreesapp assign \\\n  -n 4 \\\n  --trim_align \\\n  --refpkg_dir XmoA_seed/final_outputs/ \\\n  --fastx_input SI072_MAGs.fa \\\n  --output SI072_MAGs_assign/"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"update-the-reference-package-with-new-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.4 Update the reference package with new sequences","text":"initial XmoA_seed reference package pretty small just 36 sequences (information retrieved using treesapp package view num_seqs -r XmoA_seed/final_outputs/XmoA_build.pkl). Also, bacterial sequences included version know archaeal ammonia oxidizers . Let’s see can expand seed reference package using sequences FunGene.","code":""},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"updating-with-publicly-available-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.4.1 Updating with publicly available sequences","text":"already seen many flags arguments , ’re used just remind TreeSAPP want results fast. couple new ones used, though. treesapp update won’t take just old FASTA file relies outputs produced treesapp assign. ’ll guide relevant output directory --treesapp_output p_amoA_FunGene9.5_isolates_assign/. , figure sequences classified assigned lineages .default TreeSAPP use lineage assigned classified query sequence treesapp assign outputs. Since sequences FunGene (originally GenBank) NCBI accessions, meaning can use information download true taxonomic lineages. turn behaviour use --skip_assign flag.\nLastly, must give path reference package update --refpkg_path XmoA_seed/final_outputs/XmoA_build.pkl.NOTE: --fastx_input XmoA_seed.faa removed treesapp update commands TreeSAPP 0.10.4 installed server. See details.looks like 28 new sequences introduced reference package, bringing total 63 sequences! judging taxonomic rank summary printed runtime Archaea Bacteria now included:","code":"treesapp update \\\n  --fast \\\n  --headless \\\n  --overwrite \\\n  --delete \\\n  --cluster \\\n  --trim_align \\\n  -n 4 \\\n  -m prot \\\n  --output XmoA_FunGene_update/ \\\n  --skip_assign \\\n  --treesapp_output p_amoA_FunGene9.5_isolates_assign/ \\\n  --refpkg_path XmoA_seed/final_outputs/XmoA_build.pklNumber of unique lineages:\n    root       1\n    domain     2\n    phylum     5\n    class      6\n    order     10\n    family    13\n    genus     25\n    species   38"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"updating-with-mag-sequences","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.4.2 Updating with MAG sequences","text":"now going update reference package just updated using MAG sequences demonstrate iteratively update reference packages. key difference using sequences accessioned NCBI must provide taxonomic labels MAG. MAGs assigned taxonomic labels using Genome Taxonomy Database toolkit (GTDB-tk)(7).first need reformat table containing taxonomic labels MAGs. employ shell functions awk sed pull two columns need find--replace words characters.Now everything need can proceed run treesapp update add MAG sequences reference package.One XmoA sequences MAGs added reference package bringing total 64 reference sequences.summary reference package printed screen treesapp update completed properly, look like :supplementary reading integrate sequences SAGs MAGs reference packages please visit TreeSAPP Wiki.Just finish , let’s map PmoA AmoA sequences FunGene onto MAG-updated reference package treesapp assign view later.","code":"awk -F\"\\t\" '{ OFS=\"\\t\"; print $1,$2 }' SI072_MAGs_gtdbtk.bac120.summary.tsv | \\\nsed 's/user_genome/Organism/g' | \\\nsed 's/classification/Lineage/g' | \\\nsed 's/;/; /g' >gtdb_classifications.tsvtreesapp update \\\n  --fast \\\n  --headless \\\n  --overwrite \\\n  --delete \\\n  --cluster \\\n  --trim_align \\\n  -n 4 \\\n  -m prot \\\n  --output XmoA_MAG_update/ \\\n  --skip_assign \\\n  --seqs2lineage gtdb_classifications.tsv \\\n  --treesapp_output SI072_MAGs_assign/ \\\n  --refpkg_path XmoA_FunGene_update/final_outputs/XmoA_build.pklSummary of the updated reference package:\nReferencePackage instance of XmoA (N0102):\n    Molecule type:                                      'prot'\n    TreeSAPP version:                                   '0.10.1'\n    Profile HMM length:                                 '247'\n    Substitution model used for phylogenetic inference: 'LG+G4'\n    Number of reference sequences (leaf nodes):          64\n    Software used to infer phylogeny:                   'FastTree'\n    Date of last update:                                '2021-03-22'\n    Description:                                        'Alpha subunits of copper membrane monooxygenase enzymes'treesapp assign \\\n  -n 4 \\\n  -m prot \\\n  --trim_align \\\n  --refpkg_dir XmoA_MAG_update/final_outputs/ \\\n  --fastx_input p_amoA_FunGene9.5_isolates_C65S300_uclust99.faa \\\n  --output p_amoA_FunGene9.5_isolates_update_assign/"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"annotate-clades","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.5 Annotate clades","text":"Protein families vary evolutionary complexity; many, especially genes involved scavenging metabolizing nutrients, often involved gene duplication /lateral gene transfer event others remained anchored host. Moreover, closely related enzymes can vary activities often valuable, though necessary, annotate features.Creating annotations involves scouring literature identify phenotypes associated organism taxon. example, need determine paralogs substrates used organism reference package. Often though, phenotypes conserved across larger taxonomic groups, whole genera, families, orders, etc.\nfamiliar evolution protein family may helpful find reference sequences activity, function, feature ’re interested place tree treesapp assign. , guided sequences, easier annotate clades.\nSeeing literature review can’t accomplished within time span tutorial, can use annotations already created XmoA reference package.can view contents file Unix command less:create file compatible iTOL need convert taxonomy-phenotype mapping file treesapp colour.two output files—XmoA_Function_colours_style.txt XmoA_Function_colour_strip.txt—can used bring colour JPlace file iTOL also used adding phenotype-level annotations classification table treesapp layer. Let’s make copies two text files XmoA_colours/ AmoA_assign/iTOL output directory transfer <path Xmoa_sequences>.computer: Transfer XmoA_seed_assign/iTOL_output server local directory Xmoa_sequences.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Navigate https://itol.embl.de/ using web browser sign using group’s username password.Upload file XmoA_complete_profile.jplace. can using either computer’s file browser navigating iTOL_output directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.Upload file XmoA_complete_profile.jplace. can using either computer’s file browser navigating iTOL_output directory clicking--dragging file, iTOL’s file uploader—“Upload tree files” button.Next, navigate page displaying phylogeny click--drag file XmoA_labels.txt file browser iTOL window. convert TreeSAPP identifiers (e.g. 1_XmoA) useful descriptions organism name accession leaf node.Next, navigate page displaying phylogeny click--drag file XmoA_labels.txt file browser iTOL window. convert TreeSAPP identifiers (e.g. 1_XmoA) useful descriptions organism name accession leaf node.two files XmoA_Function_colours_style.txt XmoA_Function_colour_strip.txt can dragged iTOL browser window bring colour XmoA tree. figure look identical Figure 5.1The two files XmoA_Function_colours_style.txt XmoA_Function_colour_strip.txt can dragged iTOL browser window bring colour XmoA tree. figure look identical Figure 5.1FIGURE 5.1: XmoA phylogeny functional annotationFinally, turn “Phylogenetic Placements” dataset (right screen).","code":"wget https://raw.githubusercontent.com/hallamlab/RefPkgs/master/Nitrogen_metabolism/Nitrification/XmoA/XmoA_taxonomy-phenotype_map.tsvless XmoA_taxonomy-phenotype_map.tsvd__Archaea  AmoA_AOA\nMethylococcaceae    EmoA\ng__Haliea   EmoA\nf__Nitrosomonadaceae    AmoA_AOB\no__Chromatiales AmoA_AOB\ng__Methylobacter    PmoA\ng__Methylacidiphilum    PmoAtreesapp colour \\\n  -r XmoA_MAG_update/final_outputs/XmoA_build.pkl \\\n  -o XmoA_colours/ \\\n  -n Function \\\n  --taxa_map XmoA_taxonomy-phenotype_map.tsvcp -r XmoA_colours p_amoA_FunGene9.5_isolates_update_assign/iTOL_output/scp -r root@<server address>:/data/ts_tutorial/p_amoA_FunGene9.5_isolates_update_assign/iTOL_output <path to Xmoa_sequences>"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"reclassify-and-layer-annotations-onto-classification-table","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.6 Reclassify and layer annotations onto classification table","text":"clade colours file tutorial directory, now simple assign classified query sequences respective functional guild treesapp layer.output command p_amoA_FunGene9.5_isolates_update_assign/final_outputs/extra_annotated_marker_contig_map.tsv. contains extra column functional annotations otherwise identical original marker_contig_map.tsv file. can view first 10 lines using Unix command head:","code":"treesapp layer \\\n  --colours_style XmoA_colours/XmoA_Function_colours_style.txt \\\n  --refpkg_dir XmoA_MAG_update/final_outputs/ \\\n  --treesapp_output p_amoA_FunGene9.5_isolates_update_assign/head p_amoA_FunGene9.5_isolates_update_assign/final_outputs/extra_annotated_marker_contig_map.tsv"},{"path":"classifying-unknown-sequences-with-treesapp-and-updating-a-reference-package.html","id":"use-your-groups-reference-package-to-classify-unkown-sequences-then-update-your-package","chapter":"5 Classifying unknown sequences with TreeSAPP and updating a reference package","heading":"5.7 Use your group’s reference package to classify unkown sequences then update your package","text":"Continue work group’s reference package directory /data/<gene name>. Visualize appropriate outputs iTOL.","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"calculating-relative-abundance-of-metaomic-data","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6 Calculating relative abundance of meta’omic data","text":"","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"introduction-and-goals-3","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.1 Introduction and goals","text":"Genome assemblies contain less information sequence reads recovering always possible.\nshotgun DNA sequencing technique samples subsequences genomes comprise microbial community. Sequencing bias, present, subtle enough can assume subsequence’s frequency reads approximates abundance underlying community. Whenever (meta)genome assembled reads, however, sequences tricky assemble (due repetitive motifs low coverage) removed abundance information effectively lost.\nOne way recover read-level abundances aligning reads back contigs calculating number reads mapped . One can go step still use relative abundance normalization measures popular transcriptomics, fragments per kilobase per million mappable reads (FPKM) transcripts per million (TPM) (8).TreeSAPP’s subcommand abundance capable calculating FPKM TPM classified query sequences. can derived reads FASTQ files multiple different samples. possible input fasta nucleotide sequences ORFs predicted within pipeline (.e. thisn’t possible amino acid sequences).goal tutorial show use treesapp abundance calculate TPM metagenome-derived ORF sequences.","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"workflow-description","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.2 Workflow description","text":"workflow employed TreeSAPP common many bioinformatics pipelines:Collect nucleotide sequences classified ORFs.BWA (9) creates index nucleotide sequences - reference database.Align short reads reference database BWA MEM.Calculate relative abundance metrics. TreeSAPP uses samsum.potentially two common use cases treesapp abundance.treesapp assign single sample’s read data mapped corresponding assembly (.e. contigs scaffolds) relative abundances sequences obtained.combined assembly generated multiple samples, classified treesapp assign, reads sample mapped individually generate sample-specific relative abundance values treesapp abundance.","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"usage","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.3 Usage","text":"two required arguments treesapp abundance:treesapp_output: Path output directory treesapp assign.reads: Path FASTQ file containing single-end reads, foward mates interleaved reads paired-end sequencing library.descriptions important options:reverse: Path FASTQ file containing reverse mates paired-end sequencing library.report: argument controls treesapp abundance resulting abundance values. ‘nothing’ option applicable Python API, used treesapp assign simply return abundance object instances. ‘update’ can used abundance values classification table replaced newly calculated values. ‘append’ used reads new samples used calculate abundance (e.g. reads time-course experiment).metric: Either Fragments per Kilobase per Mllion mappable reads (FPKM) Transcripts per Million (TPM).","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"outputs","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.4 Outputs","text":"sole output treesapp abundance edited classification table, previously generated treesapp assign. new files generated, beyond intermediate files (e.g. SAM files). values ‘Abundance’ field final_outputs/marker_contig_map.tsv.","code":""},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"tutorial-steps","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.5 Tutorial steps","text":"Connect group’s server, move directory /data/ts_tutorial.tutorial requires many fastq fasta formatted files, subsetted versions originals. created searching metagenome assemblies reads XmoA pulling sequences matched new files. going save new directory keep ts_tutorial organized.Create new directory called SI072_data download data .can move back /data/ts_tutorial/ directory run TreeSAPP commands.begin classifying XmoA sequences found metagenome contigs. Since nucleotide sequences representing random stretches DNA microbial community, treesapp assign begin predicting open reading frames (ORFs) . TreeSAPP classify amino acid sequences predicted ORFs. XmoA sequences classified ORFs can begin generate relative abundance values XmoA sequences.Assign taxonomic labels Saanich Inlet metagenomic contigs using updated XmoA reference package treesapp assign.Now ’ll need access processed data generated treesapp assign SI072_MetaG_contigs_XmoA_assign/. treesapp abundance access ORFs SI072_MetaG_contigs_XmoA_assign/intermediates/orf-call/SI072_MetaG_contigs_ORFs.fna pass bwa mem sequence alignment. Due , flag ‘--delete’ used treesapp assign want eventually run treesapp abundance intermediates directory removed.begin calculating TPM metagenome reads.\nreads using calculate values paired-end meaning two reads represent sequenced DNA fragment. two reads, case metagenomic data, split across two files: one reads sequenced forward direction another reads sequenced reverse. extensions ‘.1.fq.gz’ ‘.2.fq.gz’, respectively. Therefore, must use parameters ‘--reads’ ‘--reverse’ point TreeSAPP towards files. ’ll notice didn’t list seven files , either; used wildcard character (asterisk). forward reads, shell interpret files within SI072_data directory begin ‘SI072_’ end ‘m_pe.1.fq.gz’. can test expansion using ls command.like replace current abundance values treesapp assign (set 1) new TPM values, set ‘--report’ parameter ‘update’.\nFinally, can specify want TPM values --metric tpm. Although, ‘tpm’ default isn’t necessary.Run treesapp abundance overwrite previous abundance values TPM values calculated seven SI072 datasets.Now ’re going generate TPM values seven matching metatranscriptome datasets. notice format FASTQ files different metagenomes. reads sample contained single file, referred interleaved FASTQ format.\nSince file reverse reads can just use ‘--reads’ parameter.\nAnother key difference ’re setting ‘--report’ parameter ‘append’. don’t want overwrite TPM values just generated metagenomes. Instead, want new metatranscriptome values added SI072_MetaG_contigs_XmoA_assign/final_outputs/marker_contig_map.tsv, end classification table hold TPM values metagenomes metatranscriptomes.Use treesapp abundance calculate TPM values seven metatranscriptomes.next tutorial cover visualizing TreeSAPP classifications. also want functional annotations generated last tutorial.Run treesapp layer annotate XmoA query sequences respective paralog.’s ! ’re now seasoned veteran TreeSAPP.","code":"cd /data/ts_tutorial/mkdir SI072_data\ncd SI072_data\nwget https://raw.githubusercontent.com/EDUCE-UBC/MICB425/main/data/SI072_abundance_files.txt\nwget -i SI072_abundance_files.txtcd ..treesapp assign \\\n  -n 4 \\\n  --trim_align \\\n  --refpkg_dir XmoA_MAG_update/final_outputs/ \\\n  --fastx_input SI072_data/SI072_MetaG_contigs.fasta \\\n  --output SI072_MetaG_contigs_XmoA_assign/ls SI072_data/SI072_*m_pe.1.fq.gztreesapp abundance \\\n  -n 4 \\\n  --treesapp_output SI072_MetaG_contigs_XmoA_assign/ \\\n  --reads SI072_data/SI072_*m_pe.1.fq.gz \\\n  --reverse SI072_data/SI072_*m_pe.2.fq.gz \\\n  --report update \\\n  --metric tpmtreesapp abundance \\\n -n 4 \\\n --treesapp_output SI072_MetaG_contigs_XmoA_assign/ \\\n --reads SI072_data/SI072_*m_MetaT_QC_Filtered.fq.gz \\\n --pairing pe \\\n --metric tpm \\\n --report appendtreesapp layer \\\n -o SI072_MetaG_contigs_XmoA_assign/ \\\n --refpkg_dir XmoA_MAG_update/final_outputs/ \\\n -c XmoA_colours/XmoA_Function_colours_style.txt"},{"path":"calculating-relative-abundance-of-metaomic-data.html","id":"use-your-groups-reference-package-to-calculate-abundances","chapter":"6 Calculating relative abundance of meta’omic data","heading":"6.6 Use your group’s reference package to calculate abundances","text":"Continue work group’s reference package directory /data/<gene name>. Visualize appropriate outputs iTOL.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analysing-the-treesapp-classifications-in-r","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7 Analysing the TreeSAPP classifications in R","text":"","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"introduction-and-goals-4","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.1 Introduction and goals","text":"instructions help complete script template treesapp_analysis.R complete initial analysis TreeSAPP classifications.\nfollowing code chunks show load, aggregate, subset transform continuous discrete variables R using tidyverse.\nalso provided examples plotting TreeSAPP classification data using ggplot2 library.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"resources-for-analysis-of-treesapp-output-in-r","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.2 Resources for analysis of TreeSAPP output in R","text":"TreeSAPP output file extra_annotated_marker_contig_map.tsv metagenome metatranscriptome abundances gene functions generated TreeSAPP. unable retrieve file, can downloaded .R script template called treesapp_analysis.R Canvas.Saanich_TimeSeries_Chemical_DATA.csv file containing geochemical measurements Canvas.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"checklist-to-write-and-run-r-script","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.3 Checklist to write and run R script","text":"\nPlace treesapp_analysis.R, extra_annotated_marker_contig_map.tsv Saanich_TimeSeries_Chemical_DATA.csv files single folder create new RStudio project folder local computer.\nEdit treesapp_analysis.R script following instructions .","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"writing-the-r-script","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.4 Writing the R script","text":"treesapp_analysis.R script load subset TreeSAPP data variables marker genes interest. break one taxonomic information column multiple taxonomic ranks. also load Saanich_TimeSeries_Chemical_DATA.csv file geochemical measurements learn conditions assigned depth.\nFinally, visualize taxonomic, functional chemical data using ggplot2 library.complete , replace instances test angle brackets, like <TEXT>, code section.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"load-any-required-packages","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.5 Load any required packages","text":"","code":"\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"load-metagenomic-and-metatranscriptomic-treesapp-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.6 Load metagenomic and metatranscriptomic TreeSAPP data","text":"","code":"\nts_dat <- read.table(file=\"extra_annotated_marker_contig_map.tsv\",\n                     header=TRUE,\n                     sep=\"\\t\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"classification-table","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.6.1 Classification table","text":"Let’s look TreeSAPP’s classification table FunGene XmoA sequences. RStudio, able click variable name “Environment” tab top-right panel. Optionally, can use View function R-console view object. example, run View(ts_dat).description fields can found treesapp assign documentation page.","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"subset-your-data-to-the-variables-and-marker-genes-of-interest","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.7 Subset your data to the variables and marker genes of interest","text":"Determine variables marker genes need subset data . “Marker” data XmoA, filter XmoA.working real data may analyzing multiple reference package’s worth data. want subset data couple reference packages find ‘%%’ operator handy. following example keeping data Marker variable equal “XmoA”, “PmoA” “AmoA”. reality, match “XmoA”.","code":"\nts_df <- ts_dat %>%\n  filter(Marker == \"XmoA\")\nts_df <- ts_df %>%\n  filter(Marker %in% c(\"XmoA\", \"PmoA\", \"AmoA\"))"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"reformat-variables","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8 Reformat variables","text":"","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"processing-taxonomic-information","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8.1 Processing taxonomic information","text":"taxonomic information contains information highest lowest available rank. Look rows containing taxonomic information determine separator rank. can use function tidyverse called separate allows split character object separators. result, initial single taxonomic variable split multiple new variables, one rank. Use R object taxa_ranks assign names new variables.","code":"\ntaxa_ranks <- c(\"Root\", \"Domain\", \"Phylum\", \"Class\",\n                \"Order\", \"Family\", \"Genus\", \"Species\")\nts_df <- ts_df %>%\n  separate(col = Taxonomy,\n           into = taxa_ranks,\n           sep = \"; \", fill = \"right\", remove = T)"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"distinguishing-metagenomes-from-metatranscriptomes","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8.2 Distinguishing metagenomes from metatranscriptomes","text":"","code":"\nts_df <- ts_df %>% \n  mutate(Sample = gsub(\"_pe\", \"_MetaG\", Sample)) %>% \n  separate(col = Sample,\n           into = c(\"Cruise\", \"Depth\", \"SeqType\"),\n           extra = \"drop\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"processing-depth-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.8.3 Processing depth data","text":"Modify data frame split sample name “Cruise” “Depth” variables. , remove ‘m’ character “Depth” variable create numeric variable called “Depth.m”.","code":"\nts_df <- ts_df %>%\n  mutate(Depth.m = as.numeric(gsub('m', '', Depth))) %>% \n  mutate(Cruise = as.numeric(gsub('SI0', '', Cruise)))"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"load-the-geochemical-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.9 Load the geochemical data","text":"Geochemical data Saanich Inlet time series another file called Saanich_TimeSeries_Chemical_DATA.csv. first load data frame called geochem_df, subset just samples interested .going use function left_join dplyr library merge geochemical data cruise 72 TreeSAPP classifications XmoA Sample. combined data saved new data frame called ts_geo_df.","code":"\ngeochem_df <- read.table(\"Saanich_TimeSeries_Chemical_DATA.csv\",\n                          header=TRUE, sep=',') %>% \n  filter(Cruise == 72) %>% \n  select(Cruise, Depth,\n         CTD_O2, NO3,\n         Mean_NH4, Mean_NO2, Mean_H2S, Mean_CH4) %>% \n  mutate(Mean_CH4 = Mean_CH4*1E-3) %>% \n  mutate(across(.fns=as.numeric))\nts_geo_df <- left_join(ts_df,\n                       geochem_df,\n                       by=c(\"Cruise\",\n                            \"Depth.m\" = \"Depth\"))"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"visualize-the-taxonomic-functional-and-chemical-data-from-saanich-inlet","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10 Visualize the taxonomic, functional and chemical data from Saanich Inlet","text":"","code":""},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyze-treesapps-taxonomic-classifications","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.1 Analyze TreeSAPP’s taxonomic classifications","text":"’re going begin making line plot show distribution abundances taxonomic orders different depths. taxa shown XmoA gene organisms Saanich Inlet!\ncreate new variable called Sum sums Abundance (TPM values) taxonomic order depth. Without group_by() function, return single value since ’re grouping Depth Order, sum yields value taxon depth.plot gives us idea absolute TPM values, taxon’s share total abundance depth? answer create stacked barplot show relative change proportions different depths.\nInstead creating variable hold taxon’s total TPM create new variable store proportion TPM called Proportion. easily changed percentage multiplying 100.ts_geo_df dataframe two variables storing sample depth: one numeric type character type. plotting character type depth (Depth) x-axis default R’s alphabetical ordering makes ‘100m’ precede ‘10m’. reorder function used ensure depth sorted numerically ordering Depth (character type) Depth.m (numeric type).Additionally, faceting plot sequence type: ‘MetaG’ (metagenome) ‘MetaT’ (metatranscriptome).","code":"\nts_geo_df %>%\n  filter(SeqType == \"MetaG\") %>% \n  group_by(Depth.m, Order) %>%\n  summarise(Sum = sum(Abundance)) %>%\n  ungroup() %>%\n  ggplot(aes(x=Depth.m, y=Sum, colour=Order)) +\n  geom_line() +\n  coord_flip() +\n  scale_x_reverse() +\n  labs(x=\"Depth (m)\",\n       y=\"Relative abundance (TPM)\")\n\nggsave(\"taxonomic_order_lineplot.png\")\nts_geo_df %>% \n  group_by(Depth, Depth.m, SeqType) %>% \n  mutate(Proportion = Abundance/sum(Abundance)) %>% \n  group_by(Depth, Depth.m, Order, SeqType) %>% \n  summarise(sum = sum(Proportion)) %>% \n  ungroup() %>% \n  mutate(Depth = reorder(Depth, Depth.m)) %>% \n  ggplot(aes(x=Depth, y=sum, fill=Order)) +\n  geom_bar(stat = \"identity\") +\n  facet_wrap(~SeqType) +\n  labs(x=\"Depth\",\n       y=\"Relative abundance\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggsave(\"taxonomic_order_barplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyze-the-functional-data","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.2 Analyze the functional data","text":"following figure instead going visualize abundance classified XmoA’s Function across water column.\ngoing use bubble-plot figure bubbles depth-order intersection scaled TPM value (Abundance). colouring bubbles according assigned Function.\nfaceting plot sequence type.Can see discrepancies metagenome metatranscriptome abundances?","code":"\nts_geo_df %>% \n  group_by(Depth, Depth.m, SeqType, Order, Function) %>% \n  summarise(Sum = sum(Abundance)) %>% \n  ungroup() %>%\n  mutate(Depth = reorder(Depth, desc(Depth.m))) %>% \n  ggplot(aes(x=Depth, y=Order, colour=Function)) +\n  geom_point(aes(size=Sum)) +\n  facet_wrap(~SeqType) +\n  coord_flip() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggsave(\"functional_bubbleplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyze-the-chemical-measurements","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.3 Analyze the chemical measurements","text":"following plot visualizing chemical profiles depth. exhaustive include molecules ’re interested .generate plot, ’ve perform common data manipulation technique called pivoting. Essentially, instead separate variable chemical measurements, combined two columns: one name molecule (previously variable name) another value.Notice x-axis scales differ. enabled scales = \"free_x\" function facet_wrap essential observe trends across water column. Without many values squished y-axis values close zero oxygen concentration gets ~200 micromolar.","code":"\nts_geo_df %>% \n  pivot_longer(cols=c(starts_with(\"Mean\"), NO3, CTD_O2),\n               values_to = \"Value.uM\",\n               names_to = \"Molecule\") %>%\n  ggplot(aes(x=Depth.m, y=Value.uM)) +\n  geom_point() +\n  geom_line() +\n  facet_wrap(~Molecule, scales = \"free_x\") +\n  coord_flip() +\n  scale_x_reverse()\n\nggsave(\"geochemical_lineplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"bringing-them-all-together","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.10.4 Bringing them all together","text":"final figure going combine methane concentration data TPM values two orders, Methylococcales Nitrosomonadales.abundance two groups change methane concentration?","code":"\nts_geo_df %>%\n  filter(SeqType==\"MetaT\") %>%\n  filter(!is.na(Order)) %>% \n  mutate(Depth = reorder(Depth, Depth.m)) %>% \n  ggplot(aes(x=Depth, y=Abundance, colour=Mean_CH4)) +\n  geom_boxplot() +\n  geom_point() +\n  facet_wrap(~Order) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\nggsave(\"taxonomic_order_boxplot.png\")"},{"path":"analysing-the-treesapp-classifications-in-r.html","id":"analyzing-classifications-for-your-groups-reference-package","chapter":"7 Analysing the TreeSAPP classifications in R","heading":"7.11 Analyzing classifications for your group’s reference package","text":"abundance gene vary depth? trends similar RNA DNA?abundance gene vary depth? trends similar RNA DNA?microbial diversity vary depth? trends similar RNA DNA?\nneed make decision taxonomic rank calculate diversity. might able use lowest possible? taxonomic rank high?microbial diversity vary depth? trends similar RNA DNA?\nneed make decision taxonomic rank calculate diversity. might able use lowest possible? taxonomic rank high?abundance gene relate water column geochemistry Saanich Inlet (use chemical measurement data Saanich_TimeSeries_Chemical_DATA.csv)?abundance gene relate water column geochemistry Saanich Inlet (use chemical measurement data Saanich_TimeSeries_Chemical_DATA.csv)?Determine geochemical conditions given depths. best available terminal electron acceptor?Determine geochemical conditions given depths. best available terminal electron acceptor?","code":""},{"path":"project-description.html","id":"project-description","chapter":"8 Project description","heading":"8 Project description","text":"project, work groups conduct gene-centric mapping functional phylogenetic anchors encoded microbial genomes sourced Saanich Inlet water column. Saanich Inlet seasonally anoxic fjord coast Vancouver Island British Columbia serves model ecosystem studying microbial community responses ocean deoxygenation.Numerous studies Saanich Inlet years identified key microbial players mediating coupled biogeochemical cycling carbon, nitrogen sulfur extensible expanding marine oxygen minimum zones throughout global ocean. , use metagenomic metatranscriptomic data sets generated Cruise 72 spanning 7 depths Saanich Inlet. addition fastq reads, metagenomic data sets include assembled contigs, metagenome assembled genomes (MAGs) single-cell amplified genomes (SAGs) spanning genomic information hierarchy.Cruise 72 metagenomic metatranscriptomic data sets can evaluated relation geochemical parameter information better resolve metabolic potential gene expression patterns microbial communities inhabiting Saanich Inlet water column. capstone project group opportunity use TreeSAPP iToL chart abundance, expression taxonomic diversity functional phylogenetic anchor genes represented current reference package collection. Groups can augment collection new reference packages produced TreeSAPP tutorial time project phase depending research interests. Reference packages can also updated using taxonomic information associated MAGs SAGs described .underlying conceptual framework project described three lectures associated course Module 2 along examples data visualization approaches useful developing coherent scientific narrative. given gene encoding biochemical transformation consider extent functionality distributed within community represented different levels biological information flow e.g. DNA versus RNA.","code":""},{"path":"project-description.html","id":"guiding-research-questions","chapter":"8 Project description","heading":"8.1 Guiding research questions","text":"Several options provided help develop capstone project, although group free come original plan action. Please consult teaching team questions.Select reference package(s) analysis based one following options:\nChoose one pathways geochemical cycle e.g. nitrogen reference packages already available TreeSAPP (see table available TreeSAPP reference packages). example, select NapA, NirK, NirS, NorB, NorC NosZ investigate denitrification Saanich Inlet water column.\nCreate new reference packages expand TreeSAPP collection analyze results. select pthway within biogeocehmical cycle reference packages available covering complete pathway e.g. sulfur cycle including sulfur oxidation DMSP conversion, completely new pathway reference packages avaialble.\nSelect reference packages collection including developed class treesapp create tutorial map results. Focus evaluating purity reference package update needed reflect diversity genes endemic Saanich Inlet water column.\nSelect reference package(s) analysis based one following options:Choose one pathways geochemical cycle e.g. nitrogen reference packages already available TreeSAPP (see table available TreeSAPP reference packages). example, select NapA, NirK, NirS, NorB, NorC NosZ investigate denitrification Saanich Inlet water column.Choose one pathways geochemical cycle e.g. nitrogen reference packages already available TreeSAPP (see table available TreeSAPP reference packages). example, select NapA, NirK, NirS, NorB, NorC NosZ investigate denitrification Saanich Inlet water column.Create new reference packages expand TreeSAPP collection analyze results. select pthway within biogeocehmical cycle reference packages available covering complete pathway e.g. sulfur cycle including sulfur oxidation DMSP conversion, completely new pathway reference packages avaialble.Create new reference packages expand TreeSAPP collection analyze results. select pthway within biogeocehmical cycle reference packages available covering complete pathway e.g. sulfur cycle including sulfur oxidation DMSP conversion, completely new pathway reference packages avaialble.Select reference packages collection including developed class treesapp create tutorial map results. Focus evaluating purity reference package update needed reflect diversity genes endemic Saanich Inlet water column.Select reference packages collection including developed class treesapp create tutorial map results. Focus evaluating purity reference package update needed reflect diversity genes endemic Saanich Inlet water column.Perform preliminary analysis using Saanich Inlet data depths.Perform preliminary analysis using Saanich Inlet data depths.Update reference packages needed based preliminary analysis.Update reference packages needed based preliminary analysis.Look patterns gene abundance, expression diversity function water column geochemical parameter information.Look patterns gene abundance, expression diversity function water column geochemical parameter information.","code":""},{"path":"project-description.html","id":"questions-for-project-with-a-focus-on-biogeochemical-cycles-repeated-in-report-structure-below","chapter":"8 Project description","heading":"8.1.1 Questions for project with a focus on biogeochemical cycles (repeated in report structure below)","text":"gene transcript abundance vary across depths reference package given biogeochemical cycle?gene transcript abundance vary across depths reference package given biogeochemical cycle?microbial diversity differ among steps within pathway e.g. denitrification? trends similar genes transcripts different depths?microbial diversity differ among steps within pathway e.g. denitrification? trends similar genes transcripts different depths?taxonomic breakdown genes transcripts within given biogeochemcial cycle? Can discern evidence horizontal gene transfer one functional anchor genes?taxonomic breakdown genes transcripts within given biogeochemcial cycle? Can discern evidence horizontal gene transfer one functional anchor genes?Can identify evidence distributed metabolism within one pathways? trends similar genes transcripts different depths?Can identify evidence distributed metabolism within one pathways? trends similar genes transcripts different depths?answers questions 2 3 vary depending taxonomic rank used analysis?answers questions 2 3 vary depending taxonomic rank used analysis?abundance, expression taxonomy identified genes relate water column geochemical parameter information (use geochemical data Saanich_Data.csv previous data science sessions)?abundance, expression taxonomy identified genes relate water column geochemical parameter information (use geochemical data Saanich_Data.csv previous data science sessions)?","code":""},{"path":"project-description.html","id":"questions-for-project-with-a-focus-on-using-all-reference-packages","chapter":"8 Project description","heading":"8.1.2 Questions for project with a focus on using all reference packages","text":"addition questions provided biogeochemical cycles consider quality control metrics analysis.purity reference package impact results?purity reference package impact results?much information discarded due insufficient taxonomic resolution?much information discarded due insufficient taxonomic resolution?much information retained updating reference packages MAGs SAGs?much information retained updating reference packages MAGs SAGs?impact diversity metrics following use updated reference packages?impact diversity metrics following use updated reference packages?","code":""},{"path":"project-description.html","id":"resources","chapter":"8 Project description","heading":"8.2 Resources","text":"provided script template shell R portion analysis (treesapp_analysis.sh treesapp_analysis.R) guide develop code.stated project description, access metagenomic metatranscriptomic data sets generated Cruise 72 spanning 7 depths Saanich Inlet, MAGs SAGs.","code":""},{"path":"project-description.html","id":"your-submission","chapter":"8 Project description","heading":"8.3 Your submission","text":"final submission consist 3 separate files: report (docx pdf), one shell script treesapp_analysis.sh, one R script treesapp_analysis.R (script files must plain text format). report contain code, contain versions software tools used high-level description workflow (.e describe done ).","code":""},{"path":"project-description.html","id":"timeline","chapter":"8 Project description","heading":"8.4 Timeline","text":"following provides outline well specific milestones within project.Capstone timelineIntroduction begin running TreeSAPPIdeally, analyses server run nightStart capstone projectGroup workReport writingGroups expected meet remotely needed Finals Period order complete report. report serves final course treated .Final due dateFor reports completed portfolios","code":""},{"path":"project-description.html","id":"reports","chapter":"8 Project description","heading":"8.5 Reports","text":"Reports formatted per Instructions Authors Journal Bacteriology.group submit one report sections .Report structureAbstract200–250 wordsIntroduction500–750 wordsIntroduce Saanich Inlet model ecosystem studying microbial community responses ocean deoxygenation e.g. seasonal cycles, relevant biogeochemistry, previous studies, etc.Overview geochemical cycle including global impacts, microbial foundations involved genes.Methods300–500 wordsBriefly describe data (sampling, sequencing, processing, etc.)Briefly describe analysis methods includingTreeSAPP version commands usedTreeSAPP version commands usediTOL versioniTOL versionR version packages usedR version packages usedStatistics (applicable)Statistics (applicable)Provide one single shell script one single R script (.e treesapp_analysis.sh treesapp_analysis.R) individual files (.e. part manuscript) containing complete code generate results.Results500–750 wordsYour analysis address guiding research questions developed.must include ≥ 5 figures/panels titles full captions. figures can combined multi-panel figures desired.Discussion750–1000 wordsFrame results within broader discussion Saanich Inlet (Apr 14 discussion).Propose evolutionary, environmental, etc. reasoning distributed metabolism seen geochemcial pathway.Future directionsReferences10 moreFormatted ASM style Journal Bacteriology. using reference manager, style can downloaded EndNote, Mendeley, Zotero.Make sure include citations data source papers software tools used!","code":""},{"path":"project-description.html","id":"addendum","chapter":"8 Project description","heading":"8.6 Addendum","text":"","code":""},{"path":"project-description.html","id":"abundance","chapter":"8 Project description","heading":"8.6.1 Abundance","text":"workflow introduced treesapp abundance tutorial supposed serve guide generating TPM values capstone project. However, come attention teaching team treesapp abundance fails generate simple_bar.txt files viewing distribution TPM values across reference package’s phylogenetic tree. Therefore, providing another workflow generate classifications file (marker_contig_map.tsv) TPM values simplebar.txt files iTOL.","code":""},{"path":"project-description.html","id":"generate-the-jplace-with-all-classifications","chapter":"8 Project description","heading":"8.6.1.1 Generate the JPlace with all classifications","text":"concatenated metagenome FASTA file SI072 (MetaG_Assemblies/SI072_All_contigs.fa; see server data locations) run treesapp assign without FASTQ reads abundance flags generate single jplace file containing reference package homologs across depths.","code":""},{"path":"project-description.html","id":"generate-tpm-values-for-metagenomes","chapter":"8 Project description","heading":"8.6.1.2 Generate TPM values for metagenomes","text":"Run treesapp assign seven times abundance flags (--rel_abund --metric TPM) paths metagenome FASTQ files generate TPM values individual depth abundance files needed iToL visualization.gives total 8 treesapp assign runs associated output files metagenome samples.","code":""},{"path":"project-description.html","id":"generate-tpm-values-for-metatranscriptomes","chapter":"8 Project description","heading":"8.6.1.3 Generate TPM values for metatranscriptomes","text":"Run treesapp assign abundance flags seven metatranscriptome samples, including respective FASTQ file path command. give another seven treesapp assign outputs total 15 complete process metagenome metatranscriptome data sets.","code":""},{"path":"project-description.html","id":"generate-the-file-with-all-classifications-and-tpm-values","chapter":"8 Project description","heading":"8.6.1.4 Generate the file with all classifications and TPM values","text":"Now concatenate marker_contig_map.tsv files seven individual depth runs analysis R.first need write header one classification table combined table file (SI072_combined_marker_contig_map.tsv ), write classifications tables without header. avoid including table’s header multiple times partway table, confuse R. ’re using grep accomplish removing lines match word header, ‘Query’.","code":"head -n 1 <path to treesapp assign output directory>/final_outputs/marker_contig_map.tsv >SI072_combined_marker_contig_map.tsv\ncat <path to assign outputs>/*/final_outputs/marker_contig_map.tsv | grep -v Query >>SI072_combined_marker_contig_map.tsv"},{"path":"project-description.html","id":"viewing-the-placements-and-tpm-bars-in-itol","chapter":"8 Project description","heading":"8.6.1.5 Viewing the placements and TPM bars in iTOL","text":"iToL visualization use jplace file treesapp assign concatenated metagenome FASTA visualize phylogenetic tree placements across depths, use _labels.txt file concatenated run name leaves.\nadd TPM abundance layers depth access simple_bar.txt files individual depth run drag drop files iToL GUI.","code":""},{"path":"assessment.html","id":"assessment","chapter":"9 Assessment","heading":"9 Assessment","text":"Reports account 30% course marks distributed follows.","code":""},{"path":"assessment.html","id":"peer-evaluation-10","chapter":"9 Assessment","heading":"9.1 Peer evaluation (10%)","text":"Total: 40 ptsPeer assessment occur CATME wherein everyone assess group members. Marks scaled evaluation score 90%+ (0.9+ 1 within CATME) counting full marks.Individuals adequately contribute group forfeit 5% contributions mark may asked complete project .Peer assessment includes:Contributing team’s workInteracting teammatesExpecting qualityHaving related knowledge, skills, abilitiesIndividuals score team members scale 1 (unsatisfactory) – 3 (satisfactory) – 5 (excellent) categories. Scores averaged scaled within team 1 corresponds team members contributing equally categories assessment:1+ = Mostly 5s0.95 = Mostly 4s0.8 = Mostly 3s0.65 = Mostly 2s0.5 = Mostly 1sMarks scaled CATME score based following:0.9 - 1+ = 100% = 400.8 - 0.89 = 90% = 360.7 - 0.79 = 80% = 320.6 - 0.69 = 70% = 28<0.6 = Assessed case--case basisUnwarranted blanketed low scoring team high scoring result removal scores average unfairly impact team members.issues occur within group, please hesitate contact Dr. Hallam (shallam@mail.ubc.ca), Dr. Koenig (stephan.koenig@ubc.ca) point.","code":""},{"path":"assessment.html","id":"report-20","chapter":"9 Assessment","heading":"9.2 Report (20%)","text":"Total: 80 ptsEach group submit electronic copy group’s final report (due April 24). Reports assessed :Completion relevant analyses toward answering biological questionsLogic completeness conclusions made analysesWriting clarity, grammar, styleFigure clarity, effectiveness, relevanceRubric capstone project","code":""},{"path":"assessment.html","id":"ujemi-submission","chapter":"9 Assessment","heading":"9.3 UJEMI submission","text":"Outstanding reports invited submit Undergraduate Journal Experimental Microbiology Immunology (UJEMI). information provided near end Finals Period.","code":""},{"path":"running-treesapp-on-a-server.html","id":"running-treesapp-on-a-server","chapter":"10 Running TreeSAPP on a server","heading":"10 Running TreeSAPP on a server","text":"instructions help complete script template treesapp_analysis.sh run TreeSAPP analysis Saanich Inlet data assigned depth server copy output files local machine. adjust code examples script template, replace angle brackets, e.g. <TEXT>, missing code.","code":""},{"path":"running-treesapp-on-a-server.html","id":"resources-for-treesapp-analysis","chapter":"10 Running TreeSAPP on a server","heading":"10.1 Resources for TreeSAPP analysis","text":"shell script template called treesapp_analysis.sh Canvas.Access server <server address>.Saanich Inlet data located /mnt/datasets","code":""},{"path":"running-treesapp-on-a-server.html","id":"checklist-to-write-and-run-shell-script","chapter":"10 Running TreeSAPP on a server","heading":"10.2 Checklist to write and run shell script","text":"\nEdit treesapp_analysis.sh script following instructions .\nEdit treesapp_analysis.sh script following instructions .\nUsing terminal computer, copy script group’s server using:scp <path file computer> <user>@<server address>:<destination>\nUsing terminal computer, copy script group’s server using:\nMake script executable server (otherwise won’t able run ). CLI directory containing script, run following command:chmod u+x treesapp_analysis.sh\nMake script executable server (otherwise won’t able run ). CLI directory containing script, run following command:\nStill CLI, start new session screen -S <session name>.\nStill CLI, start new session screen -S <session name>.\nnew session, start script ./treesapp_analysis.sh.\nnew session, start script ./treesapp_analysis.sh.\nscript run (take 8 hours), locate final_output/marker_contig_map.tsv files TreeSAPP output directories copy one local computer using scp.\nscript run (take 8 hours), locate final_output/marker_contig_map.tsv files TreeSAPP output directories copy one local computer using scp.steps, continue analysis results R local computer using R provided treesapp_analysis.R script template.","code":"scp <path to file on your computer> <user>@<server address>:<destination>chmod u+x treesapp_analysis.sh"},{"path":"running-treesapp-on-a-server.html","id":"shell-writing","chapter":"10 Running TreeSAPP on a server","heading":"10.3 Writing the shell script","text":"treesapp_analysis.sh script, define variables make code readable running commands, give feedback user script runs, finally run TreeSAPP workflow. Edit script either local computer copied server using text editor choice (e.g. RStudio local machine nano server).","code":""},{"path":"running-treesapp-on-a-server.html","id":"defining-the-shell","chapter":"10 Running TreeSAPP on a server","heading":"10.3.1 Defining the shell","text":"script template starts :defines shell used interpret script shell located (.e. bash shell /bin directory). need modify anything step.","code":"#! bin/bash"},{"path":"running-treesapp-on-a-server.html","id":"setting-a-variable-for-your-depth","chapter":"10 Running TreeSAPP on a server","heading":"10.3.2 Setting a variable for your depth","text":"Let’s define first variable name “depth”. Replace <depth> depth group assigned (e.g. 100).","code":"depth=\"<your  depth>\""},{"path":"running-treesapp-on-a-server.html","id":"providing-user-feedback","chapter":"10 Running TreeSAPP on a server","heading":"10.3.3 Providing user feedback","text":"good practice provide feedback user script running printing messages terminal. Let’s print welcome message terminal using echo command informing user script going . great opportunity call depth variable just defined.Hint: Remember, call variable, prepend name $, e.g. variable’s name some_variable call $some_variable.","code":"echo \"TreeSAPP analysis of Saanich Inlet Data at Depth <call depth variable> m\""},{"path":"running-treesapp-on-a-server.html","id":"defining-variable-for-input-directory","chapter":"10 Running TreeSAPP on a server","heading":"10.3.4 Defining variable for input directory","text":"Define variable path input data directory. Let’s call variable input_dir.","code":"<variable_name>=\"<path to data directory>\""},{"path":"running-treesapp-on-a-server.html","id":"creating-output-directory","chapter":"10 Running TreeSAPP on a server","heading":"10.3.5 Creating output directory","text":"Define variable TreeSAPP output directory choose name . directory located home directory (also shared host container). refer home directory, use environmental variable HOME automatically defined shell (.e. need first define ). Finally, create output directory.","code":"<set output directory variable>\n<create the ouput directory>"},{"path":"running-treesapp-on-a-server.html","id":"reporting-variables-to-user","chapter":"10 Running TreeSAPP on a server","heading":"10.3.6 Reporting variables to user","text":"Let’s provide user feedback TreeSAPP going save output bind paths set.","code":"<print command> \"<Some text explaining what variables have been set>\""},{"path":"running-treesapp-on-a-server.html","id":"listing-treesapp-version","chapter":"10 Running TreeSAPP on a server","heading":"10.3.7 Listing TreeSAPP version","text":"Let’s print information configuration TreeSAPP.Hint: long commands script, can introduce line breaks using \\ best used right space command (see example word “following”).","code":" treesapp info"},{"path":"running-treesapp-on-a-server.html","id":"executing-treesapp-analysis","chapter":"10 Running TreeSAPP on a server","heading":"10.3.8 Executing TreeSAPP analysis","text":"terminal (.e. part script), check documentation treesapp assign, command use automated reconstruction nutrient cycle (visit wikipage learn ).Looking TreeSAPP documentation, determine flags need addition ones already included .Time run analysis! identify input file(s) need process. run analysis metagenomic (two files, forward reads file contains .1 name, reverse reads file .2) metatranscriptomic reads (single file contains forward reverse reads) align assembled contigs. reads pair-end.need provide following settings using flags:assembly file use.use 8 CPUs analysis.analysis marker genes provided TreeSAPP.output verbose runtime log.save results.calculate rpkm values detected sequences.reads use type (.e. pair-end single-end).delete intermediate files generated analysis.use position masking multiple sequence alignment.Hints:ouput data metagenomic metatranscriptomic analysis folder? folder already exist?want default value flag, need provide .input data located singularity container?Metatrascriptomic reads rRNA.scripts often refer variables combined additional text. Let’s say defined variable file_name=\"some_file\" refer file some_file. Now want save modified version file some_file_modified. write $file_name_modified, shell know just want call variable called $file_name instead assume calling variable called $file_name_modified return empty string. indicate beginning end variable name, use curly braces. example, use ${file_name}_modified.Optional bonus challenge:\nEarlier defined depth variable. use way define assembly reads using analysis?","code":"treesapp assign -h# Metagenomic analysis\ntreesapp assign \\\n-i <input data dir><file path to your assembly> \\\n-m <choose the correct option> \\\n<number of CPU threads, set to 8>\n<your output directory> \\\n<your remaining settings>\n\n# Metatranscriptomic analysis\n<you are on your own now :)>"},{"path":"the-saanich-inlet-data-set.html","id":"the-saanich-inlet-data-set","chapter":"A The Saanich Inlet data set","heading":"A The Saanich Inlet data set","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"description","chapter":"A The Saanich Inlet data set","heading":"A.1 Description","text":"work real-world data collected part ongoing oceanographic time series program Saanich Inlet, seasonally anoxic fjord East coast Vancouver Island, British Columbia:\nFIGURE .1: Saanich Inlet\nFigure .1 shows map Saanich Inlet indicating conventional sample collection stations (S1-S9). data used tutorial (sourced S3, Cruise 72) include various geochemical measurements genomic transcriptomic data microbial samples depths 10, 100, 120, 135, 150, 165 200 m.details data, see (10), detailed information environmental context time series data, see (11).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"data-on-the-server","chapter":"A The Saanich Inlet data set","heading":"A.2 Data on the server","text":"Saanich data located MICB425 server /mnt/datasets/saanich/.Additionally, like run GTDB-TK, path GTDB refrence directory located /mnt/datasets/GTDB-Tk/release95/","code":"/mnt/datasets/saanich/\n├── [   0]  directory_structure.txt\n├── [492M]  MAGs\n│   └── [492M]  Concatenated\n│       └── [492M]  All_SI072_Metawrap_MAGs.fa\n├── [3.5G]  MetaG_Assemblies\n│   ├── [630M]  SI072_100m_contig.fa\n│   ├── [525M]  SI072_10m_contig.fa\n│   ├── [571M]  SI072_120m_contig.fa\n│   ├── [505M]  SI072_135m_contig.fa\n│   ├── [396M]  SI072_150m_contig.fa\n│   ├── [748M]  SI072_165m_contig.fa\n│   └── [219M]  SI072_200m_contig.fa\n│   └── [3.5G]  SI072_All_contigs.fa\n├── [ 64G]  MetaG_Trim_QC_Reads\n│   ├── [4.7G]  SI072_100m_pe.1.fq.gz\n│   ├── [4.7G]  SI072_100m_pe.2.fq.gz\n│   ├── [4.2G]  SI072_10m_pe.1.fq.gz\n│   ├── [4.2G]  SI072_10m_pe.2.fq.gz\n│   ├── [4.2G]  SI072_120m_pe.1.fq.gz\n│   ├── [4.2G]  SI072_120m_pe.2.fq.gz\n│   ├── [4.4G]  SI072_135m_pe.1.fq.gz\n│   ├── [4.4G]  SI072_135m_pe.2.fq.gz\n│   ├── [4.8G]  SI072_150m_pe.1.fq.gz\n│   ├── [4.7G]  SI072_150m_pe.2.fq.gz\n│   ├── [6.5G]  SI072_165m_pe.1.fq.gz\n│   ├── [6.4G]  SI072_165m_pe.2.fq.gz\n│   ├── [3.3G]  SI072_200m_pe.1.fq.gz\n│   └── [3.3G]  SI072_200m_pe.2.fq.gz\n├── [ 54G]  MetaT_Raw_Reads\n│   ├── [8.9G]  SI072_100m_MetaT_QC_Filtered.fastq.gz\n│   ├── [6.4G]  SI072_10m_MetaT_QC_Filtered.fastq.gz\n│   ├── [6.8G]  SI072_120m_MetaT_QC_Filtered.fastq.gz\n│   ├── [7.2G]  SI072_135m_MetaT_QC_Filtered.fastq.gz\n│   ├── [10.0G]  SI072_150m_MetaT_QC_Filtered.fastq.gz\n│   ├── [8.7G]  SI072_165m_MetaT_QC_Filtered.fastq.gz\n│   └── [6.0G]  SI072_200m_MetaT_QC_Filtered.fastq.gz\n├── [181M]  SAGs\n│   └── [181M]  Concatenated_Med_Plus\n│       └── [181M]  Saanich_Med_Plus_SAGs.fasta\n└── [ 42K]  seq2lineage_Tables\n    ├── [ 17K]  Med_Plus_SAGs_GTDB_Taxonomies.tsv\n    └── [ 25K]  SI072_MAGs_All_GTDB_taxonomies.tsv\n\n 122G used in 8 directories, 33 files"},{"path":"the-saanich-inlet-data-set.html","id":"description-of-input-data","chapter":"A The Saanich Inlet data set","heading":"A.3 Description of input data","text":"List directories contentsMAGs\nWithin Concatonated subdirectory, single All_SI072_Metawrap_MAGs.fa fasta file use treesapp assign treesapp update. MAGs generated MetaWrap pipeline (12) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.MAGsWithin Concatonated subdirectory, single All_SI072_Metawrap_MAGs.fa fasta file use treesapp assign treesapp update. MAGs generated MetaWrap pipeline (12) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.MetaG_Assemblies\ndirectory contains seven assembled metagenomic contigs SI072 sample depth, one file concatonated single file. files used treesapp assign abundance tutorials. files generated assembling trimmed quality controlled reads generated Illumina HiSeq platform (see Methods).MetaG_AssembliesThis directory contains seven assembled metagenomic contigs SI072 sample depth, one file concatonated single file. files used treesapp assign abundance tutorials. files generated assembling trimmed quality controlled reads generated Illumina HiSeq platform (see Methods).MetaG_Trim_QC_Reads\ndirectory contains fourteen fastq files contain paired-end forward reverse metagenomic reads SI072 sample depth. trimmed QC’d fastqs generated processing raw reads Megahit workflow described . use files treesapp abundance get metagenomic abundance assigned genes.MetaG_Trim_QC_ReadsThis directory contains fourteen fastq files contain paired-end forward reverse metagenomic reads SI072 sample depth. trimmed QC’d fastqs generated processing raw reads Megahit workflow described . use files treesapp abundance get metagenomic abundance assigned genes.MetaT_Raw_Reads\ndirectory contains seven filtered QC’d metatranscriptome fastq files SI072 Sample depth. files paired end interleaved. files provided JGI generated based methodology . use files treesapp abundance calculate metatransciptomic abundances gene interest.MetaT_Raw_ReadsThis directory contains seven filtered QC’d metatranscriptome fastq files SI072 Sample depth. files paired end interleaved. files provided JGI generated based methodology . use files treesapp abundance calculate metatransciptomic abundances gene interest.SAGs\nWithin Concatenated_Med_Plus subdirectory, single Saanich_Med_Plus_SAGs.fasta file use treesapp assign treesapp update. MAGs generated SAG Assembly Decontamination Workflow (13–16) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.SAGsWithin Concatenated_Med_Plus subdirectory, single Saanich_Med_Plus_SAGs.fasta file use treesapp assign treesapp update. MAGs generated SAG Assembly Decontamination Workflow (13–16) (see Methods), sample IDs added contig headers MAG produced SI072 sample depth. individual MAGs concatenated file.seq2lineage_Tables\ndirectory contains two files used treesapp update. One file contains lineage information MAGs, contains information SAGs. tables generated taking separate MAG SAG respectively passing Genome Taxonomic Database Toolkit v1.4.0 classify workflow (7) (see Methods). , first two columns archaeal bacterial summary files taken combined files.seq2lineage_TablesThis directory contains two files used treesapp update. One file contains lineage information MAGs, contains information SAGs. tables generated taking separate MAG SAG respectively passing Genome Taxonomic Database Toolkit v1.4.0 classify workflow (7) (see Methods). , first two columns archaeal bacterial summary files taken combined files.","code":""},{"path":"the-saanich-inlet-data-set.html","id":"methods","chapter":"A The Saanich Inlet data set","heading":"A.4 Methods","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"metagenomes-and-metatransriptopmes","chapter":"A The Saanich Inlet data set","heading":"A.4.1 Metagenomes and metatransriptopmes","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"sample-collection","chapter":"A The Saanich Inlet data set","heading":"A.4.1.1 Sample Collection","text":"Water collected 10, 100, 120, 135, 150, 165, 200m Saanich Inlet August 1st, 2012 filtered 0.22 µm Sterivex filter collect biomass. Total genomic DNA RNA extracted filters. RNA reversed transcribed cDNA genomic DNA cDNA used construction shotgun Illumina libraries. Sequencing data generated Illumina HiSeq platform 2x150bp technology. -depth sampling sequencing methods, please see (17).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"quality-filtering-of-reads","chapter":"A The Saanich Inlet data set","heading":"A.4.1.2 Quality filtering of reads","text":"resulting reads processed, quality controlled filtered Trimmomatic (v.0.35, documentation) (13). Trimmomatic command follows, SI072_XXX represents command applied seven depths.resulting trimmed fastq files also deposited MICB425 server /mnt/datasets/saanich/MetaG_Trim_QC_Reads","code":"trimmomatic -threads 8 -phred33 \\\nPath_to/SI072_XXXm/Raw/forward_dir/SI072_XXXm_R1.fastq \\\nPath_To/SI072_200m/Raw/reverse_dir/SI072_XXXm_R2.fastq \\\n\nPath_To/SI072_200m//trim/SI072_XXXm_pe.1.fq \\\n\nPath_To/SI072_200m//trim/SI072_XXXm_pe.2.fq \\\n\nILLUMINACLIP:/usr/local/share/Trimmomatic-0.35/adapters/TruSeq3-PE.fa:2:3:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36"},{"path":"the-saanich-inlet-data-set.html","id":"contig-assembly","chapter":"A The Saanich Inlet data set","heading":"A.4.1.3 Contig Assembly","text":"MEGAHIT (v.1.1.3, documentation) (18) used assemble filtered metagenomic reads contigs.resulting assemblies can found /mnt/datasets/saanich/MetaG_Assemblies.","code":"megahit -1 Path_To/SI072_200m//trim/SI072_XXXm_pe.1.fq  -2 Path_To/SI072_200m//trim/SI072_XXXm_pe.2.fq  -m 0.5  -t 12  -o megahit_result --k-min 27 --k-step 10 --min-contig-len 500"},{"path":"the-saanich-inlet-data-set.html","id":"binning-and-mag-generation","chapter":"A The Saanich Inlet data set","heading":"A.4.1.4 Binning and MAG Generation","text":"MetaWRAP (v1.2.4, documentation) (12) used generate MAGs metagenome assemblies filtered reads project. MetaWRAP leverages multiple binning software (chose use MetaBAT2 v2.12.1 (19) MaxBin v2.2.7 (20), (21)) create non-redundant set MAGs better quality single software. quality resulting bins – assessed completeness, contamination, strain-heterogeneity – calculated MetaWRAP’s implementation CheckM (v1.0.12) (15). command used invoke MetaWRAP follows:","code":"metawrap binning -a SI072_Assembly.fa -o output_directory -t 16 -m 64 -l 1500 --metabat2 --maxbin2 --universal Path_To/SI072_200m//trimSI072_XXXm_pe.1.fastq Path_To/SI072_200m//trimSI072_XXXm_pe.2.fastq"},{"path":"the-saanich-inlet-data-set.html","id":"taxonomic-assignment-of-mags","chapter":"A The Saanich Inlet data set","heading":"A.4.1.5 Taxonomic Assignment of MAGs","text":"resulting MAGs passed GTDB-TK v1.4.0 classify workflow reference data version r95 documentation (7).updating headers resulting 219 bins sample IDs, bins concatenated deposited : /mnt/datasets/saanich/MAGs/Concatenated/","code":"gtdbtk classify_wf --genome_dir Path_To_SI072/MAGs/ -x .fa --out_dir Path_To_SI072/MAG_GTDB_Outputs/ --cpus 8 --pplacer_cpus 8\n"},{"path":"the-saanich-inlet-data-set.html","id":"single-cell-amplified-genomes","chapter":"A The Saanich Inlet data set","heading":"A.4.2 Single-Cell Amplified Genomes","text":"","code":""},{"path":"the-saanich-inlet-data-set.html","id":"sample-collection-1","chapter":"A The Saanich Inlet data set","heading":"A.4.2.1 Sample Collection","text":"Water collected across water column Saanich Inlet August 9th, 2011. 900 µL seawater aliquoted 100 µL glycerol-TE buffer, stored -80 degrees Celsius. Samples 100m, 150m, 185m selected sorting sequencing. selected samples thawed microbial cells sorted Bigelow Laboratory Ocean Sciences’ Single Cell Genomics Center (scgc.bigelow.org).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"florescence-activated-cell-sorting","chapter":"A The Saanich Inlet data set","heading":"A.4.2.2 Florescence Activated Cell Sorting","text":"Samples passed sterile 40 𝜇m size mesh microorganisms sorted non-targeted isolation procedure. non-target isolation, microbial particles labeled 5 𝜇M final concentration DNA stain SYTO-9 (Thermo Fisher Scientific). Microbial cells individually sorted using MoFloTM (Beckman Coulter) InFluxTM (BD Biosciences) flow cytometer system equipped 488 nm laser excitation 70 μm nozzle orifice30. gates untargeted isolation microbial cells stained SYTO-9 defined based green fluorescence particles proxy nucleic acid content, side scattered light proxy particle size. microbial single cells sorted 384-well plates containing 600 nL 1X TE buffer per well stored -80 degrees Celsius. microbial single-cells sorted TE buffer lysed described previously adding cold KOH.microbial nucleic acids amplified individual wells Multiple Displacement Amplification (MDA) (22), (23).","code":""},{"path":"the-saanich-inlet-data-set.html","id":"amplicon-taxonomic-screening","chapter":"A The Saanich Inlet data set","heading":"A.4.2.3 Amplicon Taxonomic Screening","text":"SAGs generated MDA methodology taxonomically characterized sequencing determined phylogenetic marker using amplification based approach. SAGs screened small subunit ribosomal rRNA gene (SSU rRNA) using primers bacterial (27-F: 5’- AGAGTTTGATCMTGGCTCAG -3’37, 907-R: 5’- CCGTCAATTCMTTTRAGTTT -3’38 archaeal sequences (Arc_344F: 5’- ACGGGGYGCAGCAGGCGCGA -3’39, Arch_915R: 5’- GTGCTCCCCCGCCAATTCCT -3’40). real-time PCR sequencing procedure resulting amplicons performed previously described (24), (25). partial SSU rRNA gene sequences queried SILVA database v138.1 (26) blastn, BLAST+ v2.9.0 (27).","code":" blastn -query -db -outfmt \"6 qacc sacc stitle staxid pident bitscore\" -max_target_seqs 1 -num_threads 4 -out "},{"path":"the-saanich-inlet-data-set.html","id":"sag-sequencing-and-assembly","chapter":"A The Saanich Inlet data set","heading":"A.4.2.4 SAG Sequencing and Assembly","text":"MDA products SAGs sequenced described previously (24), (25) Illumina HiSeq 2000. resulting raw reads filtered trimmed remove adaptors Trimmomatic v0.35 (13).Trimmed quality controlled reads assembled SPAdes v3.9.0 (28) standard parameters.","code":"trimmomatic -threads 8 -phred33 \\\nPath_to/SI072_XXXm/Raw/forward_dir/SI072_XXXm_R1.fastq \\\nPath_To/SI072_200m/Raw/reverse_dir/SI072_XXXm_R2.fastq \\\n\nPath_To/SI072_200m//trim/SI072_XXXm_pe.1.fq \\\nPath_To/SI072_200m//trim/SI072_XXXm_se.1.fq \\\nPath_To/SI072_200m//trim/SI072_XXXm_pe.2.fq \\\nPath_To/SI072_200m//trim/SI072_XXXm_se.2.fq \\\n\nILLUMINACLIP:/usr/local/share/Trimmomatic-0.35/adapters/TruSeq3-PE.fa:2:3:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36spades.py \\\n--sc \\\n-o Path_To_assembly_dir/ \\\n-1 Path_To_trim_dir/SI072_XXXm_pe.1.fq \\\n-2 Path_To_trim_dir/SI072_XXXm_pe.1.fq \\\n-s Path_To_trim_dir/$sample\\_unpaired.fq \\\n-k $k_series \\\n--memory 90 \\\n--threads $threads \\\n--careful \\\n--cov-cutoff auto\n"},{"path":"the-saanich-inlet-data-set.html","id":"sag-assembly-quality-control-and-decontamination","chapter":"A The Saanich Inlet data set","heading":"A.4.2.5 SAG Assembly Quality Control and Decontamination","text":"Quality SAGs assessed using CheckM (v1.0.5) (15) following command:SAGs found >5% contamination passed ProDeGe v2.3.0 (16). resulting decontaminated SAGs re-assesed CheckM still exceeded 5% contamination short contigs (.e. <2000 bp) removed assembly. re-assessed CheckM ensure met standards.project, 376 SAGs recovered, 154 SAGs estimated >50% completeness <10% contamination selected remainder analysis.","code":"checkm lineage_wf --tab_table -x .fna --threads 8 --pplacer_threads 8"},{"path":"the-saanich-inlet-data-set.html","id":"final-taxonomic-assignment-of-sags","chapter":"A The Saanich Inlet data set","heading":"A.4.2.6 Final Taxonomic Assignment of SAGs","text":"resulting SAGs passed GTDB-TK v1.4.0 classify workflow documentation (7).updating headers resulting SAGs sample IDs, SAGs concatenated deposited : /mnt/datasets/saanich/SAGs/Concatenated_Med_Plus/Note: identifier SAG consists combination plate ID well location sorted . identifiers take form (AB-7XX_YYY). identifiers incorporated headers final SAG assemblies. plate corresponds specific depth shown :","code":"gtdbtk classify_wf --genome_dir Path_To_SI_SAGs/ -x .fna --out_dir Path_To_SI_SAGs/GTDB_1.4.0/ --cpus 8 --pplacer_cpus 8\n"},{"path":"the-saanich-inlet-data-set.html","id":"installing-and-running-gtdb-tk","chapter":"A The Saanich Inlet data set","heading":"A.5 Installing and running GTDB-Tk","text":"like use additional genomes MAGs capstone project, can also classify GTDB-Tk.like install GTDB-TK conda, first need create new conda environment. First, deactivate treesapp environment:follow instructions (originally : GTDB)install GTDB conda:made new GTDB environment, need add path latest GTDB reference data.Next, determine GTDB-Tk environment pathIt root/miniconda3/envs/gtdbtk-1.4.1/bin/gtdbtkNext, edit activate fileYou now ready use classify workflow command listed . need substitute directory name like write , well extension fasta files genomes.important set cpus pplacer_cpus flags 4 threads make sure tie server’s resources!running GTDB, can deactivate environment :can turn treesapp environment back continue treesapp analysis.recommend concatenating new genomes together cat single file ease use. example:","code":"conda deactivate treesapp_cenv# specific version (replace 1.4.1 with the version you wish to install, recommended)\nconda create -n gtdbtk-1.4.1 -c conda-forge -c bioconda gtdbtk=1.4.1\nconda activate gtdbtk-1.4.1which gtdbtk\necho \"export GTDBTK_DATA_PATH=/mnt/datasets/GTDB-Tk/release95/\" > /root/miniconda3/envs/gtdbtk-1.4.1/etc/conda/activate.d/gtdbtk.shgtdbtk classify_wf --genome_dir Path_To_Genomes/ \\\n    -x [Choose either .fa, .fasta, or .fna depending on the file extension] \\\n    --out_dir [Path_To_New_Genome_Output/here] \\\n    --cpus 4 \\\n    --pplacer_cpus 4conda deactivateconda activate treesapp_cenvcat *.fasta > All_Genomes.fasta\n"},{"path":"treesapp-reference-packages.html","id":"treesapp-reference-packages","chapter":"B TreeSAPP reference packages","heading":"B TreeSAPP reference packages","text":"TABLE B.1:  Available TreeSAPP reference packages","code":""},{"path":"shell-cheat-sheet.html","id":"shell-cheat-sheet","chapter":"C Shell cheat sheet","heading":"C Shell cheat sheet","text":"TABLE C.1:  Shell cheat sheetChange directory.. parent directory~ home directory- last visited directoryList files directory-l listLook text filePress Help navigationPress Quit leaveCopy files local serverGive file path server <user>@<server address>:<file path>Get list command historyFollow !<number> execute corresponding command -<filename> save history current session text file document workman <command>help <command><command> --helpCreate virtual terminal continues run jobs even connection server terminates-S <session name> create session <session name>-ls list running sessions-r <session name> resume sessionTo leave session keep running, first ctrl+activate commands screen, thendetach","code":""},{"path":"references.html","id":"references","chapter":"D References","heading":"D References","text":"1. Louca S, Hawley AK, Katsev S, Torres-Beltran M, Bhatia MP, Kheirandish S, Michiels CC, Capelle D, Lavik G, Doebeli M, Crowe SA, Hallam SJ. 2016. Integrating biogeochemistry multiomic sequence information model oxygen minimum zone. Proceedings National Academy Sciences 113:E5925–E5933.2. Hawley AK, Brewer HM, Norbeck AD, Pa -Toli L, Hallam SJ. 2014. Metaproteomics reveals differential modes metabolic coupling among ubiquitous oxygen minimum zone microbes. Proceedings National Academy Sciences 111:11395–11400.3. Morgan-Lang C, McLaughlin R, Armstrong Z, Zhang G, Chan K, Hallam SJ. 2020. TreeSAPP: Tree-based Sensitive Accurate Phylogenetic Profiler. Bioinformatics btaa588.4. Letunic , Bork P. 2019. Interactive Tree Life (iTOL) v4: recent updates new developments. Nucleic Acids Research 47:gkz239.5. Khadka R, Clothier L, Wang L, Lim CK, Klotz MG, Dunfield PF. 2018. Evolutionary History Copper Membrane Monooxygenases. Frontiers Microbiology 9:2493.6. Criscuolo , Gribaldo S. 2010. BMGE (block mapping gathering entropy): new software selection phylogenetic informative regions multiple sequence alignments. BMC Evol Biol 10.7. Chaumeil P-, Mussig AJ, Hugenholtz P, Parks DH. 2019. GTDB-Tk: toolkit classify genomes genome taxonomy database. Bioinformatics.8. Wagner GP, Kin K, Lynch VJ. 2012. Measurement mRNA abundance using RNA-seq data: RPKM measure inconsistent among samples. Theory Biosciences 131:281–285.9. Li H. 2013. Aligning sequence reads, clone sequences assembly contigs BWA-MEM. arXiv.10. Hallam SJ, Torres-Beltrán M, Hawley AK. 2017. Monitoring microbial responses ocean deoxygenation model oxygen minimum zone. Scientific Data 4:170158.11. Torres-Beltrán M, Hawley AK, Capelle D, Zaikova E, Walsh DA, Mueller , Scofield M, Payne C, Pakhomova L, Kheirandish S, Finke J, Bhatia M, Shevchuk O, Gies EA, Fairley D, Michiels C, Suttle CA, Whitney F, Crowe SA, Tortell PD, Hallam SJ. 2017. compendium geochemical information Saanich Inlet water column. Scientific Data 4:170159.12. Uritskiy GV, DiRuggiero J, Taylor J. 2018. MetaWRAP—flexible pipeline genome-resolved metagenomic data analysis. Microbiome 6:158.13. Bolger , Lohse M, Usadel B. 2014. Trimmomatic: flexible trimmer Illumina sequence data. Bioinformatics 30:2114–2120.14. Prjibelski , Antipov D, Meleshko D, Lapidus , Korobeynikov . 2020. Using SPAdes De Novo Assembler. Current Protocols Bioinformatics 70:e102.15. Parks DH, Imelfort M, Skennerton CT, Hugenholtz P, Tyson GW. 2015. CheckM: assessing quality microbial genomes recovered isolates, single cells, metagenomes. Genome Research 25:1043–1055.16. Tennessen K, Andersen E, Clingenpeel S, Rinke C, Lundberg DS, Han J, Dangl JL, Ivanova N, Woyke T, Kyrpides N, Pati . 2016. ProDeGe: computational protocol fully automated decontamination genomes. ISME Journal 10:269–272.17. Hawley AK, Torres-Beltrán M, Zaikova E, Walsh DA, Mueller , Scofield M, Kheirandish S, Payne C, Pakhomova L, Bhatia M, Shevchuk O, Gies EA, Fairley D, Malfatti SA, Norbeck AD, Brewer HM, Pasa-Tolic L, Rio TG del, Suttle CA, Tringe S, Hallam SJ. 2017. compendium multi-omic sequence information Saanich Inlet water column. Scientific Data 4:170160.18. Li D, Liu C-M, Luo R, Sadakane K, Lam T-W. 2015. MEGAHIT: ultra-fast single-node solution large complex metagenomics assembly via succinct de Bruijn graph. Bioinformatics 31:1674–1676.19. Kang DD, Li F, Kirton E, Thomas , Egan R, H, Wang Z. 2019. MetaBAT 2: adaptive binning algorithm robust efficient genome reconstruction metagenome assemblies. PeerJ 7:e7359.20. Wu Y-W, Tang Y-H, Tringe SG, Simmons BA, Singer SW. 2014. MaxBin: automated binning method recover individual genomes metagenomes using expectation-maximization algorithm. Microbiome 2:1–18.21. Wu Y-W, Simmons BA, Singer SW. 2016. MaxBin 2.0: automated binning algorithm recover genomes multiple metagenomic datasets. Bioinformatics 32:605–607.22. Raghunathan , Ferguson HR, Bornarth CJ, Song W, Driscoll M, Lasken RS. 2005. Genomic dna amplification single bacterium. Applied environmental microbiology 71:3342–3347.23. Rinke C, Lee J, Nath N, Goudeau D, Thompson B, Poulton N, Dmitrieff E, Malmstrom R, Stepanauskas R, Woyke T. 2014. Obtaining genomes uncultivated environmental microorganisms using FACS-based single-cell genomics. Nat Protoc 9:1038–1048.24. Tyson GW, Chapman J, Hugenholtz P, Allen EE, Ram RJ, Richardson PM, Solovyev VV, Rubin EM, Rokhsar DS, Banfield JF. 2004. Community structure metabolism reconstruction microbial genomes environment. Nature 428:37–43.25. Swan BK, Martinez-Garcia M, Preston CM, Sczyrba , Woyke T, Lamy D, Reinthaler T, Poulton NJ, Masland EDP, Gomez ML, Sieracki , DeLong EF, Herndl GJ, Stepanauskas R. 2011. Potential chemolithoautotrophy among ubiquitous bacteria lineages dark ocean. Science 333:1296–1300.26. Quast C, Pruesse E, Yilmaz P, Gerken J, Schweer T, Yarza P, Peplies J, Glöckner FO. 2013. SILVA ribosomal RNA gene database project: Improved data processing web-based tools. Nucleic Acids Res 41:D590–6.27. Camacho C, Coulouris G, Avagyan V, Ma N, Papadopoulos J, Bealer K, Madden TL. 2009. BLAST+: Architecture applications. BMC Bioinformatics 10:421.28. Bankevich , Nurk S, Antipov D, Gurevich AA, Dvorkin M, Kulikov , Lesin VM, Nikolenko SI, Pham S, Prjibelski AD, Pyshkin AV, Sirotkin AV, Vyahhi N, Tesler G, Alekseyev MA, Pevzner PA. 2012. SPAdes: new genome assembly algorithm applications single-cell sequencing. J Comput Biol 19:455–477.","code":""}]
